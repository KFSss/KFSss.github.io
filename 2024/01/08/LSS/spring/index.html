<!DOCTYPE html>
<html>
	<head>
		
<title>Spring-ğŸ§ </title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/dragon.ico">

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="java,Spring,">
<meta name="description" content="Springå­¦ä¹ è¿‡ç¨‹">


<script src="/js/jquery.min.js"></script>


<script src="/js/index.js"></script>


<script src="/js/fancybox.umd.js"></script>


<script src="/js/fancybox-images.js"></script>


<script src="/js/gitalk.min.js"></script>


<script src="/js/hljs.min.js"></script>
 
<script>hljs.highlightAll();</script>

	<meta name="generator" content="Hexo 6.3.0"></head>

	<body>
		
	<div class="header">
		<div class="header-top" id="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/dragon.png" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										ä¸»é¡µ
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										æ–‡æ¡£
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/categories">
										åˆ†ç±»
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/tags">
										æ ‡ç­¾
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/links">
										å‹æƒ…é“¾æ¥
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/about">
										æˆ‘
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>SoftLipa</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">ä¸»é¡µ</a>
        </li>
        
        <li>
            <a href="/archives">æ–‡æ¡£</a>
        </li>
        
        <li>
            <a href="/categories">åˆ†ç±»</a>
        </li>
        
        <li>
            <a href="/tags">æ ‡ç­¾</a>
        </li>
        
        <li>
            <a href="/links">å‹æƒ…é“¾æ¥</a>
        </li>
        
        <li>
            <a href="/about">æˆ‘</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
        </a>
        
    </div>
</div>
<div class='shelter'>
</div>
<style>
    .shelter{
        background-color: #333;
        opacity:0.5;
        cursor: pointer;
        display: none; 
        position: fixed;
        left: 0;
        top: 0; 
        right: 0;
        bottom: 0;
        z-index: 1998;
    }
    .sidebar {
        width: 66%;
        height: 100%;
        position: fixed;
        top: 0;
        right: -100%;
        bottom: 0;
        background: #fff;
        z-index: 1999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815);
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $( function () {
	$( '.h-right-close>svg' )
		.click( function () {
			$( '.sidebar' )
				.animate( {
					right: "0"
				}, 500 );
			$( '.shelter' )
				.fadeIn( "slow" )
		} );
	$( '.shelter' )
		.click( function ( e ) {
			$( '.sidebar' )
				.animate( {
					right: "-100%"
				}, 500 );
			$( '.shelter' )
				.fadeOut( "slow" )
		} )
} )

</script>

<div class="post">
    <div class="post-header-background post-header-img"
    style="background: url('https://tu.ltyuanfang.cn/api/fengjing.php')" 
>
    <div class="post-header-background-content">
        <ul class="post-header-tag">
            
            
            <li><a href="/tags/java">java</a></li>
            
            <li><a href="/tags/Spring">Spring</a></li>
            
            
        </ul>
        
        <h1>Spring</h1>
        <div class="post-header-info">
            <div class="post-header-info-author">
                
                    <svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
                        <path
                            d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
                            p-id="2902" fill="#ffffff"></path>
                    </svg>
                    
                <span class="post-header-info-author-text"> <a href="../../about">SoftLipa</a></span>
                <div class="post-header-info-author-categories">
                    
                         <a href="../../categories/java/" target="_blank" >java</a>
                    
                </div>
                <p>2024-01-08 09:33:36</p>
            </div>
        </div>
    </div>
</div>
    <div class="post-content" id="content">
  
  <div id="article" class="post-content-info">
    

    <p>[TOC] </p>
<p>â€å­¦ä¹ Springæ˜¯ä¸ºäº†å¦å®šSpringï¼Œå¯ä»¥è·³å‡ºSpringä¹Ÿèƒ½åšè€Œä¸æ˜¯åªä¼šSpringã€‚â€œ</p>
<h1 id="å…¥é—¨ç¯‡"><a href="#å…¥é—¨ç¯‡" class="headerlink" title="å…¥é—¨ç¯‡"></a>å…¥é—¨ç¯‡</h1><h2 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a>1. ç®€ä»‹</h2><p>Springç†å¿µï¼š<strong>ä½¿ç°æœ‰æŠ€æœ¯æ›´åŠ å®¹æ˜“ä½¿ç”¨</strong>ï¼Œæœ¬èº«æ˜¯ä¸€ä¸ªå¤§æ‚çƒ©ï¼Œæ•´åˆäº†ç°æœ‰æŠ€æœ¯æ¡†æ¶ã€‚</p>
<p>å®˜ç½‘ï¼š<a href="https://gitee.com/link?target=https://docs.spring.io/spring-framework/docs/5.2.0.RELEASE/spring-framework-reference/overview.html%23overview">https://docs.spring.io/spring-framework/docs/5.2.0.RELEASE/spring-framework-reference/overview.html#overview</a></p>
<p>ä¸‹è½½åœ°å€ï¼š<a href="https://gitee.com/link?target=https://repo.spring.io/release/org/springframework/spring/">https://repo.spring.io/release/org/springframework/spring/</a></p>
<p>å¯¼åŒ…</p>
<pre><code>       &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
            &lt;version&gt;5.2.0.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre>
<h3 id="1-2-ä¼˜ç‚¹"><a href="#1-2-ä¼˜ç‚¹" class="headerlink" title="1.2 ä¼˜ç‚¹"></a>1.2 ä¼˜ç‚¹</h3><ul>
<li>ä¸€ä¸ªå¼€æºçš„æ¡†æ¶ï¼ˆå®¹å™¨ï¼‰</li>
<li>è½»é‡çº§ã€<strong>éå…¥ä¾µå¼</strong>çš„æ¡†æ¶ 2022.3.7 ä»€ä¹ˆæ˜¯éä¾µå…¥å¼ï¼Ÿ æˆ‘å»ä½¿ç”¨è¿™ä¸ªæ¡†æ¶ï¼Œä½†æˆ‘æ— éœ€ç»§æ‰¿æˆ–è€…å®ç°è¯¥æ¡†æ¶çš„ä»»ä½•æ¥å£ï¼Œè¿™æ ·å°±å¯ä»¥åšåˆ°ä»–äººçš„ç³»ç»Ÿå¯¹æˆ‘çš„ç¨‹åºæœ¬èº«å½±å“æœ€å°ï¼Œé™ä½äº†ç¨‹åºçš„è€¦åˆæ€§ã€‚å½“ç„¶ä¸€äº›ç‰¹æ®Šçš„ï¼Œæ¯”å¦‚<code>Interceptor</code>è¿™ç§è‚¯å®šæ˜¯ç»§æ‰¿çš„ï¼Œä½†æ˜¯ç¨‹åºé‡Œå¤§éƒ¨åˆ†ç±»éƒ½æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ã€‚</li>
<li><strong>æ§åˆ¶åè½¬ï¼ˆIOCï¼‰ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰</strong></li>
<li>æ”¯æŒäº‹åŠ¡çš„å¤„ç†ï¼Œå¯¹æ¡†æ¶çš„æ•´åˆ</li>
</ul>
<p>æ€»ç»“ï¼šä¸€ä¸ªè½»é‡çº§çš„IOCã€AOPçš„æ¡†æ¶</p>
<h3 id="ï¼‘-ï¼“ç»„æˆ"><a href="#ï¼‘-ï¼“ç»„æˆ" class="headerlink" title="ï¼‘.ï¼“ç»„æˆ"></a>ï¼‘.ï¼“ç»„æˆ</h3><p><img src="/" alt="image-20210125160353824"></p>
<p>1.4</p>
<p>The source for Moderen Java</p>
<p><img src="/" alt="image-20210125160857474"></p>
<p>Spring Boot:</p>
<ul>
<li>ä¸€ä¸ªå¿«é€Ÿå¼€å‘çš„è„šæ‰‹æ¶</li>
<li>åŸºäºSpringBootå¯ä»¥å¿«é€Ÿçš„å¼€å‘å•ä¸ªå¾®æœåŠ¡</li>
<li>çº¦å®šå¤§äºé…ç½®</li>
</ul>
<p>Spring Cloud:</p>
<ul>
<li>SpringCloudæ˜¯åŸºäºSpringBootå®ç°çš„</li>
</ul>
<p>å¼Šç«¯:å‘å±•å¤ªä¹…ï¼Œè¿èƒŒåˆå¿ƒã€‚é…ç½®ååˆ†ç¹çï¼Œâ€œé…ç½®åœ°ç‹±â€ã€‚</p>
<h2 id="2-IOCç†è®ºæ¨å¯¼"><a href="#2-IOCç†è®ºæ¨å¯¼" class="headerlink" title="2. IOCç†è®ºæ¨å¯¼"></a>2. IOCç†è®ºæ¨å¯¼</h2><p>1.UserDao</p>
<p>2.UserDaoImpl å®ç°ç±»</p>
<p>3.UserServiceä¸šåŠ¡æ¥å£</p>
<p>4.UserServiceImplä¸šåŠ¡å®ç°ç±»</p>
<p>æœ€åˆçš„UserServiceImpl ç”¨æˆ·çš„éœ€æ±‚ ç”¨æˆ·è°ƒç”¨çš„æ˜¯ä¸šåŠ¡å±‚ï¼Œdaoå±‚å®é™…ä¸ä¸ä»–ä»¬æ¥è§¦</p>
<pre><code>    private UserDao userDao = new UserDaoOracleImpl();
    //ä¸Šé¢ä¸€è¡Œä»£ç å°†æ ¹æ®ç”¨æˆ·éœ€æ±‚ä¿®æ”¹
    public void getUser() &#123;
        userDao.getUser();
    &#125;
</code></pre>
<p>setåŠ¨æ€å®ç°Javaå€¼çš„æ³¨å…¥</p>
<pre><code>    private UserDao userDao = new UserDaoOracleImpl();

    //åˆ©ç”¨Setè¿›è¡ŒåŠ¨æ€å®ç°å€¼çš„æ³¨å…¥
    public void setUserDao(UserDao userDao) &#123;
        this.userDao = userDao;
    &#125;

    public void getUser() &#123;
        userDao.getUser();
    &#125;
</code></pre>
<p>åœ¨ä¹‹å‰çš„ä¸šåŠ¡ä¸­ï¼Œç”¨æˆ·çš„éœ€æ±‚ä¼šå½±å“åŸæ¥çš„ä»£ç ï¼Œéœ€è¦æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚å»ä¿®æ”¹åŸä»£ç </p>
<p>åœ¨ä»£ç é‡å¤§æ—¶ï¼Œä¿®æ”¹ä¸€æ¬¡çš„æˆæœ¬æé«˜</p>
<p>å› æ­¤ï¼Œåˆ©ç”¨ä¸€ä¸ªsetæ¥å£å®ç°ã€‚å‘ç”Ÿäº†ä¸€ä¸ªé©å‘½æ€§çš„å˜åŒ–ã€‚</p>
<ul>
<li>ä¹‹å‰ç¨‹åºæ˜¯ä¸»åŠ¨åˆ›å»ºå¯¹è±¡ï¼Œæ§åˆ¶æƒåœ¨ç¨‹åºå‘˜æ‰‹ä¸Š</li>
<li>ä½¿ç”¨setæ³¨å…¥åï¼Œç¨‹åºä¸å†å…·æœ‰ä¸»åŠ¨æ€§ï¼Œè¢«åŠ¨æ¥å—å¯¹è±¡ã€‚</li>
</ul>
<p>è¿™ä¸€æ€æƒ³ï¼Œä»æœ¬è´¨ä¸Šè§£å†³äº†é—®é¢˜ï¼Œä¸ç”¨ç¨‹åºå‘˜è‡ªå·±å†å»ç®¡ç†å¯¹è±¡çš„åˆ›å»ºã€‚</p>
<p>è€¦åˆæ€§å¤§å¤§é™ä½ï¼Œå¯ä»¥ä¸“æ³¨äºå®ç°ä¸šåŠ¡ã€‚è¿™æ˜¯IOCçš„åŸå‹ã€‚</p>
<h2 id="3-IOCæœ¬è´¨"><a href="#3-IOCæœ¬è´¨" class="headerlink" title="3.IOCæœ¬è´¨"></a>3.IOCæœ¬è´¨</h2><p><strong>æ§åˆ¶åè½¬ï¼ˆIoC)æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼ŒDIï¼ˆä¾èµ–æ³¨å…¥ï¼‰æ˜¯å®ç°IOCçš„ä¸€ç§æ–¹æ³•</strong>ï¼Œä¹Ÿæœ‰äººè®¤ä¸ºDIåªæ˜¯IoCçš„å¦ä¸€ç§è¯´æ³•ã€‚æ²¡æœ‰IoCçš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå¯¹è±¡çš„åˆ›å»ºä¸å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å®Œå…¨ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºç”±ç¨‹åºè‡ªå·±æ§åˆ¶ã€‚æ§åˆ¶åè½¬åï¼Œå°†å¯¹è±¡çš„åˆ›å»ºè½¬ç§»<strong>ç»™ç¬¬ä¸‰æ–¹</strong>ã€‚ä¸ªäººè®¤ä¸ºæ§åˆ¶åè½¬å°±æ˜¯ï¼šè·å¾—ä¾èµ–å¯¹è±¡çš„æ–¹å¼åè½¬äº†ã€‚</p>
<p>é‡‡ç”¨XMLæ–¹å¼é…ç½®Beançš„æ—¶å€™ï¼ŒBeançš„å®šä¹‰ä¿¡æ¯æ˜¯å’Œå®ç°åˆ†ç¦»çš„ï¼Œè€Œé‡‡ç”¨æ³¨è§£çš„æ–¹å¼å¯ä»¥æŠŠä¸¤è€…åˆä¸ºä¸€ä½“ï¼ŒBeançš„å®šä¹‰ä¿¡æ¯ç›´æ¥ä»¥æ³¨è§£çš„å½¢å¼å®šä¹‰åœ¨å®ç°ç±»ä¸­ï¼Œä»è€Œè¾¾åˆ°äº†é›¶é…ç½®çš„ç›®çš„ã€‚</p>
<p>æ§åˆ¶åè½¬æ˜¯ä¸€ç§é€šè¿‡æè¿°ï¼ˆxmlæˆ–æ³¨è§£ï¼‰å¹¶é€šè¿‡ç¬¬ä¸‰æ–¹ç”Ÿäº§æˆ–è·å–ç‰¹å®šå¯¹è±¡çš„æ–¹å¼ã€‚åœ¨Springä¸­å®ç°æ§åˆ¶åè½¬çš„æ˜¯IoCå®¹å™¨ï¼Œå…¶å®ç°æ–¹æ³•æ˜¯ä¾èµ–æ³¨å…¥ã€‚</p>
<p>beans.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;
&lt;!--    ä½¿ç”¨Springæ¥åˆ›å»ºå¯¹è±¡ï¼Œåœ¨Springä¸­éƒ½æˆä¸ºBean--&gt;
&lt;!--    bean=å¯¹è±¡  id=å˜é‡å class=newçš„å¯¹è±¡ property--&gt;
  &lt;!--    refï¼šå¼•ç”¨Springå®¹å™¨ä¸­åˆ›å»ºå¥½çš„å¯¹è±¡ valueåªèƒ½ç»™åŸºæœ¬çš„æ•°æ®ç±»å‹èµ‹å€¼--&gt;
    ç¤ºä¾‹ï¼š&lt;bean id=&quot;hello&quot; class=&quot;com.fan.pojo.Hello&quot;&gt;
        &lt;property name=&quot;str&quot; value=&quot;Spring&quot;/&gt;
    &lt;/bean&gt;

&lt;/beans&gt;
</code></pre>
<p>é€šè¿‡Springæ¥åˆ›å»ºå¯¹è±¡ï¼ŒSpringæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œæœ‰éœ€è¦ç›´æ¥å»å…¶ä¸­å–å‡ºï¼Œè€Œä¸æ˜¯ç”¨å¸¸è§„çš„newæ“ä½œ</p>
<p><strong>é…ç½®çš„è§£é‡Šï¼š</strong> ä¸€ä¸ªbeanå¯¹åº”ä¸€ä¸ªå¯¹è±¡ ,id&#x3D;å˜é‡å(æƒ³è¦åˆ›å»ºçš„å¯¹è±¡) class&#x3D;å¯¹è±¡å¯¹åº”çš„ç±»ï¼Œbeanä¸­çš„nameæ˜¯åˆ«åä¸”å¯ä»¥å‘½åå¤šä¸ª</p>
<p>propertyä¸­çš„name&#x3D;å¯¹è±¡çš„å±æ€§ value&#x3D;è¦èµ‹ç»™å¯¹è±¡çš„å€¼</p>
<p><strong>ä»Šæ—¥å°ç»“</strong>ï¼šä¸€å¼€å§‹ï¼Œéœ€è¦åœ¨äº‹åŠ¡å±‚æ ¹æ®ç”¨æˆ·è¯·æ±‚åˆ›å»ºå¤šä¸ªå¯¹è±¡ã€‚</p>
<p> setDaoåï¼Œåªéœ€è¦åœ¨ç”¨æˆ·ç«¯ä¿®æ”¹ä»£ç å³å¯</p>
<p> æ­¤å³Springæ§åˆ¶åè½¬çš„é›å½¢ï¼Œç¨‹åºç”±ä¸»åŠ¨åˆ›å»ºå¯¹è±¡å˜ä¸ºè¢«åŠ¨åœ°æ¥å—å¯¹è±¡ã€‚</p>
<p>ä¸€å¥è¯ï¼Œå¯¹è±¡ç”±Spring åˆ›å»º ç®¡ç† è£…é…</p>
<h2 id="4-IoCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"><a href="#4-IoCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼" class="headerlink" title="4.IoCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"></a>4.IoCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼</h2><p>1.ä½¿ç”¨æ— å‚æ„é€ åˆ›å»ºå¯¹è±¡â€”â€”é»˜è®¤</p>
<p><strong>2.å‡è®¾ä½¿ç”¨æœ‰å‚æ„é€ å¯¹è±¡</strong></p>
<p>â‘ ä¸‹æ ‡èµ‹å€¼</p>
<pre><code>&lt;bean id=&quot;user&quot; class=&quot;com.fan.pojo.User&quot;&gt;
        &lt;constructor-arg index=&quot;0&quot; value=&quot;Javaç‰›é€¼&quot;/&gt;
    &lt;/bean&gt;
</code></pre>
<p>â‘¡é€šè¿‡ç±»å‹åˆ›å»ºâ€”â€”ä¸å»ºè®®ä½¿ç”¨</p>
<pre><code>  &lt;bean id=&quot;user&quot; class=&quot;com.fan.pojo.User&quot;&gt;
        &lt;constructor-arg type=&quot;java.lang.String&quot; value=&quot;Javaç‰›é€¼&quot;/&gt;
    &lt;/bean&gt;
</code></pre>
<p>â‘¢ç›´æ¥é€šè¿‡å‚æ•°åèµ‹å€¼ â€“æ„Ÿè§‰è¾ƒæ­£å¸¸</p>
<pre><code>&lt;bean id=&quot;user&quot; class=&quot;com.fan.pojo.User&quot;&gt;
    &lt;constructor-arg name=&quot;name&quot; value=&quot;Javaä½ ç‰›é€¼&quot;/&gt;
&lt;/bean&gt;
</code></pre>
<p>æ€»ç»“ï¼šåœ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ—¶å€™ï¼Œå®¹å™¨ä¸­ç®¡ç†çš„å¯¹è±¡å°±å·²ç»åˆå§‹åŒ–äº†ã€‚</p>
<p>ï¼ˆå¯ä»¥è·å¾—beans.xmlæ‰€æœ‰çš„beanå¯¹åº”çš„å¯¹è±¡ã€‚ï¼‰</p>
<h2 id="5-Springé…ç½®"><a href="#5-Springé…ç½®" class="headerlink" title="5. Springé…ç½®"></a>5. Springé…ç½®</h2><h3 id="5-1-åˆ«å"><a href="#5-1-åˆ«å" class="headerlink" title="5.1 åˆ«å"></a>5.1 åˆ«å</h3><p>ç±»ä¼¼äºmybatisä¸­çš„ï¼Œè·Ÿidèµ·ä¸ªåˆ«å</p>
<pre><code>&lt;alias name=&quot;user&quot; alias=&quot;dasdaw&quot;/&gt;
</code></pre>
<h3 id="5-2-beançš„é…ç½®"><a href="#5-2-beançš„é…ç½®" class="headerlink" title="5.2 beançš„é…ç½®"></a>5.2 beançš„é…ç½®</h3><pre><code>&lt;!--    idï¼šbeançš„å”¯ä¸€æ ‡å¿—ç¬¦ï¼Œå³ä¹‹å‰çš„å¯¹è±¡å
    class:beanå¯¹è±¡æ‰€å¯¹åº”çš„ç±»å‹ï¼ˆåŒ…å+ç±»å‹ï¼‰
    name:ä¹Ÿæ˜¯åˆ«å nameæ›´é«˜çº§ ä¸”å¯ä»¥åŒæ—¶å–å¤šä¸ªåˆ«å--&gt;
&lt;bean id=&quot;userTest&quot; class=&quot;com.fan.pojo.UserTest&quot; name=&quot;basss, u2&quot;&gt;
    &lt;property name=&quot;name&quot; value=&quot;ç‰›é€¼å•ŠSpring&quot;/&gt;
&lt;/bean&gt;
</code></pre>
<h3 id="5-3-import"><a href="#5-3-import" class="headerlink" title="5.3 import"></a>5.3 import</h3><p>ä¸€èˆ¬é‚£ä¸ªäºå›¢é˜Ÿå¼€å‘ï¼Œå¯ä»¥å°†å¤šä¸ªé…ç½®å¼€å‘å¯¼å…¥åˆå¹¶ä¸ºä¸€ä¸ª</p>
<p>applicationContext.xml</p>
<pre><code>&lt;import resource=&quot;beans.xml&quot;/&gt;
&lt;import resource=&quot;beans2.xml&quot;/&gt;
&lt;import resource=&quot;beans3.xml&quot;/&gt;
</code></pre>
<h2 id="6-ä¾èµ–æ³¨å…¥"><a href="#6-ä¾èµ–æ³¨å…¥" class="headerlink" title="6. ä¾èµ–æ³¨å…¥"></a>6. ä¾èµ–æ³¨å…¥</h2><p>DIï¼ˆDependency Injectionï¼‰çš„é‡ç‚¹æ˜¯åœ¨ç³»ç»Ÿè¿è¡Œæ—¶ï¼ŒåŠ¨æ€åœ°ä¸ºæŸä¸ªå¯¹è±¡æä¾›å…¶æ‰€éœ€è¦çš„å¯¹è±¡ã€‚</p>
<p>ï¼ˆæœ‰ç‚¹é¡¾å®¢ä¸Šé¥­åº—åƒé¥­ç‚¹èœçš„æ„Ÿè§‰ï¼ŒIoCå®¹å™¨å°±æ˜¯ä¸ªé¥­é¦†ï¼Œå¯¹è±¡ä½œä¸ºBeanæ˜¯ä¸€é“é“èœï¼Œä½œä¸ºå¯¹è±¡æ—¶å°±æ˜¯é¡¾å®¢ï¼Œä¾èµ–æ³¨å…¥å°±æ˜¯ä¸Šèœçš„ä¸€ç§æ–¹å¼ï¼Œé‚£èœåˆæ˜¯æ€ä¹ˆåšçš„å‘¢ã€‚åå°„ã€‚å¨å­æ˜¯è°å‘¢ã€‚Springå®¹å™¨ã€‚ï¼‰</p>
<h3 id="6-1-æ„é€ å™¨æ³¨å…¥"><a href="#6-1-æ„é€ å™¨æ³¨å…¥" class="headerlink" title="6.1 æ„é€ å™¨æ³¨å…¥"></a>6.1 æ„é€ å™¨æ³¨å…¥</h3><p>è§ä¸Šæ–‡</p>
<h3 id="6-2-setæ–¹å¼æ³¨å…¥"><a href="#6-2-setæ–¹å¼æ³¨å…¥" class="headerlink" title="6.2 setæ–¹å¼æ³¨å…¥"></a>6.2 setæ–¹å¼æ³¨å…¥</h3><ul>
<li><p>ä¾èµ–æ³¨å…¥ï¼šsetæ³¨å…¥</p>
<p>ä¾èµ–ï¼šbeanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨</p>
<p>æ³¨å…¥: beanå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œç”±å®¹å™¨æ¥æ³¨å…¥</p>
<p>ã€ç¯å¢ƒæ­å»ºã€‘</p>
<p>1.å¤æ‚ç±»å‹</p>
<pre><code>public class Address &#123;
    private String address;

    public String getAddress() &#123;
        return address;
    &#125;

    public void setAddress(String address) &#123;
        this.address = address;
    &#125;
&#125;
</code></pre>
<p>2.æµ‹è¯•å¯¹è±¡</p>
<pre><code>public class Student &#123;
            private String name;  //value
            private Address address; //ref
            private String[] books;
            private List&lt;Student&gt; hobbys;
            private Map&lt;String, String&gt; card;
            private Set&lt;String&gt; games;
            private String wife;
            private Properties info;
&#125;
</code></pre>
</li>
</ul>
<p> 3.beans.xml</p>
<pre><code>   &lt;bean id=&quot;student&quot; class=&quot;com.fan.pojo.Student&quot;&gt;
&lt;!--        ç¬¬ä¸€ç§æ™®é€šçº¸æ³¨å…¥,value--&gt;
        &lt;property name=&quot;name&quot; value=&quot;çƒ¦çƒ¦&quot;/&gt;
    &lt;/bean&gt;
</code></pre>
<p> 4.æµ‹è¯•ç±»</p>
<pre><code>public class MyTest &#123;
    public static void main(String[] args) &#123;
        ApplicationContext context = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);
        Student student = (Student) context.getBean(&quot;student&quot;);
        System.out.println(student.getAddress());
    &#125;

&#125;
</code></pre>
<p>å®Œå–„æ³¨å…¥ä¿¡æ¯ â€”â€”æ³¨æ„æ³¨é‡Š</p>
<pre><code>    &lt;bean id=&quot;address&quot; class=&quot;com.fan.pojo.Address&quot;&gt;
        &lt;property name=&quot;address&quot; value=&quot;éƒ‘å·&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id=&quot;student&quot; class=&quot;com.fan.pojo.Student&quot;&gt;
&lt;!--        1 æ™®é€šå€¼æ³¨å…¥,value--&gt;
        &lt;property name=&quot;name&quot; value=&quot;çƒ¦çƒ¦&quot;/&gt;
&lt;!--        2 beanæ³¨å…¥. ref
æ³¨æ„ä¸è¦åœ¨adressçš„beanä¸­æ³¨å…¥ï¼Œå› ä¸ºadrresså¯¹è±¡æ˜¯åœ¨Studentç±»ä¸­å£°æ˜çš„
ä¸”ä¸æ˜¯åœ¨æ­¤å¤„èµ‹å€¼--&gt;
        &lt;property name=&quot;address&quot; ref=&quot;address&quot;/&gt;

&lt;!--        3. æ•°ç»„æ³¨å…¥ propertyä¸­å†èµ‹å€¼--&gt;
        &lt;property name=&quot;books&quot; &gt;
            &lt;array&gt;
                &lt;value&gt;è¥¿æ¸¸è®°&lt;/value&gt;
                &lt;value&gt;çº¢æ¥¼æ¢¦&lt;/value&gt;
                &lt;value&gt;ä¸‰å›½æ¼”ä¹‰&lt;/value&gt;
                &lt;value&gt;éƒ­å¾·çº²ç›¸å£°é€‰&lt;/value&gt;
            &lt;/array&gt;
        &lt;/property&gt;
&lt;!--        4. listæ³¨å…¥ ç±»æ¯”æ•°ç»„--&gt;
        &lt;property name=&quot;hobbys&quot;&gt;
            &lt;list&gt;
                &lt;value&gt;åƒé¥­&lt;/value&gt;
                &lt;value&gt;ç¡è§‰&lt;/value&gt;
                &lt;value&gt;æ‰“è±†è±†&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
&lt;!--        5. mapæ³¨å…¥ ä¸ä¸Šæœ‰æ‰€ä¸åŒ å› ä¸ºæ˜¯é”®å€¼å¯¹--&gt;
        &lt;property name=&quot;card&quot;&gt;
            &lt;map&gt;
                &lt;entry key=&quot;èº«ä»½è¯&quot; value=&quot;414241241244&quot;/&gt;
                &lt;entry key=&quot;é“¶è¡Œå¡&quot; value=&quot;60234325645&quot;/&gt;
            &lt;/map&gt;
        &lt;/property&gt;
&lt;!--        6.setæ³¨å…¥--&gt;
        &lt;property name=&quot;games&quot;&gt;
            &lt;set&gt;
                &lt;value&gt;LOL&lt;/value&gt;
                &lt;value&gt;COC&lt;/value&gt;
                &lt;value&gt;GTA&lt;/value&gt;
            &lt;/set&gt;
        &lt;/property&gt;
&lt;!--        7. ç©ºå€¼æ³¨å…¥--&gt;
        &lt;property name=&quot;wife&quot;&gt;
            &lt;null/&gt;
        &lt;/property&gt;
&lt;!--        Propertise ç±»ä¼¼map--&gt;
        &lt;property name=&quot;info&quot;&gt;
            &lt;props&gt;
                &lt;prop key=&quot;å­¦å·&quot;&gt;2017777777&lt;/prop&gt;
                &lt;prop key=&quot;æ€§åˆ«&quot;&gt;ç”·&lt;/prop&gt;
                &lt;prop key=&quot;username&quot;&gt;root&lt;/prop&gt;
                &lt;prop key=&quot;password&quot;&gt;woaini&lt;/prop&gt;

            &lt;/props&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
</code></pre>
<h3 id="6-3-æ‹“å±•æ–¹å¼"><a href="#6-3-æ‹“å±•æ–¹å¼" class="headerlink" title="6.3 æ‹“å±•æ–¹å¼"></a>6.3 æ‹“å±•æ–¹å¼</h3><p>æ³¨æ„ï¼špå‘½åå’Œcå‘½åæ§ä»¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦å¯¼å…¥xmlçº¦æŸ</p>
<pre><code>xmlns:p=&quot;http://www.springframework.org/schema/p&quot;
xmlns:c=&quot;http://www.springframework.org/schema/c&quot;
&lt;!--    på‘½åç©ºé—´æ³¨å…¥ å¯ä»¥ç›´æ¥æ³¨å…¥å±æ€§çš„å€¼--&gt;
    &lt;bean id=&quot;user&quot; class=&quot;com.fan.pojo.User&quot; p:name=&quot;Javaæ— æ•Œ&quot; p:age=&quot;18&quot;&gt;

    &lt;/bean&gt;
</code></pre>
<p>æ³¨æ„è¦æ·»åŠ æœ‰å‚æ„é€  æ— å‚æ„é€ </p>
<pre><code>&lt;!--    cå‘½åç©ºé—´æ³¨å…¥ é€šè¿‡æ„é€ å™¨ï¼ˆæ„é€ æ–¹æ³•ï¼‰æ³¨å…¥--&gt;
&lt;bean id=&quot;user2&quot; class=&quot;com.fan.pojo.User&quot; c:age=&quot;18&quot; c:name=&quot;fanfan&quot;/&gt;
</code></pre>
<p>æµ‹è¯•</p>
<pre><code>@Test
public void test() &#123;
    ApplicationContext context = new ClassPathXmlApplicationContext(&quot;userbean.xml&quot;);
    User user = (User) context.getBean(&quot;user2&quot;);
    System.out.println(user  );

&#125;
</code></pre>
<h3 id="6-4-beançš„ä½œç”¨åŸŸ"><a href="#6-4-beançš„ä½œç”¨åŸŸ" class="headerlink" title="6.4 beançš„ä½œç”¨åŸŸ"></a>6.4 beançš„ä½œç”¨åŸŸ</h3><p><img src="/" alt="image-20210126161630554"></p>
<p>1.å•ä¾‹æ¨¡å¼ï¼ˆSpringé»˜è®¤æœºåˆ¶ï¼‰</p>
<pre><code>&lt;bean id=&quot;user2&quot; class=&quot;com.fan.pojo.User&quot; c:age=&quot;18&quot; c:name=&quot;fanfan&quot; scope=&quot;singleton&quot;/&gt;
</code></pre>
<p>2.åŸå‹æ¨¡å¼ï¼šæ¯æ¬¡ä»å®¹å™¨ä¸­getçš„æ—¶å€™ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°å¯¹è±¡</p>
<pre><code>&lt;bean id=&quot;user2&quot; class=&quot;com.fan.pojo.User&quot; c:age=&quot;18&quot; c:name=&quot;fanfan&quot; scope=&quot;prototype&quot;/&gt;
</code></pre>
<p>3.å…¶ä½™çš„request session applicationåªåœ¨webå¼€å‘ä¸­ä½¿ç”¨åˆ°</p>
<h2 id="7-Beançš„è‡ªåŠ¨è£…é…"><a href="#7-Beançš„è‡ªåŠ¨è£…é…" class="headerlink" title="7. Beançš„è‡ªåŠ¨è£…é…"></a>7. Beançš„è‡ªåŠ¨è£…é…</h2><ul>
<li>è‡ªåŠ¨è£…é…æ˜¯Springæ»¡è¶³beanä¾èµ–ä¸€ç§æ–¹å¼</li>
<li>è‡ªåŠ¨ï¼šSpringä¼šåœ¨ä¸Šä¸‹æ–‡ä¸­è‡ªåŠ¨å¯»æ‰¾ï¼Œè‡ªåŠ¨ç»™beanè£…é…å±æ€§</li>
</ul>
<p>åœ¨Springä¸­æœ‰æœ‰ä¸‰ç§è‡ªåŠ¨è£…é…åœ¨çš„æ–¹å¼</p>
<ol>
<li>åœ¨XMLä¸­æ˜¾å¼çš„é…ç½®</li>
<li>åœ¨Javaä¸­æ˜¾å¼é…ç½®</li>
<li><strong>éšå¼çš„è‡ªåŠ¨è£…é…beanï¼ï¼ï¼</strong></li>
</ol>
<p>æ­¤å¤„ä¸»è¦è®²è¿°ç¬¬ä¸‰ç§ï¼šä¸¤ä¸ªè§’åº¦â‘ ç»„ä»¶æ‰«æ è‡ªåŠ¨å‘ç°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­çš„bean</p>
<p> â‘¡è‡ªåŠ¨è£…é…springè‡ªåŠ¨æ»¡è¶³beanä¹‹é—´çš„ä¾èµ–</p>
<h3 id="7-1-æµ‹è¯•"><a href="#7-1-æµ‹è¯•" class="headerlink" title="7.1 æµ‹è¯•"></a>7.1 æµ‹è¯•</h3><p>1.ç¯å¢ƒæ­å»º</p>
<p>ä¸€ä¸ªäºº ä¸¤åªå® ç‰© â€“ç¼–ç¨‹æ€ç»´</p>
<p>ä¸‰ä¸ªå®ä½“åˆ— Dog Cat å®ç°ä¸€ä¸ªç®€å•çš„æ‰“å°æ–¹æ³• åœ¨Peopleä¸­åˆ›å»ºä¸€ä¸ªcat dogå¯¹è±¡</p>
<h3 id="7-2-byNameè‡ªåŠ¨è£…é…"><a href="#7-2-byNameè‡ªåŠ¨è£…é…" class="headerlink" title="7.2 byNameè‡ªåŠ¨è£…é…"></a>7.2 byNameè‡ªåŠ¨è£…é…</h3><p>çœç•¥äº†é…ç½®</p>
<pre><code>       &lt;property name=&quot;cat&quot; ref=&quot;cat&quot;/&gt;
        &lt;property name=&quot;dog&quot; ref=&quot;dog&quot;/&gt;
</code></pre>
<p>byNameï¼šä¼šè‡ªåŠ¨åœ¨å®¹å™¨ä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡setæ–¹æ³•åé¢çš„å€¼å¯¹åº”çš„beançš„id</p>
<pre><code>&lt;bean id=&quot;dog&quot; class=&quot;com.fan.pojo.Dog&quot;/&gt;
&lt;bean id=&quot;cat&quot; class=&quot;com.fan.pojo.Cat&quot;/&gt;
    &lt;bean id=&quot;people&quot; class=&quot;com.fan.pojo.People&quot; autowire=&quot;byName&quot;&gt;
        &lt;property name=&quot;name&quot; value=&quot;JAvaä¹‹ç¥&quot;/&gt;
    &lt;/bean&gt;
</code></pre>
<h3 id="7-3-byTypeè‡ªåŠ¨è£…é…"><a href="#7-3-byTypeè‡ªåŠ¨è£…é…" class="headerlink" title="7.3 byTypeè‡ªåŠ¨è£…é…"></a>7.3 byTypeè‡ªåŠ¨è£…é…</h3><p>idç”šè‡³å¯ä»¥çœç•¥ï¼ï¼ï¼byType:è‡ªåŠ¨åœ¨å®¹å™¨ä¸Šä¸‹æ–‡å¯»æ‰¾ï¼Œä¸è‡ªå·±å¯¹è±¡å±æ€§ç±»å‹ç›¸åŒçš„bean ä½†æ˜¯ å¿…é¡»<strong>æ­¤ç±»å‹å…¨å±€å”¯ä¸€</strong></p>
<pre><code>    &lt;bean class=&quot;com.fan.pojo.Cat&quot;/&gt;
    &lt;bean class=&quot;com.fan.pojo.Dog&quot;/&gt;
    &lt;bean id=&quot;people&quot; class=&quot;com.fan.pojo.People&quot; autowire=&quot;byType&quot;&gt;
        &lt;property name=&quot;name&quot; value=&quot;JAvaä¹‹ç¥&quot;/&gt;
    &lt;/bean&gt;
</code></pre>
<p>å°ç»“ï¼šbyName æ‰€æœ‰beançš„idå”¯ä¸€ï¼Œå¹¶ä¸”è¿™ä¸ªbeanéœ€è¦å’Œè‡ªåŠ¨æ³¨å…¥çš„å±æ€§çš„setæ–¹æ³•çš„å€¼ä¸€è‡´</p>
<p> byTypeéœ€è¦æ‰€æœ‰beançš„classå”¯ä¸€ï¼Œå¹¶ä¸”è¿™ä¸ªbeanéœ€è¦å’Œè‡ªåŠ¨æ³¨å…¥çš„å±æ€§çš„ç±»å‹ä¸€è‡´</p>
<h3 id="7-4-ä½¿ç”¨æ³¨è§£è‡ªåŠ¨è£…é…"><a href="#7-4-ä½¿ç”¨æ³¨è§£è‡ªåŠ¨è£…é…" class="headerlink" title="7.4 ä½¿ç”¨æ³¨è§£è‡ªåŠ¨è£…é…"></a>7.4 ä½¿ç”¨æ³¨è§£è‡ªåŠ¨è£…é…</h3><p>ä½¿ç”¨æ³¨è§£é¡»çŸ¥ï¼š</p>
<p>å¯¼å…¥çº¦æŸ:contextçº¦æŸ çº¦æŸæ–‡ä»¶å¯ç›´æ¥ä½¿ç”¨beans.xmlçº¦æŸç•¥ä½œä¿®æ”¹</p>
<p>é…ç½®æ³¨è§£çš„æ”¯æŒï¼šcontext:annotation-config&#x2F;</p>
<pre><code>&lt;context:annotation-config/&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        https://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;
  &lt;!-- å¼€å¯æ³¨è§£çš„æ”¯æŒ--&gt;
    &lt;context:annotation-config/&gt;
&lt;/beans&gt;
</code></pre>
<p>@Autowired</p>
<pre><code>//å¦‚æœæ˜¾ç¤ºå®šä¹‰äº†Autowiredçš„requireå±æ€§ä¸ºfalseï¼Œè¯´æ˜è¯¥å¯¹è±¡å¯ä»¥ä¸ºnull
@Autowired(required = false)
</code></pre>
<p>ç›´æ¥åœ¨å±æ€§ä¸Šä½¿ç”¨å³å¯ï¼Œä¹Ÿå¯åœ¨setæ–¹å¼ä¸Šä½¿ç”¨ã€‚</p>
<p>å¯ä»¥çœç•¥æ‰å®ä½“ç±»ä¸­çš„setæ–¹æ³•ï¼Œå‰ææ˜¯è¯¥è‡ªåŠ¨è£…é…çš„å±æ€§åœ¨IOCå®¹å™¨ï¼ˆå³Springå®¹å™¨ï¼‰ä¸­å­˜åœ¨ï¼Œä¸”ç¬¦åˆåå­—ã€‚</p>
<pre><code>@Nullable å­—æ®µæ ‡è®°åˆ™è¡¨æ˜å¯ä»¥ä¸ºç©º 
</code></pre>
<h4 id="Autowiredä¸Qualified"><a href="#Autowiredä¸Qualified" class="headerlink" title="@Autowiredä¸Qualified"></a>@Autowiredä¸Qualified</h4><p>å¦‚æœ@Autowiredè‡ªåŠ¨è£…é…çš„ç¯å¢ƒæ¯”è¾ƒå¤æ‚ï¼ˆæ¯”å¦‚æ²¡æœ‰å¯¹è±¡åä¸idç›¸åŒçš„beanï¼‰ï¼Œè‡ªåŠ¨è£…é…æ— æ³•é€šè¿‡ä¸€ä¸ªæ³¨è§£ã€@Autowierdã€‘å®ç°æ—¶</p>
<p>ä½¿ç”¨@Qualifiedï¼ˆvalue &#x3D; â€œxxxâ€)å»é…ç½®@Autowiredçš„ä½¿ç”¨ï¼ŒæŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„beanå¯¹è±¡æ³¨å…¥</p>
<pre><code>&lt;bean id=&quot;cat1&quot; class=&quot;com.fan.pojo.Cat&quot;/&gt;
&lt;bean id=&quot;cat2&quot; class=&quot;com.fan.pojo.Cat&quot;/&gt;
&lt;bean id=&quot;dog222&quot; class=&quot;com.fan.pojo.Dog&quot;/&gt;
&lt;bean id=&quot;people&quot; class=&quot;com.fan.pojo.People&quot;/&gt;
public class People &#123;
   @Autowired
   @Qualifier(value = &quot;cat1&quot;)
    private Cat cat;
    @Autowired
    @Qualifier(value = &quot;dog222&quot;)
    private Dog dog;
    private String name;
&#125;
</code></pre>
<h4 id="Resource-æ³¨æ„Javaç‰ˆæœ¬çš„é—®é¢˜-1-6ä¹‹å"><a href="#Resource-æ³¨æ„Javaç‰ˆæœ¬çš„é—®é¢˜-1-6ä¹‹å" class="headerlink" title="@Resource(æ³¨æ„Javaç‰ˆæœ¬çš„é—®é¢˜ 1.6ä¹‹å)"></a>@Resource(æ³¨æ„Javaç‰ˆæœ¬çš„é—®é¢˜ 1.6ä¹‹å)</h4><pre><code>public class People &#123;
 
    @Resource(name = &quot;cat2&quot;)
    private Cat cat;
    @Resource
    private Dog dog;
    private String name;
&#125;
</code></pre>
<p>å°ç»“ï¼š@Resouceä¸@Autowiredçš„å…³ç³»ä¸åŒºåˆ«</p>
<ul>
<li>éƒ½æ˜¯ç”¨æ¥è‡ªåŠ¨è£…é…ï¼Œå¯ä»¥æ”¾åœ¨å±æ€§å­—æ®µä¸Š</li>
<li>@Autowiredé€šè¿‡byTypeçš„æ–¹å¼å®ç° --@Auto wiredè¦æ±‚è¯¥å¯¹è±¡å¿…é¡»å­˜åœ¨</li>
<li>@Resourceæ˜¯é»˜è®¤é€šè¿‡byNameå®ç°ï¼Œå¦‚æœæ‰¾ä¸åˆ°åå­—åˆ™é€šè¿‡byTypeå®ç°ã€‚</li>
</ul>
<p>ä¸¤è€…éƒ½æ— æ³•å®ç°ï¼ŒæŠ¥é”™ã€‚</p>
<p>æ‰§è¡Œé¡ºåº: @Autowriedé€šè¿‡byTypeæ–¹å¼å®ç°ã€‚ å½“å…¶æ³¨è§£çš„å¯¹è±¡é…ç½®çš„beanä¸å”¯ä¸€æ—¶åˆ©ç”¨@QualifiedæŒ‡å®šbeançš„id</p>
<p>å³@Autowired ç±»å‹ åå­— @Resource åå­— ç±»å‹</p>
<h2 id="8-ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8-ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8. ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8. ä½¿ç”¨æ³¨è§£å¼€å‘</h2><p>Spring4åè¦ä½¿ç”¨æ³¨è§£å¼€å‘ï¼Œå¿…é¡»<strong>å¯¼å…¥AOPçš„åŒ…</strong></p>
<p><img src="/" alt="image-20210127142326133"></p>
<p>ä½¿ç”¨æ³¨è§£éœ€è¦å¯¼å…¥contextçš„çº¦æŸï¼Œå¢åŠ æ³¨è§£çš„æ”¯æŒã€‚</p>
<p>@Componentï¼šç»„ä»¶ï¼Œè¯´æ˜è¿™ä¸ªç±»è¢«Springç®¡ç†äº†ï¼Œç”Ÿæˆçš„beané»˜è®¤ä¸ºç±»çš„å°å†™å½¢å¼</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        https://www.springframework.org/schema/context/spring-context.xsd
      &quot;&gt;
&lt;!--    æŒ‡å®šè¦æ‰«æçš„åŒ…ï¼Œè¿™ä¸ªåŒ…ä¸‹çš„æ³¨è§£å°±ä¼šç”Ÿæ•ˆ--&gt;
    &lt;context:component-scan base-package=&quot;com.fan.pojo&quot;/&gt;
    &lt;context:annotation-config/&gt;   
&lt;/beans&gt;
</code></pre>
<p>1.bean</p>
<p>2.å±æ€§å¦‚ä½•æ³¨å…¥</p>
<pre><code>public class User &#123;
    //ç›¸å½“äº &lt;property name=&quot;name&quot; value=&quot;å‡¡å‡¡&quot;/&gt;
    @Value(&quot;å‡¡å‡¡&quot;)
    public String name;

&#125;


//ä¹Ÿå¯
    @Value(&quot;å‡¡å‡¡&quot;)
    public void setName(String name) &#123;
        this.name = name;
    &#125;
</code></pre>
<ol>
<li><p>è¡ç”Ÿçš„æ³¨è§£</p>
<p>@Componentæœ‰å‡ ä¸ªè¡ç”Ÿæ³¨è§£ï¼Œ åŠŸèƒ½ç›¸åŒï¼ŒæŒ‰ç…§mvcä¸‰å±‚æ¶æ„åˆ†å±‚</p>
<ul>
<li>dao[@Repository]</li>
<li>service[@Service]</li>
<li>controller[@Controller]</li>
</ul>
<p>éƒ½æ˜¯ä»£è¡¨å°†æŸä¸ªç±»æ³¨å†Œåˆ°Springä¸­ï¼Œè£…é…bean</p>
</li>
<li><p>è‡ªåŠ¨è£…é…</p>
<pre><code>@Autowiredï¼šè‡ªåŠ¨è£…é…é€šè¿‡ ç±»å‹ åå­—ï¼Œä¸èƒ½å”¯ä¸€è‡ªåŠ¨è£…é…å±æ€§ï¼Œç”¨@Qualifiedï¼ˆvalue=&quot;xxx&quot;ï¼‰æŒ‡å®š
@Nullable:å­—æ®µæ ‡è®°äº†è¯¥æ³¨è§£ï¼Œè¯´æ˜è¯¥å­—æ®µå¯ä»¥ä¸ºnull
@Resource:è‡ªåŠ¨è£…é…é€šè¿‡åå­—ï¼Œç±»å‹
</code></pre>
</li>
<li><p>ä½œç”¨åŸŸ</p>
<pre><code>@Component
@Scope(&quot;prototype&quot;)
public class User &#123;
    //ç›¸å½“äº &lt;property name=&quot;name&quot; value=&quot;å‡¡å‡¡&quot;/&gt;
    public String name;
    @Value(&quot;å‡¡å‡¡&quot;)
    public void setName(String name) &#123;
        this.name = name;
    &#125;
&#125;
</code></pre>
</li>
<li><p>å°ç»“</p>
</li>
</ol>
<p>xmlä¸æ³¨è§£ï¼š</p>
<ul>
<li>xmlæ›´ä¸‡èƒ½ï¼Œä½¿ç”¨äºä»»ä½•åœºåˆã€‚ç»´æŠ¤ç®€å•æ–¹ä¾¿</li>
<li>æ³¨è§£ ä¸æ˜¯è‡ªå·±çš„ç±»æ— æ³•ä½¿ç”¨,ç»´æŠ¤å¤æ‚ï¼ˆå…¶ä»–çš„ç±»æ— æ³•å¼•ç”¨è¯¥ç±»ï¼‰</li>
</ul>
<p>xmlä¸æ³¨è§£æœ€ä½³å®è·µ</p>
<ul>
<li>xmlç”¨æ¥ç®¡ç†bean</li>
<li>æ³¨è§£åªè´Ÿè´£æ³¨å…¥å±æ€§</li>
<li>ä½¿ç”¨ä¸­åªéœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼šå¿…é¡»è®©æ³¨è§£ç”Ÿæ•ˆ</li>
</ul>
<pre><code>&lt;!--    æŒ‡å®šè¦æ‰«æçš„åŒ…ï¼Œè¿™ä¸ªåŒ…ä¸‹çš„æ³¨è§£å°±ä¼šç”Ÿæ•ˆ--&gt;
    &lt;context:component-scan base-package=&quot;com.fan&quot;/&gt;
    &lt;context:annotation-config/&gt;
</code></pre>
<h2 id="9-ä½¿ç”¨Javaçš„æ–¹å¼é…ç½®Spring"><a href="#9-ä½¿ç”¨Javaçš„æ–¹å¼é…ç½®Spring" class="headerlink" title="9.ä½¿ç”¨Javaçš„æ–¹å¼é…ç½®Spring"></a>9.ä½¿ç”¨Javaçš„æ–¹å¼é…ç½®Spring</h2><p>ç°åœ¨è¦å®Œæˆä¸ä½¿ç”¨Springçš„xmlé…ç½®äº†ï¼Œå…¨éƒ¨äº¤ç»™Javaæ¥åš</p>
<p>JavaConfigæ˜¯Springçš„ä¸€ä¸ªå­é¡¹ç›®</p>
<p>å®ä½“ç±»</p>
<pre><code>//è¯´æ˜è¯¥ç±»è¢«Springæ¥ç®¡ï¼Œæ³¨å†Œåˆ°äº†å®¹å™¨ä¸­
@Component
public class User &#123;
    private String name;

    public String getName() &#123;
        return name;
    &#125;

    @Value(&quot;ç‰›é€¼&quot;) //æ³¨å…¥å€¼
    public void setName(String name) &#123;
        this.name = name;
    &#125;

    @Override
    public String toString() &#123;
        return &quot;User&#123;&quot; +
                &quot;name=&#39;&quot; + name + &#39;\&#39;&#39; +
                &#39;&#125;&#39;;
    &#125;
&#125;
</code></pre>
<p>é…ç½®æ–‡ä»¶</p>
<pre><code>/*è¿™ä¹Ÿä¼šè¢«Springå®¹å™¨æ‰˜ç®¡ï¼Œæ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚
å› ä¸ºæœ¬è´¨ä¸Š@Component @Configurationä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»
ä¸ä¹‹å‰çš„beans.xmlæ˜¯ä¸€æ ·çš„
 */
@Configuration
@ComponentScan(&quot;com.fan.pojo&quot;)
@Import(FanConfig2.class)
public class FanConfig &#123;
    /*æ³¨å†Œä¸€ä¸ªbeanï¼Œç›¸å½“äºä¹‹å‰åœ¨beans.xmlä¸­å†™çš„ä¸€ä¸ªbean
    è¿™ä¸ªæ–¹æ³•çš„åå­— ç›¸å½“äºid
           è¿”å›å€¼ ç›¸å½“äºclass
     */

    @Bean
    public User getUser() &#123;
        return new User();
    &#125;
&#125;
</code></pre>
<p>æµ‹è¯•ç±»</p>
<pre><code>public class MyTest &#123;
    public static void main(String[] args) &#123;
        //å¦‚æœä½¿ç”¨Javaé…ç½®ç±»æ–¹å¼ï¼Œå°±åªèƒ½é€šè¿‡AnnotationConfigä¸Šä¸‹æ–‡æ¥è·å–å®¹å™¨,é€šè¿‡é…ç½®ç±»çš„classå¯¹è±¡åŠ è½½
        ApplicationContext context = new AnnotationConfigApplicationContext(FanConfig.class);
        User getUser = (User) context.getBean(&quot;user&quot;);
        System.out.println(getUser.getName());
    &#125;
&#125;
</code></pre>
<p>è¿™ç§çº¯Javaçš„é…ç½®æ–¹å¼ï¼Œåœ¨SpringBootä¸­éå¸¸å¸¸è§</p>
<h2 id="10-ä»£ç†æ¨¡å¼"><a href="#10-ä»£ç†æ¨¡å¼" class="headerlink" title="10. ä»£ç†æ¨¡å¼"></a>10. ä»£ç†æ¨¡å¼</h2><p>why:</p>
<p>è¿™æ˜¯SpringAOPçš„åº•å±‚</p>
<p>ä»£ç†æ¨¡å¼çš„åˆ†ç±»ï¼š</p>
<h3 id="10-1-é™æ€ä»£ç†ï¼š"><a href="#10-1-é™æ€ä»£ç†ï¼š" class="headerlink" title="10.1 é™æ€ä»£ç†ï¼š"></a>10.1 é™æ€ä»£ç†ï¼š</h3><p>è§’è‰²åˆ†æï¼š</p>
<ul>
<li>æŠ½è±¡è§’è‰²ï¼šä¸€èˆ¬ä¼šä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»è§£å†³</li>
<li>çœŸå®è§’è‰²ï¼šè¢«ä»£ç†çš„è§’è‰²</li>
<li>ä»£ç†è§’è‰²ï¼šä»£ç†çœŸå®è§’è‰²ï¼Œ<strong>ä»£ç†åä¼šåšä¸€äº›é™„å±æ“ä½œ</strong></li>
<li>å®¢æˆ·ï¼š<strong>è®¿é—®ä»£ç†å¯¹è±¡</strong>çš„äºº</li>
</ul>
<p>ä»£ç æ­¥éª¤ï¼š</p>
<p>æ¥å£</p>
<pre><code>//ç§Ÿæˆ¿æ¥å£
public interface Rent &#123;
    public void rent();
&#125;
</code></pre>
<p>çœŸå®è§’è‰²ï¼ˆåˆ›å»ºå®Œæ¯•åå‡ ä¹æ²¡æœ‰å†æ“ä½œ â€“<strong>å³æ›´çº¯ç²¹äº†</strong>ï¼‰</p>
<pre><code>//æˆ¿ä¸œ
public class Host implements Rent &#123;
    public void rent() &#123;
        System.out.println(&quot;æˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿&quot;);
    &#125;
&#125;
</code></pre>
<p>ä»£ç†è§’è‰²</p>
<pre><code>public class Proxy implements Rent &#123;
    private Host host;

    public Proxy() &#123;
    &#125;

    public Proxy(Host host) &#123;
        this.host = host;
    &#125;

    public void rent() &#123;
        host.rent();
        seeHouse();
        fare();
        contract();
    &#125;

    //çœ‹æˆ¿
    public void seeHouse() &#123;
        System.out.println(&quot;ä¸­ä»‹å¸¦ä½ çœ‹æˆ¿&quot;);
    &#125;

    //æ”¶ä¸­ä»‹è´¹
    public void fare() &#123;
        System.out.println(&quot;æ”¶ä¸­ä»‹è´¹&quot;);
    &#125;

    //ç­¾åˆåŒ
    public void contract() &#123;
        System.out.println(&quot;ç­¾åˆåŒ&quot;);
    &#125;
&#125;
</code></pre>
<p>å®¢æˆ·ç«¯è®¿é—®ä»£ç†è§’è‰²</p>
<pre><code>public class Client &#123;
    public static void main(String[] args) &#123;
        Host host = new Host();
        //ä»£ç† ä¸­ä»‹å¸®æˆ¿ä¸œç§Ÿæˆ¿
        Proxy proxy = new Proxy(host);
        //ä¸ç”¨é¢å¯¹æˆ¿ä¸œï¼Œç›´æ¥æ‰¾ä¸­ä»‹ç§Ÿæˆ¿
        proxy.rent();

    &#125;
&#125;
</code></pre>
<p>ä»£ç†æ¨¡å¼çš„å¥½å¤„ï¼š</p>
<ul>
<li>å¯ä»¥ä½¿çœŸå®è§’è‰²çš„æ“ä½œ<strong>æ›´åŠ çº¯ç²¹</strong>ã€‚ä¸ç”¨å»å…³æ³¨ä¸€äº›å…¬å…±çš„ä¸šåŠ¡</li>
<li>å…¬å…±ä¸šåŠ¡ä¹Ÿå°±äº¤ç»™äº†ä»£ç†è§’è‰²ï¼Œ<strong>å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥</strong></li>
<li>å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•çš„æ—¶å€™ï¼Œ<strong>æ–¹ä¾¿é›†ä¸­ç®¡ç†</strong>ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<p>ä¸€ä¸ªçœŸå®è§’è‰²å°±ä¼šäº§ç”Ÿä¸€ä¸ªä»£ç†è§’è‰² â€“é€ æˆä»£ç é‡å·¨å¤šï¼Œå¼€å‘æ•ˆç‡ä½</p>
<h3 id="10-2-æ·±å…¥ç†è§£"><a href="#10-2-æ·±å…¥ç†è§£" class="headerlink" title="10.2 æ·±å…¥ç†è§£"></a>10.2 æ·±å…¥ç†è§£</h3><p><img src="/" alt="image-20210127160232490"></p>
<p>æ¥å£</p>
<pre><code>public interface UserService &#123;
    public void add();
    public void delete();
    public void update();
    public void query();
&#125;
</code></pre>
<p>ä¸šåŠ¡å±‚</p>
<pre><code>public class UserServiceImpl implements UserService &#123;

    public void add() &#123;
        System.out.println(&quot;å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·&quot;);
    &#125;

    public void delete() &#123;
        System.out.println(&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;);
    &#125;

    public void update() &#123;
        System.out.println(&quot;ä¿®æ”¹äº†ä¸€ä¸ªç”¨æˆ·&quot;);
    &#125;

    public void query() &#123;
        System.out.println(&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;);
    &#125;
&#125;
</code></pre>
<p>ç†è§£ï¼šæ­¤æ—¶è‹¥è¦å¢åŠ æ–°çš„åŠŸèƒ½ï¼Œä¸æ”¹å˜åŸæœ‰ä»£ç åˆ™éœ€å¢åŠ ä¸€ä»£ç†è§’è‰²ã€‚ â€“ é™ä½è€¦åˆåº¦</p>
<p>ä»£ç† setä¸€ä¸ªUserSeriviceä½¿å¾—ä¿®æ”¹åŸä¸šåŠ¡å±‚ä¸­çš„ä»£ç æ›´ç®€åŒ–</p>
<pre><code>public class Proxy implements UserService &#123;
    private UserServiceImpl userService;
    public void setUserService(UserServiceImpl userService) &#123;
        this.userService = userService;
    &#125;
    public void add() &#123;
        log(&quot;add&quot;);
        userService.add();
    &#125;
    public void delete() &#123;
        log(&quot;delete&quot;);
        userService.delete();

    &#125;
    public void update() &#123;
        log(&quot;update&quot;);
        userService.update();

    &#125;
    public void query() &#123;
        log(&quot;query&quot;);
        userService.query();

    &#125;
    //å…¬å…±ä¸šåŠ¡æå–ä¸ºä¸€ä¸ªæ–¹æ³•
    public void log (String msg) &#123;
        System.out.println(&quot;ä½¿ç”¨äº†&quot;+msg+&quot;æ–¹æ³•&quot;);
    &#125;

&#125;
</code></pre>
<p>å®¢æˆ·ç«¯</p>
<pre><code>public static void main(String[] args) &#123;
    UserServiceImpl userService = new UserServiceImpl();
    Proxy proxy = new Proxy();
    proxy.setUserService(userService);
    proxy.delete();
&#125;
</code></pre>
<h3 id="10-3-åŠ¨æ€ä»£ç†"><a href="#10-3-åŠ¨æ€ä»£ç†" class="headerlink" title="10.3 åŠ¨æ€ä»£ç†"></a>10.3 åŠ¨æ€ä»£ç†</h3><ul>
<li>åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†è§’è‰²ä¸€æ ·</li>
<li>åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œä¸æ˜¯äººä¸ºç›´æ¥å†™å¥½</li>
<li>åŠ¨æ€ä»£ç†åˆ†ä¸ºä¸¤å¤§ç±»ï¼šåŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†ï¼ŒåŸºäºç±»çš„åŠ¨æ€ä»£ç†<ul>
<li>åŸºäºæ¥å£ â€“JDKåŠ¨æ€ä»£ç†</li>
<li>åŸºäºç±»ï¼šcglib</li>
<li>javaå­—èŠ‚ç å®ç°ï¼šJAVAssist</li>
</ul>
</li>
</ul>
<p>éœ€è¦äº†è§£ä¸¤å¤§ç±»ï¼šProxyï¼šä»£ç† InvacationHandlerï¼šè°ƒç”¨å¤„ç†ç¨‹åº</p>
<p>bug:<strong>ä»Šå¤©åœ¨å¤åˆ¶ç±»æ—¶ï¼Œå‡ºç°äº†ä¸€ä¸ªä»£ç ä¸€æ¨¡ä¸€æ ·ä½†æ˜¯pro.setRent(host)æŠ¥é”™çš„æƒ…å†µã€‚</strong></p>
<p><strong>åŸå› æ—¶ä»demo1å¤åˆ¶Hoståˆ°demo3ä¸­æ—¶ï¼Œdemo3ä¸­çš„Hostç±»å¼•å…¥äº†demo1åŒ…ä¸­çš„Rentæ¥å£</strong></p>
<p>ç±»ä¼¼ä¸€ä¸ªå·¥å…·ç±» â€“ä¸‡èƒ½çš„ ä»ä¸“æœ‰çš„æŠ½è±¡æ¥çš„</p>
<pre><code>//æˆ‘ä»¬ä¼šç”¨InvocationHandlerè¿™ä¸ªç±»ï¼Œè‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»
public class ProxyInvocationHandler implements InvocationHandler &#123;
    //è¢«ä»£ç†çš„æ¥å£
    private Object target;

    public void setTarget(Object target) &#123;
        this.target = target;
    &#125;

    //ç”Ÿæˆå¾—åˆ°ä»£ç†ç±»
    public Object getProxy() &#123;
        return Proxy.newProxyInstance(this.getClass().getClassLoader(), target.getClass().getInterfaces(), this);
    &#125;

    //å¤„ç†ä»£ç†å®ä¾‹ï¼Œå¹¶è¿”å›ç»“æœ
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;
        //åŠ¨æ€ä»£ç†çš„æœ¬è´¨ï¼Œå°±æ˜¯ä½¿ç”¨åå°„æœºåˆ¶å®ç°
        log(method.getName());
        Object result = method.invoke(target, args);
        return result;
    &#125;

    public void log(String msg) &#123;
        System.out.println(&quot;æ‰§è¡Œäº†&quot;+ msg +&quot;æ–¹æ³•&quot;);
    &#125;
&#125;
</code></pre>
<p>åŠ¨æ€ä»£ç†çš„å¥½å¤„ï¼š</p>
<ul>
<li>å¯ä»¥ä½¿çœŸå®è§’è‰²çš„æ“ä½œ<strong>æ›´åŠ çº¯ç²¹</strong>ã€‚ä¸ç”¨å»å…³æ³¨ä¸€äº›å…¬å…±çš„ä¸šåŠ¡</li>
<li>å…¬å…±ä¸šåŠ¡ä¹Ÿå°±äº¤ç»™äº†ä»£ç†è§’è‰²ï¼Œ<strong>å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥</strong></li>
<li>å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•çš„æ—¶å€™ï¼Œ<strong>æ–¹ä¾¿é›†ä¸­ç®¡ç†</strong>ã€‚</li>
<li>ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»ä»£ç†çš„æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸€èˆ¬å°±æ˜¯å¯¹åº”çš„ä¸€ç±»ä¸šåŠ¡</li>
<li>ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œåªè¦å®ç°äº†åŒä¸€ä¸ªæ¥å£</li>
</ul>
<h2 id="11-åå°„ä¸æ³¨è§£"><a href="#11-åå°„ä¸æ³¨è§£" class="headerlink" title="11.åå°„ä¸æ³¨è§£"></a>11.åå°„ä¸æ³¨è§£</h2><h3 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h3><p>åœ¨å…ƒæ³¨è§£çš„å­¦ä¹ ä¸­ï¼Œ@Target(value &#x3D; {ElementType.METHOD, ElementType.TYPE})</p>
<p>ä½¿ç”¨ç±»ä¼¼å®šä¹‰æ•°ç»„çš„æ–¹å¼å®šä¹‰äº†æ³¨è§£çš„ä½œç”¨åŸŸï¼Œæ—¢å¯ä»¥æ˜¯æ–¹æ³•ä¹Ÿå¯ä»¥æ˜¯ç±»ã€‚ç±»æ¯”ä¹‹å‰ç®—æ³•å­¦ä¹ ä¸­ï¼ŒçŠ¶æ€æœºä¸­å®šä¹‰mapå¹¶ä¸ºmapä¸­çš„é”®å¯¹åº”è®¾å®šå¤šä¸ªå€¼ã€‚ è¿™äº›éƒ½æ˜¯ç›¸åŒçš„ã€‚</p>
<h4 id="2-å…ƒæ³¨è§£"><a href="#2-å…ƒæ³¨è§£" class="headerlink" title="2.å…ƒæ³¨è§£"></a>2.å…ƒæ³¨è§£</h4><ol>
<li>@Target:æˆ‘ä»¬çš„æ³¨è§£å¯ä»¥ç”¨åœ¨å“ªäº›åœ°æ–¹</li>
<li>@Retention æˆ‘ä»¬çš„æ³¨è§£åœ¨ä»€ä¹ˆåœ°æ–¹è¿˜æœ‰æ•ˆ â€“runtime &gt; class &gt; sources</li>
<li>@Documentedæ˜¯å¦å°†æ³¨è§£ç”Ÿæˆåœ¨JavaDocä¸­</li>
<li>@Inherited å­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„æ³¨è§£</li>
</ol>
<h4 id="3-è‡ªå®šä¹‰æ³¨è§£"><a href="#3-è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="3.è‡ªå®šä¹‰æ³¨è§£"></a>3.è‡ªå®šä¹‰æ³¨è§£</h4><p>å®šä¹‰åï¼ˆå®šä¹‰è¦ç”¨() ) å¿…é¡»è¦åœ¨è°ƒç”¨æ³¨è§£çš„ä½ç½®èµ‹å€¼ï¼Œæˆ–è€…åœ¨è‡ªå®šä¹‰æ³¨è§£ä¸­èµ‹é»˜è®¤å€¼ã€‚ è‡ªå®šä¹‰æ³¨è§£çš„å®ç°ä¸åº”ç”¨è§<strong>AOP</strong> ä¸­çš„<a target="_blank" rel="noopener" href="https://gitee.com/Hs_Leo/notes/blob/develop/Spring.md#%E4%BD%BF%E7%94%A8Spring%E5%AE%9E%E7%8E%B0AOP">12.3</a></p>
<pre><code>public class Test03 &#123;
    //æ³¨è§£å¯ä»¥æ˜¾å¼èµ‹å€¼ï¼Œå¦‚æœæ²¡æœ‰é»˜è®¤å€¼å°±å¿…é¡»ç»™æ³¨è§£èµ‹å€¼
    @MyAnnotation2(age = 18)
    public void test() &#123;

    &#125;

&#125;
@Target(&#123;ElementType.TYPE, ElementType.METHOD&#125;)
@interface MyAnnotation2&#123;
    //æ³¨è§£çš„å‚æ•°ï¼šå‚æ•°ç±»å‹ + å‚æ•°åï¼ˆï¼‰;
    String name() default &quot;&quot;;
    int age() default 0;
    int id() default  -1;  //é»˜è®¤å€¼-1ï¼Œä»£è¡¨ä¸å­˜åœ¨
    String []scholls() default &#123;&quot;è¥¿åŒ—å¤§å­¦&quot;, &quot;è¥¿åŒ—å·¥ä¸šå¤§å­¦&quot;&#125;;

&#125;
</code></pre>
<h3 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h3><p>Reflectionæ˜¯Javaè¢«è§†ä¸ºåŠ¨æ€è¯­è¨€çš„å…³é”®ï¼Œåå°„æœºåˆ¶å…è®¸ç¨‹åºåœ¨æ‰§è¡ŒæœŸå€ŸåŠ©äºReflection APIå–å¾—ä»»ä½•ç±»çš„å†…éƒ¨ä¿¡æ¯ï¼Œå¹¶èƒ½ç›´æ¥æ“ä½œä»»æ„å¯¹è±¡çš„å†…éƒ¨å±æ€§åŠæ–¹æ³•</p>
<pre><code> // ä»£ç ç¤ºä¾‹ï¼š       
       //è·å–å­—èŠ‚ç å¯¹è±¡
        Class&lt;People&gt; clazz = (Class&lt;People&gt;) Class.forName(&quot;galaxy.earth&quot;);
        //è·å–ä¸€ä¸ªå¯¹è±¡
        Constructor con =  clazz.getConstructor();
        People people = (People) con.newInstance();
        //è·å–Methodå¯¹è±¡ getMethod()çš„å‚æ•°å°±æ˜¯æ–¹æ³•åå’Œæ–¹æ³•æ‰€éœ€çš„å‚æ•°
        Method method = clazz.getMethod(methodName, args);
        //è°ƒç”¨invokeæ–¹æ³•æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•
        method.invoke(Object, args);
</code></pre>
<p><img src="/" alt="image-20210128165629915"></p>
<p>Javaåå°„æœºåˆ¶æä¾›çš„åŠŸèƒ½ï¼š å®ç°åŠ¨æ€åˆ›å»ºå¯¹è±¡å’Œç¼–è¯‘ï¼Œçµæ´»ä½†æ˜¯ æ…¢ã€‚TODOï¼šæ…¢çš„åŸå› æ˜¯ä»€ä¹ˆ</p>
<ul>
<li>åœ¨<strong>è¿è¡Œæ—¶</strong>åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»</li>
<li>åœ¨è¿è¡Œæ—¶æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡</li>
<li>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•</li>
<li>åœ¨è¿è¡Œæ—¶è·å–æ³›å‹ä¿¡æ¯</li>
<li>åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•</li>
<li>åœ¨è¿è¡Œæ—¶å¤„ç†æ³¨è§£</li>
<li>ç”ŸæˆåŠ¨æ€ä»£ç†ï¼ˆè§ä¸Šæ–‡SpringåŠ¨æ€ä»£ç†ï¼‰</li>
<li>â€¦â€¦</li>
</ul>
<p>åŠ è½½å®Œç±»ä¹‹åï¼Œåœ¨å †å†…å­˜çš„æ–¹æ³•åŒºå°±äº§ç”Ÿäº†ä¸€ä¸ªClassç±»å‹çš„å¯¹è±¡ï¼ˆä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªClasså¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªClasså¯¹è±¡åŒ…å«äº†å®Œæ•´çš„ç±»çš„ç»“æ„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡çœ‹åˆ°ç±»çš„ç»“æ„ã€‚ â€”â€”è¿™æ˜¯åå°„å¾—ä»¥å®ç°çš„åŸºç¡€ã€‚</p>
<p><strong>ä¸€ä¸ªç±»åœ¨å†…å­˜ï¼Œåªæœ‰ä¸€ä¸ªClasså¯¹è±¡ã€‚</strong></p>
<p><strong>ä¸€ä¸ªç±»è¢«åŠ è½½åï¼Œç±»çš„æ•´ä¸ªç»“æ„éƒ½ä¼šè¢«å°è£…åœ¨Classå¯¹è±¡ä¸­ã€‚</strong></p>
<h4 id="2-è·å¾—Classç±»çš„å®ä¾‹"><a href="#2-è·å¾—Classç±»çš„å®ä¾‹" class="headerlink" title="2.è·å¾—Classç±»çš„å®ä¾‹"></a>2.è·å¾—Classç±»çš„å®ä¾‹</h4><p>Classç±»çš„åˆ›å»ºæ–¹å¼æœ‰å“ªäº›</p>
<pre><code>public class Test03 &#123;
    public static void main(String[] args) throws ClassNotFoundException &#123;
        Person person = new Student();
        System.out.println(&quot;è¿™ä¸ªäººæ˜¯&quot; + person.name);
        //æ–¹å¼ä¸€ï¼šé€šè¿‡å¯¹è±¡è·å¾—
        Class c1 = person.getClass();
        System.out.println(c1.hashCode());
        //fornameè·å¾—
        Class c2 = Class.forName(&quot;Reflect.Student&quot;);
        System.out.println(c2.hashCode());

        //æ–¹å¼3 é€šè¿‡ç±»å
        Class c3 = Teacher.class;
        System.out.println(c3.hashCode());

        //æ–¹å¼4ï¼šåŸºæœ¬å†…ç½®ç±»å‹çš„åŒ…è£…ç±»éƒ½æœ‰ä¸€ä¸ªTypeå±æ€§
        Class c4 = Integer.TYPE;
        System.out.println(c4);
        //è·å¾—çˆ¶ç±»ç±»å‹
        Class c5 = c1.getSuperclass();
        System.out.println(c5);
    &#125;

&#125;
</code></pre>
<p>æµ‹è¯•å¯¹è±¡</p>
<pre><code>class Person &#123;
    /*çœå»æ„é€ æ–¹æ³• toString set getç­‰*/
&#125;

class Student extends Person &#123;
    public Student() &#123;
        this.name = &quot;å­¦ç”Ÿ&quot;;
    &#125;
&#125;

class Teacher extends Person &#123;
    public Teacher() &#123;
        this.name = &quot;æ•™å¸ˆ&quot;;
    &#125;

&#125;
</code></pre>
<p>å“ªäº›ç±»å‹å¯ä»¥æœ‰Classå¯¹è±¡ï¼Ÿ</p>
<p>æ•°ç»„ï¼ˆä¸€ç»´äºŒç»´ä¸åŒï¼‰ ç±» æ¥å£ æ³¨è§£ æšä¸¾ åŸºæœ¬æ•°æ®ç±»å‹ Class void</p>
<p>åŒä¸€ç±»çš„å¯¹è±¡classå¯¹è±¡ç›¸åŒ</p>
<p>å†™åœ¨å‰é¢ï¼š</p>
<p>ç±»çš„åŠ è½½è¿‡ç¨‹ï¼š</p>
<p>ç±»çš„åŠ è½½ï¼š å°†ç±»çš„classæ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œå¹¶ä¸ºä¹‹åˆ›å»ºä¸€ä¸ªjava.lang.Classå¯¹è±¡ã€‚æ­¤è¿‡ç¨‹ç”±ç±»åŠ è½½å™¨å®Œæˆ</p>
<p> â†“</p>
<p>ç±»çš„é“¾æ¥ ï¼š å°†ç±»çš„äºŒè¿›åˆ¶æ•°æ®åˆå¹¶åˆ°JREä¸­</p>
<p> â†“</p>
<p>ç±»çš„åˆå§‹åŒ–ï¼š JVMè´Ÿè´£å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–</p>
<h4 id="3-ç±»çš„å¼•ç”¨"><a href="#3-ç±»çš„å¼•ç”¨" class="headerlink" title="3.ç±»çš„å¼•ç”¨"></a>3.ç±»çš„å¼•ç”¨</h4><p>ä¸»åŠ¨ï¼š 1.å½“è™šæ‹Ÿæœºå¯åŠ¨ï¼Œå…ˆåˆå§‹åŒ–mainæ–¹æ³•æ‰€åœ¨çš„ç±»</p>
<p> 2.newä¸€ä¸ªç±»çš„å¯¹è±¡</p>
<p> 3.è°ƒç”¨ç±»çš„é™æ€æˆå‘˜ï¼ˆé™¤äº†finalå¸¸é‡ï¼‰å’Œé™æ€æ–¹æ³•</p>
<p> 4.ä½¿ç”¨Java.lang.reflectåŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨</p>
<p>è¢«åŠ¨ï¼šæ•°ç»„å®šä¹‰ç±»å¼•ç”¨</p>
<p> è®¿é—®é™æ€åŸŸåªæœ‰çœŸæ­£å£°æ˜è¯¥åŸŸçš„ç±»æ‰ä¼šåˆå§‹åŒ–</p>
<p> å¼•ç”¨å¸¸é‡ä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–</p>
<h2 id="12-AOP"><a href="#12-AOP" class="headerlink" title="12. AOP"></a>12. AOP</h2><p>æ³¨æ„ è¦åœ¨applicationContext.xmlé…ç½®æ–‡ä»¶ä¸­å¢åŠ å…¶çº¦æŸ</p>
<h3 id="12-1what"><a href="#12-1what" class="headerlink" title="12.1what"></a>12.1what</h3><p>é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿ç”¨æœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚</p>
<p>å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è¡ç”ŸèŒƒå‹ã€‚</p>
<p>åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´<strong>çš„è€¦åˆåº¦é™ä½</strong>ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ã€‚</p>
<h3 id="12-2-åœ¨Springä¸­çš„ä½œç”¨"><a href="#12-2-åœ¨Springä¸­çš„ä½œç”¨" class="headerlink" title="12.2 åœ¨Springä¸­çš„ä½œç”¨"></a>12.2 åœ¨Springä¸­çš„ä½œç”¨</h3><p>æä¾›å£°æ˜å¼äº‹åŠ¡ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰åˆ‡é¢ã€‚</p>
<p>æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼šè·¨è¶Šåº”ç”¨ç¨‹åºå¤šä¸ªæ¨¡å—çš„æ–¹æ³•æˆ–åŠŸèƒ½ã€‚å³ä¸ä¸šåŠ¡é€»è¾‘æ— å…³ä½†ä»éœ€è¦å…³æ³¨çš„éƒ¨åˆ†ã€‚ï¼ˆæ—¥å¿—ï¼Œå®‰å…¨ï¼Œç¼“å­˜ï¼Œäº‹åŠ¡ç­‰ï¼‰</p>
<p>åˆ‡é¢ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹è¢« æ¨¡å—åŒ–çš„ ç‰¹æ®Šå¯¹è±¡ â€”â€” å…¶å®å°±æ˜¯å…¬å…±çš„ä¸€äº›é€»è¾‘</p>
<p>é€šçŸ¥ï¼šåˆ‡é¢å¿…é¡»è¦å®Œæˆçš„å·¥ä½œ</p>
<p>ç›®æ ‡ï¼šè¢«é€šçŸ¥å¯¹è±¡</p>
<p>ä»£ç†ï¼šå‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„å¯¹è±¡</p>
<p>åˆ‡å…¥ç‚¹ï¼šåˆ‡é¢é€šçŸ¥æ‰§è¡Œçš„â€œåœ°ç‚¹â€çš„å®šä¹‰</p>
<p>è¿æ¥ç‚¹ï¼šä¸åˆ‡å…¥ç‚¹åŒ¹é…çš„æ‰§è¡Œç‚¹</p>
<p>åç»­è¡¥å……ï¼šæ•´åˆèµ·æ¥è¯´ï¼Œå°±æ˜¯ä¸€äº›ä¸æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ— å…³ä½†åˆå¿…ä¸å¯å°‘çš„ï¼Œæ¯”å¦‚æ—¥å¿—ã€æƒé™ï¼ˆç™»å½•å®é™…ä¸Šåº”è¯¥å°±æ˜¯ä¸€ç§æƒé™ï¼‰ï¼Œéœ€è¦å°†ä»–ä»¬å…¨éƒ¨æŠ½å‡ºæ•´åˆé›†ä¸­ç®¡ç†ã€‚</p>
<p>è¿™æ ·å¯ä»¥è§£å†³ï¼šâ‘ æ•ˆç‡ â‘¡ç»´æŠ¤å…±æœ‰æ›´è½»æ¾ã€‚</p>
<p>ä¼ ç»Ÿçš„æ€è·¯ï¼Œæ¯”å¦‚è°ƒç”¨æŸä¸ªæ–¹æ³•å‰åéƒ½æ‰“å°ä¸€å¥è¯ï¼Œå°±åœ¨è¯¥æ–¹æ³•å‰ååŠ ä¸Šå»å°±è¡Œäº†ï¼Œå¦‚æœæ–¹æ³•å¤šäº†å°±ä¼šæœ‰å¾ˆå¤šé‡å¤çš„ä»£ç ã€‚</p>
<p>ä¸å¦‚å°†è¿™ç§æ‰“å°ä¸šåŠ¡å°è£…èµ·æ¥ï¼Œç„¶åä½¿å…¶èƒ½å¤Ÿåœ¨æŒ‡å®šçš„åœ°æ–¹<strong>è‡ªåŠ¨</strong>ï¼ˆè¿™å¾ˆé‡è¦ï¼‰è°ƒç”¨ï¼Œè¿™æ ·ä¸šåŠ¡ä»£ç å°±ä¼šæ›´çº¯ç²¹</p>
<p><img src="/" alt="image-20210130153158107"></p>
<h3 id="12-3-ä½¿ç”¨Springå®ç°AOP"><a href="#12-3-ä½¿ç”¨Springå®ç°AOP" class="headerlink" title="12.3 ä½¿ç”¨Springå®ç°AOP"></a>12.3 ä½¿ç”¨Springå®ç°AOP</h3><p>ã€é‡ç‚¹ã€‘ ä½¿ç”¨AOPï¼Œå¯¼åŒ…</p>
<pre><code>    &lt;dependency&gt;
        &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
        &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
        &lt;version&gt;1.9.4&lt;/version&gt;
    &lt;/dependency&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop
        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;
</code></pre>
<p>æ–¹å¼ä¸€ï¼š</p>
<p>ä½¿ç”¨Springçš„APIæ¥å£ ã€ä¸»è¦æ˜¯SpringAPIæ¥å£å®ç°ã€‘</p>
<p>execution(ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.ç±»å&#x2F;æ¥å£å.æ–¹æ³•å(å‚æ•°åˆ—è¡¨))æ³¨æ„è€å¸ˆå¿½ç•¥æ‰ä¿®é¥°ç¬¦äº† è‡ªå·±å¯ä»¥å†™ä¸Šä¿®é¥°ç¬¦è¯•è¯• (..)å¯ä»¥ä»£è¡¨æ‰€æœ‰å‚æ•°,(<em>)ä»£è¡¨ä¸€ä¸ªå‚æ•°,(</em>,String)ä»£è¡¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä»»ä½•å€¼,ç¬¬äºŒä¸ªå‚æ•°ä¸ºStringç±»å‹.</p>
<pre><code>&lt;!--    æ–¹å¼ä¸€ï¼šä½¿ç”¨åŸç”ŸSpring APIæ¥å£--&gt;
&lt;!--    é…ç½®aopï¼š éœ€è¦å¯¼å…¥aopçš„çº¦æŸ--&gt;
    &lt;aop:config&gt;
&lt;!--        åˆ‡å…¥ç‚¹ è¡¨è¾¾å¼ executionè¦æ‰§è¡Œçš„ä½ç½®  æ³¨æ„ç©ºæ ¼ç„¶å *  --&gt;
        &lt;aop:pointcut id=&quot;pointcut&quot; expression=&quot;execution(*com.fan.service.UserServiceImpl.*(..))&quot;/&gt;
&lt;!--   æ‰§è¡Œç¯ç»•å¢åŠ --&gt;
        &lt;aop:advisor advice-ref=&quot;log&quot; pointcut-ref=&quot;pointcut&quot;/&gt;
        &lt;aop:advisor advice-ref=&quot;AfterLog&quot; pointcut-ref=&quot;pointcut&quot;/&gt;
    &lt;/aop:config&gt;
</code></pre>
<p>æ–¹å¼äºŒï¼šè‡ªå®šä¹‰ç±»å®ç° [ä¸»è¦æ˜¯å®šä¹‰ç•Œé¢]</p>
<pre><code>&lt;!--    æ–¹å¼:è‡ªå®šä¹‰ç±»äºŒ--&gt;
    &lt;bean id=&quot;diy&quot; class=&quot;com.fan.diy.DiyPoint&quot;/&gt;
    &lt;aop:config&gt;
&lt;!--        è‡ªå®šä¹‰åˆ‡é¢ï¼Œrefè¦å¼•ç”¨çš„ç±»--&gt;
        &lt;aop:aspect ref=&quot;diy&quot;&gt;
&lt;!--           åˆ‡å…¥ç‚¹--&gt;
            &lt;aop:pointcut id=&quot;point&quot; expression=&quot;execution(* com.fan.service.UserServiceImpl.*(..))&quot;/&gt;
&lt;!--é€šçŸ¥--&gt;
            &lt;aop:before method=&quot;before&quot; pointcut-ref=&quot;point&quot;/&gt;
            &lt;aop:after method=&quot;after&quot; pointcut-ref=&quot;point&quot;/&gt;
        &lt;/aop:aspect&gt;
    &lt;/aop:config&gt;
</code></pre>
<p>æ–¹å¼ä¸‰ï¼š æ³¨è§£å®ç°</p>
<p>åœ¨åˆ‡é¢ç±»ä¸­æ·»åŠ æ³¨è§£æ”¯æŒ(@Aspect),é…ç½®æ–‡ä»¶ä¸­é…ç½®bean</p>
<p>åˆ‡é¢ç±»ä¸­</p>
<pre><code>@Before(&quot;execution(* com.fan.service.UserServiceImpl.*(..))&quot;)
public void before() &#123;
    System.out.println(&quot;æ–¹æ³•æ‰§è¡Œå‰&quot;);

&#125;

@After(&quot;execution(* com.fan.service.UserServiceImpl.*(..))&quot;)
public void after() &#123;
    System.out.println(&quot;====æ–¹æ³•æ‰§è¡Œå====&quot;);

&#125;
</code></pre>
<p>é…ç½®æ–‡ä»¶ä¸­</p>
<pre><code>&lt;!--    å¼€å¯æ³¨è§£æ”¯æŒ   JDKï¼ˆé»˜è®¤ï¼‰  cglib è®¾ç½®ä¸‹é¢é‚£ä¸ªä¸ºtrue--&gt;
&lt;!--    æ–¹å¼ä¸‰ æ³¨è§£--&gt;
    &lt;bean id=&quot;diyPoint&quot; class=&quot;com.fan.diy.DiyPoint&quot;/&gt;
    &lt;aop:aspectj-autoproxy/&gt;
</code></pre>
<p>æ€»ä¹‹ï¼Œ åœ¨ä¸å½±å“åŸæœ‰ä¸šåŠ¡çš„å‰æä¸‹ï¼Œå®ç°åŠ¨æ€å¢å¼ºã€‚</p>
<h4 id="æ³¨è§£çš„æ·±å…¥è®¤è¯†"><a href="#æ³¨è§£çš„æ·±å…¥è®¤è¯†" class="headerlink" title="æ³¨è§£çš„æ·±å…¥è®¤è¯†"></a>æ³¨è§£çš„æ·±å…¥è®¤è¯†</h4><p>æ³¨è§£ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œæœ¬èº«å¹¶ä¸å«æœ‰é€»è¾‘ã€‚ç³»ç»Ÿé‡Œçš„æ³¨è§£æœ‰ä¸¤ç§ï¼Œåˆ«äººå®ç°çš„ï¼Œè‡ªå·±å®ç°çš„ã€‚</p>
<p>åˆ«äººï¼ˆå®˜æ–¹ï¼‰å®ç°çš„ï¼Œæ¯”å¦‚Javaçš„<code>@Override</code>ï¼Œå®ç°è€…æ˜¯JVMã€‚æ ¹æ®éœ€è¦ï¼Œæˆ‘ä¹Ÿå¯ä»¥å»è‡ªå·±å®šä¹‰ä¸€ä¸ªæ³¨è§£ã€‚å®šä¹‰æ³¨è§£çš„åŒæ—¶è¦åœ¨æŸå¤„å®ç°ä¸€ä¸ªå¯¹åº”è¯¥æ³¨è§£çš„é€»è¾‘ã€‚è¯¥é€»è¾‘è¦æ˜¯<strong>ç‰¹å®š</strong>çš„ã€‚</p>
<p>æ¯”å¦‚ç³»ç»Ÿé‡Œä¸ºå®‰å…¨æ€§è€ƒè™‘ï¼Œæ“ä½œéƒ½è¦è¿›è¡Œtokenæ ¡éªŒï¼Œä½†æ˜¯æœ‰çš„æ“ä½œæ˜¯åœ¨tokenç”Ÿæˆä¹‹å‰çš„ï¼Œå¦‚æœæˆ‘ä»¬å»æ ¡éªŒå°±æ ¡éªŒä¸ªå¯‚å¯ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹æŸäº›æ–¹æ³•è®¾ç½®ä¸€ä¸‹ä¸è®©å…¶æ ¡éªŒtokenï¼ˆæ ¡éªŒtokenå½“ç„¶æ˜¯æ”¾åœ¨ä¸€ä¸ªå…¨å±€çš„æ‹¦æˆªå™¨ä¸­ï¼Œå»æ‹¦æˆªæ–¹æ³•ã€‚æ¯”å¦‚HandlerInterceptorï¼Œå®ƒçš„ä½¿ç”¨å’ŒSpringMVCä¸­çš„DispatcherServletæœ‰å…³ï¼Œï¼Œï¼Œï¼Œè¿™é‡Œå›çœ‹ä¸€ä¸‹ TODO)</p>
<p>è¿™æ—¶æˆ‘å»å®šä¹‰ä¸€ä¸ª<code>@IgnoreAuthe</code>ä½œä¸ºæ–¹æ³•ç±»å‹çš„æ³¨è§£ï¼Œç„¶ååœ¨è°ƒç”¨æ ¡éªŒtokençš„å…¨å±€æ‹¦æˆªå™¨é‡Œè®¾ç½®æœ‰è¯¥æ³¨è§£çš„å°±ä¸å»æ ¡éªŒã€‚</p>
<p>JDKä¸ºæˆ‘ä»¬æä¾›äº†å››ä¸ªå…ƒæ³¨è§£ï¼Œæ¥å®šä¹‰æ³¨è§£æ—¶ä½¿ç”¨ã€‚</p>
<p>æ³¨è§£çš„ä½¿ç”¨</p>
<p>æ¯”å¦‚è¯´æˆ‘ä»¬è¿™ä¸ª<code>@IgnoreAuthe</code>ï¼Œæ˜¯ä¸€ä¸ªä½¿ç”¨åœ¨æ–¹æ³•ä¸Šçš„æ³¨è§£ã€‚Javaä¸­çš„åå°„å‡ ä¹å¯ä»¥è¯´æ˜¯Springçš„åŸºçŸ³ï¼Œåå°„æœºåˆ¶å¯ä»¥ä½¿æˆ‘ä»¬é€šè¿‡Classå¯¹è±¡è·å–æ‰€æœ‰çš„ç±»ï¼Œè¿›è€Œè·å–å…¶æ–¹æ³•ï¼Œä»¥åŠå±æ€§ã€‚</p>
<p>é‚£ä¹ˆåå°„è‡ªç„¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å–æ–¹æ³•ä¸Šçš„æ³¨è§£ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code>HandlerMethod handlerMathod = (HandlerMethod)handler;
IgnoreAuthe methodAnnotation = handlerMethod.getMethodAnnotation(IgnoreAuthe.class);
// è¿™æ ·å°±æ‹¿åˆ°äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„è¿™ä¸ªæ³¨è§£ï¼Œç„¶åå¯ä»¥åšè¿›ä¸€æ­¥çš„æ“ä½œâ€”â€”å®ç°é’ˆå¯¹è¯¥æ³¨è§£çš„é€»è¾‘ã€‚
</code></pre>
<h4 id="è‡ªå®šä¹‰æ³¨è§£çš„åº”ç”¨"><a href="#è‡ªå®šä¹‰æ³¨è§£çš„åº”ç”¨" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£çš„åº”ç”¨"></a>è‡ªå®šä¹‰æ³¨è§£çš„åº”ç”¨</h4><p>æ˜¯å¯¹Spring åˆ‡é¢çš„ä¸€ç§å®è·µï¼Œä¸‹é¢ä»¥ç”Ÿæˆç”¨æˆ·æ—¥å¿—ä¸ºä¾‹ï¼Œç®€å•åœ°è¯´ï¼š</p>
<ul>
<li>å®šä¹‰ä¸€ä¸ªæ—¥å¿—å®ä½“ç±»ï¼Œä¸€ä¸ªåˆ‡é¢ï¼Œä¸€ä¸ªæ³¨è§£</li>
<li>å°†è¯¥æ³¨è§£å®šä¹‰åœ¨éœ€è¦è®°å½•æ—¥å¿—çš„æ–¹æ³•ä¸Š</li>
<li>æˆ‘ä»¬çš„åˆ‡é¢ä¼šæ ¹æ®è¯¥æ³¨è§£è¯†åˆ«</li>
</ul>
<p>è¿™é‡Œçœå»å®ä½“ç±»ï¼Œæ’å…¥é€»è¾‘ç­‰åªå±•ç°åˆ‡é¢å’Œè‡ªå®šä¹‰æ³¨è§£</p>
<p>@SystemCrmLog</p>
<pre><code>@Target(&#123;ElementType.METHOD, ElementType.PARAMETER&#125;)
@Retention(RetentionPolicy.RUNTIME)  
@Documented   // ç”Ÿæˆjavadocæ—¶ä¼šæºå¸¦@Apiçš„å†…å®¹
public @interface SystemCrmlog &#123;

    /**
     * æ—¥å¿—æè¿°ï¼Œè¿™ä¸ªç”±ä½¿ç”¨è€…è‡ªå·±å®šä¹‰
     */
    String description() default &quot;&quot;;

    /**
     * æ“ä½œäº†çš„è¡¨å
     */
    String tableName() default &quot;&quot;;
&#125;
</code></pre>
<p>æ³¨è§£æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œä¸€ä¸ªæ ‡è¯†ï¼Œå…¶å±æ€§è‚¯å®šè¦ä¸ºåé¢æœåŠ¡ï¼Œå¿…è¦çš„è¯å¯ä»¥æ˜¯ç©ºçš„ã€‚</p>
<p>å®ç°çš„åˆ‡é¢ï¼Œè¿™é‡Œç”¨åˆ°äº†JoinPointï¼ŒåŒæ—¶é—ç•™äº†ä¸€ä¸ªé—®é¢˜ï¼šå°†é‡Œé¢çš„æ–¹æ³•æ”¹é€ ä¸€ä¸‹æ˜¯å¦å¯ä»¥åˆ©ç”¨æ–¹æ³•ç­¾åå»é‰´åˆ«æ–¹æ³•çš„å”¯ä¸€æ€§å‘¢</p>
<p>SystemLogAspect.class</p>
<p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªç©ºçš„crmAspect()æ–¹æ³•ï¼Œåˆ©ç”¨@PointCutæ³¨è§£ä¸æˆ‘ä»¬è¦ç”¨çš„æ³¨è§£ç»‘å®šï¼ˆå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åšçš„å·¥ä½œå…¶å®è¯´åˆ°åº•éƒ½è¦æœ‰ä¸€ä¸ªç»‘å®šå…³ç³»æˆ–è€…è¯´æ˜¯ä¾èµ–ï¼‰ï¼Œæˆ‘ä»¬è‡ªå®šçš„Logæ³¨è§£æ ‡è®°åˆ‡ç‚¹ï¼Œå½“å»æ‰§è¡ŒLogæ³¨è§£æ ‡è¯†çš„æ–¹æ³•æ—¶ä¼šæ‰§è¡ŒcrmAspect()æ–¹æ³•ï¼Œå¦‚æœå¼‚å¸¸äº†ä¼šè§¦å‘afterThrowingMethodæ–¹æ³•å¦‚æœæ­£å¸¸æ‰§è¡Œå°±è§¦å‘doCrmLogï¼ˆï¼‰ã€‚å…¶ä½™çš„æ–¹æ³•æ˜¯ç”¨äºè·å–è¯·æ±‚ä¿¡æ¯ï¼Œæˆ–è€…åˆ©ç”¨åå°„è·å–å¯¹è±¡ä¿¡æ¯ã€‚</p>
<p>è¿™é‡Œè¢«@Afterxxxxæ ‡è¯†çš„æ‰€è°“æ–¹æ³•å°±æ˜¯é€šçŸ¥ã€‚</p>
<pre><code>@Aspect
@Component
public class SystemLogAspect &#123;

    private static final String EXEC_SUCCESS = &quot;æ‰§è¡ŒæˆåŠŸ&quot;;
    private static final String EXEC_FAIL = &quot;æ‰§è¡Œå¤±è´¥&quot;;
    private static final String METHOD_CONTEXT = &quot;context&quot;;
    private static final String METHOD_OPER_TABLE = &quot;tableName&quot;;

    @Autowired
    private SystemLogDao systemLogDao;

    /**
     * æ³¨è§£PointCutåˆ‡å…¥ç‚¹ï¼Œå®šä¹‰å‡ºä¸€ä¸ªæˆ–ä¸€ç»„æ–¹æ³•ï¼Œå½“æ‰§è¡Œè¿™äº›æ–¹æ³•æ—¶å¯äº§ç”Ÿé€šçŸ¥ã€‚
     * è¿™é‡Œè‡ªå®šä¹‰æ³¨è§£ä½œä¸ºåˆ‡ç‚¹æ ‡è¯†
     */
    @Pointcut(&quot;@annotation(com.fan.definiteannotationdemo.anno.SystemCrmlog)&quot;)
    public void crmAspect() &#123;
    &#125;

    /**
     * æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ï¼Œæ–¹æ³•æŠ›å‡ºå¼‚å¸¸é€€å‡ºæ—¶æ‰§è¡Œçš„é€šçŸ¥
     * è¿™é‡ŒJointPointå…¶å®ç°ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼ŒProceedingJoinPointåªæ”¯æŒç¯ç»•å¢å¼º
     */
    @AfterThrowing(value = &quot;crmAspect()&quot;, throwing = &quot;ex&quot;)
    public void afterThrowingMethod(JoinPoint joinPoint, Exception ex) throws Exception &#123;
        // è·å–ç”¨æˆ·ä¿¡æ¯
        CrmlogMessage log = getLogMessage(joinPoint);
        log.setResult(EXEC_FAIL);
        log.setExString(ex.getMessage());
        systemLogDao.addSysLog(log);
    &#125;

    /**
     * è¿”å›åé€šçŸ¥ åœ¨æŸè¿æ¥ç‚¹æ­£å¸¸å®Œæˆåæ‰§è¡Œçš„é€šçŸ¥ã€‚æ³¨è§£çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å‘éœ€è¦æ§åˆ¶çš„æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å‘è¿”å›å€¼
     * @param joinPoint
     * @param returnValue è¿”å›å€¼
     */
    @AfterReturning(value = &quot;crmAspect()&quot;, returning = &quot;returnValue&quot;)
    public void doCrmLog(JoinPoint joinPoint, Object returnValue) throws Exception &#123;
        CrmlogMessage log = getLogMessage(joinPoint);
        if (returnValue != null) &#123;
            // TODO HsLI è¿™é‡Œæ˜¾ç„¶è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹
            if (returnValue instanceof List) &#123;
                List list = (List) returnValue;
                log.setResult(CollectionUtils.isEmpty(list) ? EXEC_FAIL : EXEC_SUCCESS);
            &#125; else if (returnValue instanceof Boolean) &#123;
                Boolean flag = (Boolean) returnValue;
                log.setResult(flag ? EXEC_SUCCESS : EXEC_FAIL);
            &#125; else if (returnValue instanceof Integer) &#123;
                Integer result = (Integer) returnValue;
                log.setResult(result &gt; 0 ? EXEC_SUCCESS : EXEC_FAIL);
            &#125; else &#123;
                log.setResult(EXEC_SUCCESS);
            &#125;
        &#125;
        systemLogDao.addSysLog(log);

    &#125;

    private String getServiceMethodParams(JoinPoint joinPoint) throws JsonProcessingException &#123;
        Object[] args = joinPoint.getArgs();
        ObjectMapper om = new ObjectMapper();
        return om.writeValueAsString(args);
    &#125;

    /**
     * è¿”å›æ³¨è§£ä¸­çš„æ—¥å¿—ä¿¡æ¯
     */
    private String getServiceMethodInformation(JoinPoint joinPoint, String value) throws Exception &#123;
        String targetName = joinPoint.getTarget().getClass().getName();
        String methodName = joinPoint.getSignature().getName();
        Object[] arguments = joinPoint.getArgs();
        // é€šè¿‡åå°„è·å–ç¤ºä¾‹å¯¹è±¡
        Class targetClass = Class.forName(targetName);
        // é€šè¿‡å®ä¾‹å¯¹è±¡è·å–æ–¹æ³•æ•°ç»„
        Method[] methods = targetClass.getMethods();
        String res = &quot;&quot;;
        for (Method method : methods) &#123;
            // åˆ¤æ–­æ–¹æ³•åæ˜¯ä¸æ˜¯ç›¸åŒ
            if (method.getName().equals(methodName)) &#123;
                // TODO HsLi è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šå°±æ˜¯é€šè¿‡æ¯”è¾ƒæ–¹æ³•åå’Œå‚æ•°é•¿åº¦å°±ç¡®å®šæ˜¯å”¯ä¸€çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™æ ·å¹¶ä¸æ˜¯å¤ªå¥½å¦‚ä½•æ”¹è¿›å‘¢ï¼Ÿ
                Class[] clazzs = method.getParameterTypes();
                if (clazzs.length == arguments.length) &#123;
                    // è·å–æ³¨è§£ä¸­çš„æ—¥å¿—ä¿¡æ¯ï¼Œå…ˆå»è·å–æ³¨è§£å†å»è°ƒç”¨å…¶å±æ€§
                    if (value.equals(METHOD_CONTEXT)) &#123;
                        res = method.getAnnotation(SystemCrmlog.class).description();
                    &#125; else if (value.equals(METHOD_OPER_TABLE)) &#123;
                        res = method.getAnnotation(SystemCrmlog.class).tableName();
                    &#125;
                    break;
                &#125;
            &#125;
        &#125;
        return res;

    &#125;

    private CrmlogMessage getLogMessage(JoinPoint joinPoint) throws Exception &#123;
        Map&lt;String, Object&gt; user = WebUtil.getUser();
        CrmlogMessage log = new CrmlogMessage();
        // è·å–æ‰€éœ€è¦çš„ä¿¡æ¯
        String context = getServiceMethodInformation(joinPoint, METHOD_CONTEXT);
        String userName = &quot;&quot;;
        String roleName = &quot;&quot;;
        if (user != null) &#123;
            userName = user.get(&quot;userName&quot;).toString();
            roleName = user.get(&quot;roleName&quot;).toString();
        &#125;
        log.setLogId(IdUtil.simpleUUID());
        log.setUserName(userName);
        log.setUserRole(roleName);
        log.setContent(userName+context);
        log.setRemarks(getServiceMethodParams(joinPoint));
        log.setTableName(getServiceMethodInformation(joinPoint, METHOD_OPER_TABLE));
        log.setOperTime(DateUtil.date().toTimestamp());
        log.setIp(WebUtil.getRequest().getRemoteAddr());
        log.setRequestUrl(WebUtil.getRequest().getRequestURI());
        return log;

    &#125;

&#125;
</code></pre>
<h3 id="Advisor-é¡¾é—®"><a href="#Advisor-é¡¾é—®" class="headerlink" title="Advisor(é¡¾é—®)"></a>Advisor(é¡¾é—®)</h3><p>Advisoråˆæ˜¯Adviceä¸JoinPointçš„ç»“åˆ</p>
<p>å‰ç½®æ¦‚å¿µ:</p>
<p>åˆ‡é¢ï¼šäº¤å‰ä¸šåŠ¡é€»è¾‘ï¼ˆæ¯”å¦‚æ—¥å¿—å¤„ç†ï¼Œæƒé™æ§åˆ¶ï¼Œäº‹åŠ¡å¤„ç†ï¼‰ï¼Œå®é™…ä¸Šæ˜¯å¯¹ä¸»ä¸šåŠ¡é€»è¾‘çš„ä¸€ç§å¢å¼ºã€‚</p>
<p>åŸåˆ™ä¸Šåˆ‡é¢å¯ä»¥å¯¹æ‰€æœ‰éfinalçš„æ–¹æ³•è¿›è¡Œâ€œä¿®æ”¹â€,ä½†æ˜¯åˆä¸å½±å“å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<p>é€šçŸ¥æ˜¯å°†æˆ‘ä»¬å®šä¹‰çš„åˆ‡é¢ä¸­çš„æ–¹æ³•ç»‡å…¥(invoke)åˆ°æŒ‡å®šç±»çš„æ‰€æœ‰æ–¹æ³•ä¸­ã€‚</p>
<p>é¡¾é—®ï¼šæ˜¯åˆ‡é¢çš„å¦ä¸€ç§å®ç°ï¼Œèƒ½å¤Ÿå°†é€šçŸ¥ä»¥æ›´ä¸ºå¤æ‚çš„æ–¹å¼ç»‡å…¥åˆ°ç›®æ ‡å¯¹è±¡ä¸­ï¼Œæ˜¯å°†é€šçŸ¥åŒ…è£…ä¸ºæ›´å¤æ‚åˆ‡é¢çš„è£…é…å™¨ã€‚</p>
<p>ç®€å•åœ°è¯´å°±æ˜¯ï¼Œ<strong>æ›´å…·ä½“</strong>ã€‚</p>
<p>ç›®å‰æˆ‘ä»¬é¢å‘åˆ‡é¢ç¼–ç¨‹çš„ç²’åº¦å°±æ˜¯æ–¹æ³•ï¼Œé€šçŸ¥ä»…èƒ½æ§åˆ¶ç›¸å¯¹æ–¹æ³•æ‰§è¡Œçš„æ—¶åˆ»æ¥ç»‡å…¥é€»è¾‘ï¼Œ</p>
<hr>
<p>é€šè¿‡åˆ‡ç‚¹æ¥å®ç°å¯¹å“ªäº›æ–¹æ³•è¿›è¡Œé€šçŸ¥é€‚é…ã€‚</p>
<p>PointCutæ¥å£æ˜¯åˆ‡ç‚¹çš„å®ç°æ–¹å¼ã€‚</p>
<p>æŒ‡å®šåˆ‡é¢åˆ‡å…¥çš„åˆ‡å…¥ç‚¹ï¼Œè¦é€šè¿‡PointCutæ¥å£å®ç°ï¼Œè¯¥æ¥å£ä¸€å…±æœ‰å…«ç§å®ç°ã€‚æ¯ç§å®ç°é—´çš„åŒºåˆ«å…¶å®å°±æ˜¯åˆ‡å…¥çš„æ¡ä»¶ä¸åŒã€‚å¦‚NameMatchMethodPointCutå’Œä¸‹é¢çš„AnnotationMatchingPointcutã€‚</p>
<p>ä¸‹é¢é’ˆå¯¹åœ¨å…¬å¸é‡åˆ°çš„AnnotationMatchingPointcutè¿›è¡Œè§£é‡Šã€‚</p>
<pre><code>AnnotationMatchingPointcut  æŸ¥æ‰¾è‡ªå®šä¹‰çš„æ³¨è§£ï¼ŒåŒ¹é…ä¸Šåè¿›è¡Œç‰¹å®šçš„é€šçŸ¥ã€‚
</code></pre>
<p>å¦‚æœæ–¹æ³•ä¸­æœ‰æŸä¸ªæ³¨è§£ï¼Œå°±å»ç”Ÿæˆä¸€ä¸ªadvisorå¯¹è±¡ï¼Œè¯¥advisorå¸¦ç€ä¸€ä¸ªåˆ‡é¢ï¼Œç„¶ååœ¨æ‰§è¡Œè¯¥æ³¨è§£æ‰€åœ¨çš„æ–¹æ³•æ—¶å»è°ƒç”¨è¿™ä¸ªåˆ‡é¢ã€‚</p>
<pre><code>public Advisor loginAdvisor() &#123;
        return buildAdvisor(new LoginInterceptor(), new AnnotationMatchingPointcut(null(Classçº§åˆ«æ³¨è§£ï¼‰, HandleLogin.class));
&#125;
                            
                            
                            
private Advisor buildAdvisor(Advice advice, Pointcut pointcut) &#123;
        DefaultPointcutAdvisor advisor = new DefaultPointcutAdvisor();
        advisor.setAdvice(advice);
        advisor.setPointcut(pointcut);
        return advisor;
  &#125;
</code></pre>
<h2 id="13-æ•´åˆMybatis"><a href="#13-æ•´åˆMybatis" class="headerlink" title="13. æ•´åˆMybatis"></a>13. æ•´åˆMybatis</h2><p>å¯¼åŒ…</p>
<ol>
<li><ul>
<li>junit</li>
<li>mybatis</li>
<li>mysqlæ•°æ®åº“</li>
<li>springç›¸å…³çš„</li>
<li>aopç»‡å…¥</li>
<li><strong>mybatis-spring</strong></li>
</ul>
</li>
</ol>
<pre><code>&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;5.1.47&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
            &lt;version&gt;3.5.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
            &lt;version&gt;5.1.9.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
&lt;!--        Springæ“ä½œæ•°æ®åº“ï¼Œéœ€è¦Spring-jdbc --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
            &lt;version&gt;5.1.9.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
            &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
            &lt;version&gt;1.8.13&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
            &lt;version&gt;2.0.2&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre>
<h3 id="12-1-å›å¿†mybatis"><a href="#12-1-å›å¿†mybatis" class="headerlink" title="12.1 å›å¿†mybatis"></a>12.1 å›å¿†mybatis</h3><ol>
<li>å®ä½“ç±»</li>
<li>æ ¸å¿ƒé…ç½®æ–‡ä»¶</li>
<li>æ¥å£</li>
<li>mapper.xml</li>
<li>æµ‹è¯•</li>
</ol>
<h3 id="12-2Mybatis-Spring"><a href="#12-2Mybatis-Spring" class="headerlink" title="12.2Mybatis-Spring"></a>12.2Mybatis-Spring</h3><p>1.ç¼–å†™æ•°æ®æºé…ç½®</p>
<p>2.sqlSessionFactory</p>
<p>3.sqlSessionTemplate</p>
<p>4.éœ€è¦ç»™æ¥å£åŠ å®ç°ç±»</p>
<p>5.å°†è‡ªå·±å†™çš„å®ç°ç±»ï¼Œæ³¨å…¥åˆ°Springä¸­</p>
<p>6.æµ‹è¯•</p>
<h4 id="æ–¹å¼ä¸€"><a href="#æ–¹å¼ä¸€" class="headerlink" title="æ–¹å¼ä¸€"></a>æ–¹å¼ä¸€</h4><p>æ­¤æ—¶åŸæœ‰çš„mybatis-configé…ç½®æ–‡ä»¶ä¸­ï¼Œå‡ ä¹å¯ä»¥ä¸å­˜åœ¨ã€‚</p>
<p>è€Œå°†é…ç½®å†…å®¹é…ç½®åœ¨spring-daoä¸­,å¦‚ä¸‹ï¼š</p>
<pre><code>&lt;!--    Datasourceï¼šä½¿ç”¨Springçš„æ•°æ®æºæ›¿æ¢mybtaisçš„é…ç½®æ­¤å¤„ä½¿ç”¨Springæä¾›çš„JDBC--&gt;
    &lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;
        &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
        &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&quot;/&gt;
        &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
        &lt;property name=&quot;password&quot; value=&quot;woaini123&quot;/&gt;
    &lt;/bean&gt;
&lt;!--    sqlSessionFactory--&gt;
    &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;
        &lt;!--        ç»‘å®šmybatisé…ç½®æ–‡ä»¶--&gt;
        &lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis-config.xml&quot;/&gt;
        &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath:com/fan/mapper/*.xml&quot;/&gt;
    &lt;/bean&gt;

&lt;!--sqlSessionTemplate å³è¦ä½¿ç”¨çš„SqlSession--&gt;
    &lt;bean id=&quot;sqlSession&quot; class=&quot;org.mybatis.spring.SqlSessionTemplate&quot;&gt;
        &lt;!--        ç”±SQLSessionTemplateçš„æºç ï¼šåªèƒ½ä½¿ç”¨æ„é€ å™¨æ³¨å…¥sqlSessionFactory å› ä¸ºå…¶æ²¡æœ‰setæ–¹æ³•--&gt;
        &lt;constructor-arg index=&quot;0&quot; ref=&quot;sqlSessionFactory&quot;/&gt;
    &lt;/bean&gt;

&lt;!--mapperæ˜ å°„ ä»¥æ³¨å†Œbeançš„æ–¹å¼æ³¨å†Œmapper--&gt;
&lt;bean id=&quot;userMapper&quot; class=&quot;com.fan.mapper.UserMapperImpl&quot;&gt;
        &lt;property name=&quot;sqlSeesion&quot; ref=&quot;sqlSession&quot;/&gt;
        &lt;/bean&gt;
</code></pre>
<p>å®ç°ç±»</p>
<pre><code>/*
æ‰€æœ‰æ“ä½œéƒ½ä½¿ç”¨SQL Sessionæ‰§è¡Œ --ä¹‹å‰
ç°åœ¨ ä½¿ç”¨SqlSessionTemplate
 */
private SqlSessionTemplate sqlSession;
public void setSqlSession(SqlSessionTemplate sqlSession) &#123;
    this.sqlSession = sqlSession;
&#125;

public List&lt;User&gt; selectUser() &#123;
    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
    return userMapper.selectUser();
&#125;
</code></pre>
<p>æµ‹è¯•ç±»ä¹Ÿå› æ­¤å¯ä»¥ç²¾ç®€ï¼Œä¾æ—§æ˜¯æŒ‰ç…§Springçš„è§„çŸ©ä»contextä¸­è·å–</p>
<pre><code>public void test() &#123;
    ApplicationContext context = new ClassPathXmlApplicationContext(&quot;spring-dao.xml&quot;);
    UserMapper userMapper = context.getBean(&quot;userMapper&quot;, UserMapper.class);
    for (User user:userMapper.selectUser()) &#123;
        System.out.println(user);
    &#125;

&#125;
</code></pre>
<p>å»ºè®®å¦å¤–å»ºç«‹applicationContext.xmlé…ç½®æ–‡ä»¶ï¼Œä»¥æ³¨å†Œbean,è€Œåœ¨spring-daoä¸­é…ç½®ä¸sqlï¼ˆmybatis)ç›¸å…³çš„å†…å®¹</p>
<h4 id="æ–¹å¼äºŒ"><a href="#æ–¹å¼äºŒ" class="headerlink" title="æ–¹å¼äºŒ"></a>æ–¹å¼äºŒ</h4><p>applicationContext.xml ä½¿ç”¨ä¸Šè¿°Spring-daoçš„é…ç½®ä¿¡æ¯</p>
<pre><code> &lt;import resource=&quot;spring-dao.xml&quot;/&gt;
&lt;bean id=&quot;userMapper2&quot; class=&quot;com.fan.mapper.UserMapperImpl2&quot;&gt;
    &lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot;/&gt;
&lt;/bean&gt;
public class UserMapperImpl2 extends SqlSessionDaoSupport implements UserMapper &#123;
    public List&lt;User&gt; selectUser() &#123;
        return getSqlSession().getMapper(UserMapper.class).selectUser();
    &#125;
&#125;
</code></pre>
<h2 id="14-å£°æ˜å¼äº‹åŠ¡"><a href="#14-å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="14. å£°æ˜å¼äº‹åŠ¡"></a>14. å£°æ˜å¼äº‹åŠ¡</h2><h3 id="1-å›é¡¾äº‹åŠ¡"><a href="#1-å›é¡¾äº‹åŠ¡" class="headerlink" title="1.å›é¡¾äº‹åŠ¡"></a>1.å›é¡¾äº‹åŠ¡</h3><p>è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥</p>
<hr>
<p>1.SQLæ‰§è¡Œ Aç»™Bè½¬è´¦ A â€”&gt;</p>
<ol>
<li>SQLæ‰§è¡Œ Bæ”¶åˆ°Açš„é’±</li>
</ol>
<hr>
<p><strong>å°†ä¸€ç»„SQLæ”¾åœ¨ä¸€ä¸ªæ‰¹æ¬¡ä¸­æ‰§è¡Œ</strong></p>
<p>äº‹åŠ¡åŸåˆ™ï¼šACID</p>
<p>åŸå­æ€§ï¼šè¦ä¹ˆéƒ½æˆåŠŸè¦ä¹ˆéƒ½å¤±è´¥</p>
<p>ä¸€è‡´æ€§ï¼šäº‹åŠ¡å‰åçš„æ•°æ®å®Œæ•´æ€§è¦ä¿æŒä¸€ç›´</p>
<p>éš”ç¦»æ€§ï¼šå¹¶å‘æ‰§è¡Œçš„äº‹åŠ¡ä¸èƒ½ç›¸äº’å¹²æ‰°</p>
<p>æŒä¹…æ€§ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤åˆ™ä¸å¯é€†ï¼Œè¢«æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­</p>
<p>éš”ç¦»å¯¼è‡´çš„é—®é¢˜ï¼š</p>
<p>è„è¯»</p>
<p>é‡å¤è¯»</p>
<p>è™šè¯»</p>
<h3 id="2-Springä¸­çš„äº‹åŠ¡ç®¡ç†"><a href="#2-Springä¸­çš„äº‹åŠ¡ç®¡ç†" class="headerlink" title="2. Springä¸­çš„äº‹åŠ¡ç®¡ç†"></a>2. Springä¸­çš„äº‹åŠ¡ç®¡ç†</h3><ul>
<li>å£°æ˜å¼äº‹åŠ¡ï¼šAOP</li>
<li>ç¼–ç¨‹å¼äº‹åŠ¡ï¼šéœ€è¦åœ¨ç¼–ç ä¸­ï¼Œè¿›è¡Œäº‹åŠ¡çš„ç®¡ç†</li>
</ul>
<pre><code>&lt;!--    é…ç½®å£°æ˜å¼äº‹åŠ¡--&gt;
    &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;
    &lt;/bean&gt;&gt;
    &lt;!--    ç»“åˆAOPå®ç°äº‹åŠ¡çš„ç»‡å…¥--&gt;
&lt;!--    é…ç½®äº‹åŠ¡çš„é€šçŸ¥:--&gt;
    &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;
&lt;!--        ç»™å“ªäº›æ–¹æ³•é…ç½®äº‹åŠ¡--&gt;
        &lt;!--        é…ç½®äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§:new--&gt;
        &lt;tx:attributes&gt;
            &lt;tx:method name=&quot;add&quot; propagation=&quot;REQUIRED&quot;/&gt;
            &lt;tx:method name=&quot;delete&quot; propagation=&quot;REQUIRED&quot;/&gt;
            &lt;tx:method name=&quot;update&quot; propagation=&quot;REQUIRED&quot;/&gt;
            &lt;tx:method name=&quot;query&quot; read-only=&quot;true&quot;/&gt;
            &lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot;/&gt;
        &lt;/tx:attributes&gt;
    &lt;/tx:advice&gt;
</code></pre>
<p>ä¿è¯ç¬¬ä¸€ä¸ªæ–¹æ³•ä¸­çš„æ‰€æœ‰æ“ä½œä¸€èµ·æ‰§è¡Œæˆ–ä¸æ‰§è¡Œ</p>
<pre><code>public class UserMapperImpl extends SqlSessionDaoSupport implements UserMapper &#123;
    public List&lt;User&gt; selectUser() &#123;
        User user = new User(6, &quot;å°ç‹å…«&quot;, &quot;123123&quot;);
        UserMapper mapper = getSqlSession().getMapper(UserMapper.class);
        mapper.addUser(user);
        mapper.deleteUser(4);
        return mapper.selectUser();
    &#125;

    public int addUser(User user) &#123;
        return getSqlSession().getMapper(UserMapper.class).addUser(user);
    &#125;

    public int deleteUser(int id) &#123;
        return getSqlSession().getMapper(UserMapper.class).deleteUser(id);
    &#125;
&#125;
</code></pre>
<p>æ€è€ƒï¼š</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡ï¼Ÿ</p>
<ul>
<li>è‹¥ä¸é…ç½®äº‹åŠ¡ï¼Œä¼šå­˜åœ¨æ•°æ®æäº¤ä¸ä¸€è‡´çš„æƒ…å†µ</li>
<li>ä¸åœ¨Springä¸­é…ç½®å£°æ˜å¼äº‹åŠ¡ï¼Œå°±éœ€è¦åœ¨ä»£ç ä¸­æ‰‹åŠ¨é…ç½®äº‹åŠ¡</li>
<li>äº‹åŠ¡åœ¨é¡¹ç›®çš„å¼€å‘ä¸­ååˆ†é‡è¦ï¼Œæ¶‰åŠåˆ°æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§é—®é¢˜ï¼Œè¦å°å¿ƒã€è°¨æ…ï¼ï¼ï¼</li>
</ul>
<h2 id="15-è¡¥å……"><a href="#15-è¡¥å……" class="headerlink" title="15.è¡¥å……"></a>15.è¡¥å……</h2><h4 id="SpringElè¡¨è¾¾å¼"><a href="#SpringElè¡¨è¾¾å¼" class="headerlink" title="SpringElè¡¨è¾¾å¼"></a>SpringElè¡¨è¾¾å¼</h4><p>ä½œç”¨ï¼šæ›´æ–¹ä¾¿çš„è·å–Springå®¹å™¨ä¸­çš„bean</p>
<hr>
<h1 id="è¿›é˜¶ç¯‡"><a href="#è¿›é˜¶ç¯‡" class="headerlink" title="è¿›é˜¶ç¯‡"></a>è¿›é˜¶ç¯‡</h1><h4 id="å›é¡¾ï¼š"><a href="#å›é¡¾ï¼š" class="headerlink" title="å›é¡¾ï¼š"></a>å›é¡¾ï¼š</h4><p>é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯Springæœ‰æ—¶å€™å…¶å®æ˜¯æŒ‡ä¸€ä¸ªå®¹å™¨ã€‚</p>
<p>org.springframework.context.ApplicationContextæ¥å£è¡¨ç¤ºSpring IoCå®¹å™¨ï¼Œ<strong>è´Ÿè´£å®ä¾‹åŒ–ï¼Œé…ç½®å’Œç»„è£…bean</strong>ã€‚</p>
<p>æ‰€è°“IoC(Invert of Controll)å°±æ˜¯å°†å¯¹è±¡çš„ç®¡ç†ç§»äº¤ç»™äº†ç¬¬ä¸‰æ–¹ï¼Œå³Springå®¹å™¨ã€‚è€Œä¸å†ç”±ç¨‹åºå‘˜è‡ªå·±å»ç”Ÿæˆå®šä¹‰ã€‚</p>
<p>å°½ç®¡Springæ‰˜ç®¡äº†å¤§å¤šæ•°çš„å¯¹è±¡ï¼Œä½†å¹¶ä¸æ˜¯ç³»ç»Ÿé‡Œçš„æ‰€æœ‰å¯¹è±¡éƒ½ç”±å…¶ç®¡ç†ï¼Œå¦‚æœæˆ‘ä»¬ä¸åŠ <code>@Component</code>è€Œåˆæƒ³è®©ä¸€äº›beanè¢«Springæ‰˜ç®¡è§ä¸‹æ–‡ä¸­çš„AutowireCapableBeanFactory.</p>
<h4 id="1-Springå¯¹Beançš„ç®¡ç†ï¼š"><a href="#1-Springå¯¹Beançš„ç®¡ç†ï¼š" class="headerlink" title="1.Springå¯¹Beançš„ç®¡ç†ï¼š"></a>1.Springå¯¹Beançš„ç®¡ç†ï¼š</h4><p><img src="/" alt="miniç‰ˆæœ¬Spring IOC"></p>
<p>ä¸€ä¸ªä¸ªå¯¹è±¡éƒ½è¢«è§†ä½œbeanï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆè¯¥å¯¹è±¡ï¼ˆå•ä¸ªæˆ–å¤šä¸ªï¼‰çš„â€é…æ–¹â€œã€‚</p>
<p>Springé€šè¿‡åå°„å»ç”Ÿæˆbean,ç”Ÿæˆä»¥åè¦å­˜å‚¨åœ¨å®¹å™¨ä¸­ã€‚é‚£ä¹ˆSpringæ˜¯æ ¹æ®ä»€ä¹ˆå»äº§ç”ŸBeandçš„å‘¢ï¼Ÿ</p>
<p>ï¼ˆè¿™é‡Œæ’å…¥ä¸€ä¸‹ï¼šæ‡’åŠ è½½çš„é—®é¢˜ï¼Œå…¶å®å°±æ˜¯åœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™ä¸å»åŠ è½½Beanï¼Œè€Œæ˜¯åœ¨æˆ‘ä»¬çœŸæ­£è·å–ä»–ä»¬æ—¶æ‰åŠ è½½ã€‚<code>@Lazy</code>ã€<code>@Indexed</code>ï¼‰</p>
<pre><code>@Bean
</code></pre>
<p>è¯¥æ³¨è§£åº”ç”¨åœ¨æ–¹æ³•ä¸Šï¼Œæ‰€å¤„çš„ç±»å¿…é¡»è¦æœ‰<code>@Configuration</code>æ³¨è§£ã€‚</p>
<p>ä½œç”¨: ä¸»åŠ¨å»ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ä½œä¸ºBeanæ‰˜ç®¡ç»™Springå®¹å™¨ã€‚å…¶å®å°±æ˜¯åŸå§‹XMLä¸­é…ç½®è¿™ç§æ“ä½œçš„æ›¿ä»£ã€‚</p>
<p>æ¯”å¦‚ç”¨æ¥é€šä¿¡çš„RestTemplateï¼Œæˆ–è€…ç¼“å­˜ç®¡ç†ã€æ•°æ®æºã€MongoClient</p>
<pre><code>@Bean
@Scope(&quot;prototype&quot;)   
/*è¿™é‡Œå¯ä»¥æŒ‡å®šèŒƒå›´ï¼Œå¦‚æœä¸æŒ‡å®šé»˜è®¤å°±æ˜¯å•ä¾‹ï¼Œåœ¨æˆ‘ä»¬çš„ç³»ç»Ÿé‡Œå¾€å¾€ä¸€äº›ä¸œè¥¿å¿…é¡»æ˜¯å•ä¾‹çš„ï¼Œå½“ç„¶ä¹Ÿä¸æ˜¯è¯´æ­»çš„ï¼Œæ¯”å¦‚é’‰é’‰æ‰«ç å’Œå•ç‚¹ç™»å½•éƒ½è¦å€ŸåŠ©äºå…¶SDKä¸­çš„ExecuableClientï¼Œä½†æ˜¯ä¸¤ä¸ªä¸šåŠ¡å¸¦ç€çš„å¯†é’¥åˆä¸ç›¸åŒå› æ­¤å¦‚æœç³»ç»Ÿé‡ŒåŒæ—¶æœ‰ä¸¤ç§åŠŸèƒ½é‚£å¦‚æœè¿˜ç”¨å•ä¾‹å°±å¿…ç„¶å¯¼è‡´æœ‰ä¸€ä¸ªåŠŸèƒ½æ— æ³•ä½¿ç”¨*/
public RestTemplate restTemplate()&#123;
        return new RestTemplate();
&#125;
</code></pre>
<p>è¿™æ ·åœ¨æ¨¡å—ä¸­æƒ³ç”¨RestTemplateçš„æ—¶å€™ç›´æ¥<code>@Autowired</code>å°±å¯ä»¥äº†ã€‚</p>
<p><strong><code>@Autowired</code>ä¸Beançš„åŠ è½½</strong></p>
<p>å°±ä»è¿™äº›å¤©çš„å¼€å‘ä¸­æ¥çœ‹ï¼Œè¯¥æ³¨è§£ä»…ç”¨äºè‡ªåŠ¨è£…é…è¢«<code>@Service</code>ã€<code>@Mapper</code>æ³¨è§£çš„ç±»ã€‚è€Œå®ä½“ç±»åŸºæœ¬ç±»å‹ç­‰æ˜¯ä¸å¯èƒ½ç”¨åˆ°è¿™äº›çš„ã€‚</p>
<p>è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§<code>@Autowired</code>é…ç½®å¯¹è±¡çš„æ–¹å¼ï¼Œä¼šé€ æˆå¤šå±‚ä¾èµ–ï¼Œå¯èƒ½ä¸€ä¸ªMapperå±‚ç±»çš„ä¿®æ”¹ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ã€‚</p>
<p>è¿˜æœ‰è¦æ³¨æ„å¾ªç¯ä¾èµ–ã€‚æœ‰ç§æ­»é”çš„æ—¢è§†æ„Ÿã€‚</p>
<p>å¦å¤–è¯¥æ³¨è§£çš„ç”¨é€”å¾ˆå¤šï¼Œå¯ç”¨åœ¨æ„é€ æ–¹æ³•ä¸Šæˆ–setxxxï¼Œä½†æ˜¯ç›®å‰æ¥çœ‹è¿™äº›ç”¨æ³•ä¸å¤ªå¸¸è§ã€‚</p>
<p>Springè£…é…Beançš„è¿‡ç¨‹ï¼š</p>
<pre><code>@Target(&#123;ElementType.CONSTRUCTOR, ElementType.METHOD, ElementType.PARAMETER, ElementType.FIELD, ElementType.ANNOTATION_TYPE&#125;)    // å¯ä»¥ç”¨çš„åœ°æ–¹æ˜¯çœŸæ»´å¤š....
@Retention(RetentionPolicy.RUNTIME)  // è¿™é‡ŒæŒ‡å®šäº†æ³¨è§£çš„æœ‰æ•ˆå‘¨æœŸã€‚RUNTIMEå°±æ˜¯è¢«æ”¾å…¥ç¼–è¯‘çš„ç±»æ–‡ä»¶ä¸­å¹¶åœ¨è¿è¡Œæ—¶å¯ç”¨
                                     // è¿˜ç”¨ä¸€ç§æ˜¯SOURCEï¼Œç¼–è¯‘åå°±ä¸¢å¼ƒäº†æ¯”å¦‚@Overrideï¼Œä¸ä¼šè¿›å…¥å­—èŠ‚ç 
                                     // CLASSï¼Œç±»åŠ è½½æœŸé—´ä¸¢å¼ƒã€‚è¿™æ˜¯é»˜è®¤å€¼ã€‚  æ³¨ï¼šè¿™é‡Œåç»­å¯ä»¥å¼•ç”³å‡ºç±»çš„åŠ è½½é¡ºåºï¼Œç±»çš„åŠ è½½é¡ºåºåŒæ—¶ä¹Ÿå°±æ˜¯ç¨‹åºåŠ è½½çš„ä¸€ä¸ªåœ¨Javaä¸­çš„ä¾‹å­
@Documented
// @Inherited	æ§åˆ¶æ³¨è§£æ˜¯å¦å¯¹å­ç±»äº§ç”Ÿå½±å“ã€‚
public @interface Autowired &#123;
   /**
    * Declares whether the annotated dependency is required.&lt;p&gt;Defaults to &#123;@code true&#125;.
    */
   boolean required() default true;
/* 
ä»æºç ä¸Šçœ‹ï¼Œå…¶å®æ³¨è§£å°±æ˜¯ä¸ªæ¥å£å˜›ã€‚åœ¨ç±»ä¸Šä½¿ç”¨è¯¥æ³¨è§£çš„æ—¶å€™ï¼Œæ ¹æ®ç±»åClass.forName()å¯ä»¥æ‹¿åˆ°Classå¯¹è±¡ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªClasså¯¹è±¡å°±èƒ½æ‹¿åˆ°å…¶ä»–ä¿¡æ¯ã€‚
*/    

&#125;
</code></pre>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>è‡ªåŠ¨è£…é…å¯ä»¥å¤§å¤§åœ°å‡å°‘å±æ€§å’Œæ„é€ å™¨å‚æ•°çš„æŒ‡æ´¾ã€‚ âˆš</li>
<li>è‡ªåŠ¨è£…é…ä¹Ÿå¯ä»¥åœ¨è§£æå¯¹è±¡æ—¶æ›´æ–°é…ç½®ã€‚ ï¼Ÿï¼Ÿï¼Ÿ</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>ä¸ç›´æ¥è£…é…ç›¸æ¯”è¾ƒå‡†ç¡®æ€§ç•¥å·®ã€‚</li>
<li>å®¹å™¨ä¸­<strong>å¤šä¸ªbeançš„å®šä¹‰å¯èƒ½è¦å¯¹setterå’Œæ„é€ å™¨å‚æ•°åšç±»å‹åŒ¹é…æ‰èƒ½åšä¾èµ–æ³¨å…¥</strong>???ï¼Œè™½ç„¶å¯¹äºarrayï¼Œcollectionå’Œmapæ¥è¯´ä¸æ˜¯å•¥é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºåªæœ‰å•ä¸€å€¼çš„ä¾èµ–æ¥è®²ï¼Œè¿™å°±æœ‰ç‚¹è®²ä¸æ¸…æ¥šäº†ï¼Œæ‰€ä»¥å¦‚æœæ²¡æœ‰å”¯ä¸€çš„beanå®šä¹‰ï¼Œé‚£åªèƒ½æŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
</li>
</ul>
<p>è¯¥æ³¨è§£å¸¸ç”¨æ¥è£…é…éœ€è¦çš„å¯¹è±¡ï¼ˆBeanï¼‰ï¼Œä½†æ˜¯å¹¶ä¸èƒ½<strong>åŠæ—¶</strong>åœ°è·å–ã€‚</p>
<p><strong>AutowireCapableBeanFactory</strong></p>
<p>ä¸å·¥å‚æ¨¡å¼æœ‰å…³.</p>
<p>å½“æˆ‘ä»¬çš„åº”ç”¨æ²¡æœ‰å‘Springæ‰˜ç®¡beanä½†åˆæƒ³è®©å…¶è‡ªåŠ¨è£…é…çš„èƒ½åŠ›æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ç±»ã€‚å°±æ˜¯å°†SpringåŸæ¥æ— æ³•æ‰˜ç®¡çš„ç±»äº¤ç»™Springæ‰˜ç®¡ã€‚</p>
<p>*è¿™ä¹Ÿè¯´æ˜ä¹‹å‰æ€ç»´å¤ªç‹­éš˜ï¼ŒSpringå¹¶ä¸èƒ½åŒ…æ‰“å¤©ä¸‹ä¸æ˜¯æ‰˜ç®¡äº†ä¸€åˆ‡å¯¹è±¡ã€‚</p>
<p>ä¾‹å¦‚</p>
<pre><code>  @Autowired
  private AutowireCapableBeanFactory capableBeanFactory;

  protected Object createJobInstance(TriggerFiredBundle bundle) throws Exception &#123;
    Object jobInstance = super.createJobInstance(bundle);
    // è·å–å®šæ—¶ä»»åŠ¡å®ä¾‹ è£…é…åˆ°
    capableBeanFactory.autowireBean(jobInstance);
    return jobInstance;
  &#125;
</code></pre>
<h4 id="2-æ¨¡æ‹Ÿæç®€æµç¨‹"><a href="#2-æ¨¡æ‹Ÿæç®€æµç¨‹" class="headerlink" title="2.æ¨¡æ‹Ÿæç®€æµç¨‹"></a>2.æ¨¡æ‹Ÿæç®€æµç¨‹</h4><p>1.é¢„å¤‡çš„é…ç½®</p>
<pre><code>userDao=com.fan.springlow.bean.UserDao
</code></pre>
<p>2.å®ä½“ç±»</p>
<pre><code>@Data
public class BeanDefinition &#123;
    private String beanName;
    private Class beanClass;
&#125;
</code></pre>
<p>3.æ ¹æ®é…ç½®æ–‡ä»¶ï¼ŒåŠ è½½æœåŠ¡é‡Œéœ€è¦çš„bean</p>
<pre><code>public class ResourceLoader &#123;
    public static Map&lt;String, BeanDefinition&gt; getResource() &#123;
        // å®šä¹‰ä¸€ä¸ªMapï¼Œç”¨æ¥å­˜æ”¾åç»­éœ€è¦çš„bean
        Map&lt;String, BeanDefinition&gt; beanDefinitionMap = new HashMap&lt;&gt;(16);
        // åŠ è½½é…ç½®çš„beanç”¨
        Properties properties = new Properties();
        try &#123;
            InputStream inputStream = ResourceLoader.class.getResourceAsStream(&quot;../beans.properties&quot;);
            properties.load(inputStream);
            Iterator&lt;String&gt; it = properties.stringPropertyNames().iterator();
            while (it.hasNext()) &#123;
                String key = it.next();
                String className = properties.getProperty(key);
                BeanDefinition beanDefinition = new BeanDefinition();
                beanDefinition.setBeanName(key);
                // ä»é…ç½®ä¸­æ‹¿åˆ°beanNameç„¶ååˆ©ç”¨å‘å°„å»åˆ›é€ æ‰€éœ€è¦å¯¹è±¡çš„class
                Class clazz = Class.forName(className);
                beanDefinition.setBeanClass(clazz);
                beanDefinitionMap.put(key, beanDefinition);

            &#125;
            inputStream.close();
        &#125; catch (IOException | ClassNotFoundException e) &#123;
            e.printStackTrace();
        &#125;
        return beanDefinitionMap;
    &#125;
&#125;
</code></pre>
<p>4.beançš„æ³¨å†Œï¼ˆç¼“å­˜ï¼‰</p>
<pre><code>public class BeanRegister &#123;
    private Map&lt;String, Object&gt; singletonMap = new HashMap&lt;&gt;(32);
    public Object getSingletonBean(String beanName) &#123;
        return singletonMap.get(beanName);
    &#125;

    public void registerSingletonBean(String beanName, Object bean) &#123;
        if (singletonMap.containsKey(beanName)) &#123;
            return;
        &#125;
        singletonMap.put(beanName, bean);
    &#125;
&#125;
</code></pre>
<p>5.beançš„ç”Ÿæˆä¸è·å–ï¼ˆå…¶å®å°±æ˜¯è°ƒç”¨å‰é¢ä¸¤ä¸ªç±»çš„é€»è¾‘å°è£…äº†ä¸€ä¸‹</p>
<pre><code>public class BeanFactory &#123;
    private Map&lt;String, BeanDefinition&gt; beanDefinitionMap = new HashMap&lt;&gt;();
    private BeanRegister beanRegister;

    public BeanFactory() &#123;
        //å®šä¹‰æ„é€ æ–¹æ³•ï¼Œç”Ÿæˆä¸€ä¸ªbeançš„æ³¨å†Œå™¨ï¼ŒåŠ è½½å¥½é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„bean
        beanRegister = new BeanRegister();
        this.beanDefinitionMap = (Map&lt;String, BeanDefinition&gt;) new ResourceLoader();
    &#125;

    public Object getBean(String beanName) &#123;
        Object bean = beanRegister.getSingletonBean(beanName);
        if (bean != null) &#123;
            return bean;
        &#125;
        // å¦‚æœæ³¨å†Œå™¨è¿˜æ²¡åŠ è½½è¦çš„beanï¼Œé‚£å°±å…ˆæ”¾åˆ°åŠ è½½å™¨é‡Œ
        return createBean(beanDefinitionMap.get(beanName));
    &#125;

    private Object createBean(BeanDefinition beanDefinition) &#123;
        try &#123;
            Object bean = beanDefinition.getBeanClass().newInstance();
            beanRegister.registerSingletonBean(beanDefinition.getBeanName(), bean);
            return bean;
        &#125; catch (InstantiationException | IllegalAccessException e) &#123;
            e.printStackTrace();
        &#125;
        return null;
    &#125;

&#125;
</code></pre>
<p>ä¸Šè¿°ä»£ç è°ƒç”¨æµç¨‹å¦‚ä¸‹:</p>
<p>é¦–å…ˆbeans.propertiesä¸­è®°å½•äº†beançš„åç§°å’Œå…¶è·¯å¾„ã€‚å®é™…ä¸Šå¯¹å¤–æš´éœ²çš„åªæœ‰<code>BeanFactory</code>è¿™ä¸€ä¸ªç±»ï¼Œè°ƒç”¨getBean()è¿™ä¸ªæ–¹æ³•å»è·å–beanï¼Œä¼ å…¥çš„å‚æ•°å°±æ˜¯beanNameï¼ŒgetBeanä¼šæ ¹æ®BeanNameå»æš‚å­˜Beançš„Mapä¸­æ‰¾æ˜¯å¦æœ‰å¯¹åº”çš„beanï¼Œæ²¡æœ‰çš„è¯ä¼šè°ƒç”¨createBean()ã€‚</p>
<p>éœ€è¦è¾¨æ˜çš„æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªmap,ä¸€ä¸ªmapæ˜¯åŠ è½½äº†beanNameä¸æºå¸¦äº†propertiesä¸­ä¿¡æ¯çš„å¯¹è±¡ã€‚</p>
<p>ä¸€ä¸ªæ˜¯å®é™…ä¸Šç¼“å­˜äº†æ‰€éœ€è¦beançš„Mapã€‚</p>
<p>æ€è€ƒï¼šä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Ÿ æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p>

  </div>
  <div id=""></div>
</div>

<script>
  
Fancybox.bind('[data-fancybox="fancybox-gallery-img"]', {
  dragToClose: true,
  Toolbar: true,
  closeButton: "top",
  Image: {
    zoom: true,
  },
  on: {
    initCarousel: (fancybox) => {
      const slide = fancybox.Carousel.slides[fancybox.Carousel.page];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
    "Carousel.change": (fancybox, carousel, to, from) => {
      const slide = carousel.slides[to];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
  },
});
</script>

<style>
    #noneimg img {
        display: none;
        z-index: 9999;
        /* width: 600px !important; */
        min-width: 0%;
        max-width: 90%;
        max-height: 80%;
        border-radius: 0px;
        position: fixed;
        box-shadow: 0 0 0px #c3c3c300 !important;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto !important;
    }

    @media screen and (max-width:600px) {
        #noneimg img {
            max-width: 88%
        }
    }
</style>

    <div class="post-paging">
    
    <a href="/2024/01/08/LSS/spring%20mvc/">
        <div class="post-paging-last">
            <span>ä¸Šä¸€ç¯‡</span>
            <p>Spring MVC</p>
        </div>
    </a>
    

    
    <a href="/2024/01/08/LSS/springboot/">
        <div class="post-paging-next">
            <span>ä¸‹ä¸€ç¯‡</span>
            <p>Springboot</p>
        </div>
    </a>
    
</div>
</div>
		
<div class="footer">
	<div class="Copyright">
		Â©2024 By SoftLipa. ä¸»é¢˜ï¼š<a
			style="text-decoration: none;display: contents; color: #898F9F;"
			target="_blank" rel="noopener" href="https://github.com/79e/hexo-theme-quiet">Quiet</a>
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
		</a>
		
	</div>
</div>

<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            transition: border .5s;
            border: 1px solid rgba(18, 24, 58, 0.06);

            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari å’Œ Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $( '#js-go_top' )
	.gotoTop( {
		offset: 500,
		speed: 300,
		animationShow: {
			'transform': 'translate(0,0)',
			'transition': 'transform .5s ease-in-out'
		},
		animationHide: {
			'transform': 'translate(100px,0)',
			'transition': 'transform .5s ease-in-out'
		}
	} );
</script>


    <!-- Gitalk -->
    <script>
        const data = '{"clientID":"02b3c","clientSecret":"adfc7b4","repo":"gimment","owner":"duneng","admin":"duneng"}'
        const gitalk = new Gitalk({
            ...JSON.parse( data),
            id:location.pathname,
            distractionFreeMode:false
        })
        
        if(Boolean('false')){
            gitalk.render('gitalk-container')
        }
    </script>

<script>
	console.log('\n %c Hexo-Quiet ä¸»é¢˜ %c https://github.com/79e/hexo-theme-quiet \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
</script>
	</body>
</html>

