<!DOCTYPE html>
<html>
	<head>
		
<title>Springboot-ğŸ§ </title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/dragon.ico">

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="java,Spring,Springboot,">
<meta name="description" content="Springbootå­¦ä¹ è¿‡ç¨‹">


<script src="/js/jquery.min.js"></script>


<script src="/js/index.js"></script>


<script src="/js/fancybox.umd.js"></script>


<script src="/js/fancybox-images.js"></script>


<script src="/js/gitalk.min.js"></script>


<script src="/js/hljs.min.js"></script>
 
<script>hljs.highlightAll();</script>

	<meta name="generator" content="Hexo 6.3.0"></head>

	<body>
		
	<div class="header">
		<div class="header-top" id="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/dragon.png" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										ä¸»é¡µ
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										æ–‡æ¡£
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/categories">
										åˆ†ç±»
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/tags">
										æ ‡ç­¾
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/links">
										å‹æƒ…é“¾æ¥
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/about">
										æˆ‘
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>SoftLipa</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">ä¸»é¡µ</a>
        </li>
        
        <li>
            <a href="/archives">æ–‡æ¡£</a>
        </li>
        
        <li>
            <a href="/categories">åˆ†ç±»</a>
        </li>
        
        <li>
            <a href="/tags">æ ‡ç­¾</a>
        </li>
        
        <li>
            <a href="/links">å‹æƒ…é“¾æ¥</a>
        </li>
        
        <li>
            <a href="/about">æˆ‘</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
        </a>
        
    </div>
</div>
<div class='shelter'>
</div>
<style>
    .shelter{
        background-color: #333;
        opacity:0.5;
        cursor: pointer;
        display: none; 
        position: fixed;
        left: 0;
        top: 0; 
        right: 0;
        bottom: 0;
        z-index: 1998;
    }
    .sidebar {
        width: 66%;
        height: 100%;
        position: fixed;
        top: 0;
        right: -100%;
        bottom: 0;
        background: #fff;
        z-index: 1999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815);
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $( function () {
	$( '.h-right-close>svg' )
		.click( function () {
			$( '.sidebar' )
				.animate( {
					right: "0"
				}, 500 );
			$( '.shelter' )
				.fadeIn( "slow" )
		} );
	$( '.shelter' )
		.click( function ( e ) {
			$( '.sidebar' )
				.animate( {
					right: "-100%"
				}, 500 );
			$( '.shelter' )
				.fadeOut( "slow" )
		} )
} )

</script>

<div class="post">
    <div class="post-header-background post-header-img"
    style="background: url('https://tu.ltyuanfang.cn/api/fengjing.php')" 
>
    <div class="post-header-background-content">
        <ul class="post-header-tag">
            
            
            <li><a href="/tags/java">java</a></li>
            
            <li><a href="/tags/Spring">Spring</a></li>
            
            <li><a href="/tags/Springboot">Springboot</a></li>
            
            
        </ul>
        
        <h1>Springboot</h1>
        <div class="post-header-info">
            <div class="post-header-info-author">
                
                    <svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
                        <path
                            d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
                            p-id="2902" fill="#ffffff"></path>
                    </svg>
                    
                <span class="post-header-info-author-text"> <a href="../../about">SoftLipa</a></span>
                <div class="post-header-info-author-categories">
                    
                         <a href="../../categories/java/" target="_blank" >java</a>
                    
                </div>
                <p>2024-01-08 09:33:36</p>
            </div>
        </div>
    </div>
</div>
    <div class="post-content" id="content">
  
  <div id="article" class="post-content-info">
    

    <h1 id="SpringBoot"><a href="#SpringBoot" class="headerlink" title="SpringBoot"></a>SpringBoot</h1><p>åªæ¢ç©¶APIæ˜¯å›ºæ­¥è‡ªå°ï¼Œè¦æœ‰æ¢ç©¶æºç çš„ä¹ æƒ¯ã€‚â€”â€”å†™åœ¨å‰é¢</p>
<h2 id="åŸºç¡€ç¯‡"><a href="#åŸºç¡€ç¯‡" class="headerlink" title="åŸºç¡€ç¯‡"></a>åŸºç¡€ç¯‡</h2><h3 id="å›é¡¾Spring"><a href="#å›é¡¾Spring" class="headerlink" title="å›é¡¾Spring"></a>å›é¡¾Spring</h3><p><strong>Springæ˜¯å¦‚ä½•ç®€åŒ–Javaå¼€å‘çš„ï¼Ÿ</strong></p>
<p>4ä¸ª å…³é”®ç­–ç•¥ï¼š</p>
<ol>
<li>åŸºäºPOJOçš„è½»é‡çº§å’Œæœ€å°ä¾µå…¥æ€§ç¼–ç¨‹ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯beanã€‚</li>
<li>é€šè¿‡IOCï¼Œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å’Œé¢å‘æ¥å£å®ç°æ¾è€¦åˆ</li>
<li>åŸºäºåˆ‡é¢ï¼ˆAOPï¼‰å’Œæƒ¯ä¾‹ï¼ˆï¼Ÿï¼Ÿï¼Ÿ è¿›è¡Œå£°æ˜å¼ç¼–ç¨‹</li>
<li>é€šè¿‡åˆ‡é¢å’Œæ¨¡æ¿å‡å°‘æ ·å¼ä»£ç ï¼Œå¦‚RedisTemplate,xxTemplate</li>
</ol>
<p><strong>Springboot:çº¦å®šå¤§äºé…ç½®</strong></p>
<ul>
<li><p>å¼€ç®±å³ç”¨,æä¾›å„ç§é»˜è®¤é…ç½®ç®€åŒ–é¡¹ç›®é…ç½®</p>
</li>
<li><p>å†…åµŒå¼å®¹å™¨ç®€åŒ–webé¡¹ç›®</p>
</li>
<li><p>æ²¡æœ‰å†—ä½™ä»£ç ç”Ÿæˆå’ŒXMLé…ç½®çš„è¦æ±‚</p>
<p>æ³¨ï¼šä»Springåˆ°Springbootçš„å·¨å¤§é£è·ƒå°±æ˜¯çœäº†è®¸å¤š.xmlçš„é…ç½®ï¼Œé‚£ä¹ˆè¿™äº›.xmlé™¤äº†åŒ–ä¸ºyamlä¸­çš„é…ç½®ä»¥å¤–è¿˜å˜æˆäº†ä»€ä¹ˆå‘¢ï¼Ÿæ„Ÿè§‰å¤§éƒ¨åˆ†æ˜¯ç§»äº¤ç»™äº†Springbootçš„è‡ªåŠ¨è£…é…+yaml</p>
</li>
</ul>
<p>æ‰“åŒ…æ—¶è·³è¿‡æµ‹è¯•ç”¨ä¾‹ï¼š</p>
<pre><code>&lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
&lt;!--                    è·³è¿‡é¡¹ç›®æµ‹è¯•ç”¨ä¾‹--&gt;
                    &lt;skipTests&gt;true&lt;/skipTests&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
</code></pre>
<h3 id="è¿è¡ŒåŸç†"><a href="#è¿è¡ŒåŸç†" class="headerlink" title="è¿è¡ŒåŸç†"></a>è¿è¡ŒåŸç†</h3><h4 id="çˆ¶ä¾èµ–ï¼š"><a href="#çˆ¶ä¾èµ–ï¼š" class="headerlink" title="çˆ¶ä¾èµ–ï¼š"></a>çˆ¶ä¾èµ–ï¼š</h4><p>ä¾èµ–ä¸€ä¸ªçˆ¶é¡¹ç›®ï¼Œä¸»è¦æ˜¯ç®¡ç†é¡¹ç›®çš„èµ„æºè¿‡æ»¤ä»¥åŠæ’ä»¶ã€‚</p>
<pre><code>&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;2.5.1&lt;/version&gt;
    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
&lt;/parent&gt;
</code></pre>
<p>è¿›å…¥ä»¥åä¾ç„¶æœ‰ä¸€ä¸ªçˆ¶ä¾èµ–ï¼š</p>
<pre><code>&lt;parent&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;
  &lt;version&gt;2.5.1&lt;/version&gt;
&lt;/parent&gt;
</code></pre>
<p>å…¶ç®¡ç†Springbootåº”ç”¨ä¸­æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬ï¼Œç‰ˆæœ¬æ§åˆ¶ä¸­å¿ƒ</p>
<p>ä»¥åå¯¼å…¥ä¾èµ–é»˜è®¤æ˜¯ä¸éœ€å†™ç‰ˆæœ¬çš„ï¼Œå¦‚æœå¯¼å…¥çš„åŒ…æ²¡æœ‰åœ¨ä¾èµ–ä¸­ç®¡ç†åˆ™éœ€è¦æ‰‹åŠ¨é…ç½®ç‰ˆæœ¬ã€‚</p>
<h4 id="å¯åŠ¨å™¨-spring-boot-starter"><a href="#å¯åŠ¨å™¨-spring-boot-starter" class="headerlink" title="å¯åŠ¨å™¨ spring-boot-starter"></a>å¯åŠ¨å™¨ spring-boot-starter</h4><pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>spring-boot-strater-xxx:spring-bootçš„åœºæ™¯å¯åŠ¨å™¨</p>
<p>spring-boot-starter-web:å¯¼å…¥äº†webæ¨¡å—æ­£å¸¸è¿è¡Œæ‰€ä¾èµ–çš„ç»„ä»¶</p>
<p>SpringbootæŠ½å–å‡ºæ‰€æœ‰åŠŸèƒ½åœºæ™¯ï¼Œåšæˆä¸€ä¸ªä¸ªstarterï¼Œåªéœ€åœ¨é¡¹ç›®ä¸­å¼•å…¥è¿™äº›starterå³å¯ï¼Œæ‰€æœ‰ç›¸å…³ä¾èµ–éƒ½ä¼šå¯¼å…¥ã€‚</p>
<p>ä»€ä¹ˆåŠŸèƒ½ï¼Œå¯¼å…¥ä»€ä¹ˆåœºæ™¯å¯åŠ¨å™¨ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰å¯åŠ¨å™¨ã€‚</p>
<h4 id="3-ä¸»å¯åŠ¨ç±»"><a href="#3-ä¸»å¯åŠ¨ç±»" class="headerlink" title="3.ä¸»å¯åŠ¨ç±»"></a>3.ä¸»å¯åŠ¨ç±»</h4><h5 id="3-1é»˜è®¤ä¸»å¯åŠ¨ç±»ï¼š"><a href="#3-1é»˜è®¤ä¸»å¯åŠ¨ç±»ï¼š" class="headerlink" title="3.1é»˜è®¤ä¸»å¯åŠ¨ç±»ï¼š"></a>3.1é»˜è®¤ä¸»å¯åŠ¨ç±»ï¼š</h5><pre><code>@SpringBootApplication  //æ ‡æ³¨ä¸€ä¸ªä¸»ç¨‹åºç±»  è¯´æ˜è¿™æ˜¯ä¸€ä¸ªspringbootåº”ç”¨
public class Springboot03WebApplication &#123;

    public static void main(String[] args) &#123;
        SpringApplication.run(Springboot03WebApplication.class, args);
    &#125;

&#125;
</code></pre>
<p>è¯¥ç±»ä¸­å„ä¸ªæ³¨è§£çš„ä½œç”¨ï¼š</p>
<h5 id="3-2-SpringBootApplication"><a href="#3-2-SpringBootApplication" class="headerlink" title="3.2@SpringBootApplication"></a><strong>3.2@SpringBootApplication</strong></h5><p>ä½œç”¨ï¼šæ ‡æ³¨åœ¨æŸä¸ªç±»ä¸Šè¯´æ˜è¯¥ç±»æ˜¯SpringBootçš„ä¸»é…ç½®ç±»ï¼ŒSpringBootå°±åº”è¯¥è¿è¡Œè¯¥ç±»çš„mainæ–¹æ³•æ¥å¯åŠ¨SpringBootåº”ç”¨</p>
<p>è¿›å…¥è¯¥æ³¨è§£ï¼Œå…¶ä¸­ä¹Ÿç”¨åˆ°äº†å¤šä¸ªæ³¨è§£ï¼Œä¸»è¦æ˜¯ï¼š</p>
<pre><code>@SpringBootConfiguration
@EnableAutoConfiguration
@ComponentScan(
    excludeFilters = &#123;@Filter(
    type = FilterType.CUSTOM,
    classes = &#123;TypeExcludeFilter.class&#125;
), @Filter(
    type = FilterType.CUSTOM,
    classes = &#123;AutoConfigurationExcludeFilter.class&#125;
)&#125;
</code></pre>
<p><strong>@ComponentScan</strong></p>
<p> è¯¥æ³¨è§£åœ¨Springä¸­å¾ˆé‡è¦ï¼Œå¯¹åº”XMLé…ç½®ä¸­çš„å…ƒç´ </p>
<p> ä½œç”¨ï¼šè‡ªåŠ¨æ‰«æå¹¶åŠ è½½ç¬¦åˆæ¡ä»¶çš„ç»„ä»¶æˆ–beanï¼Œå°†è¯¥beanå®šä¹‰åŠ è½½åˆ°å®¹å™¨ä¸­ã€‚</p>
<p> <strong>@SpringBootConfiguration</strong></p>
<p> ä½œç”¨ï¼šSpringBootçš„é…ç½®ç±»ï¼Œæ ‡æ³¨è¯¥ç±»ä¸Šè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªSpringBootçš„é…ç½®ç±»</p>
<p> è¿›å…¥è¯¥æ³¨è§£æŸ¥çœ‹ï¼š</p>
<p> åœ¨åŸç‰ˆæœ¬ä¸­æ˜¯**@Configuration<strong>å’Œ</strong>@Component**ä¸¤ä¸ªæ³¨è§£ï¼Œå¦‚ä»Šç‚¹è¿›å»åä»…æœ‰@Configuration</p>
<p> è€Œåœ¨Configuration.classä¸­åº”ç”¨äº†**@Component**æ³¨è§£</p>
<p>å¯åŠ¨ç±»æœ¬èº«å°±æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè´Ÿè´£å¯åŠ¨åº”ç”¨ï¼Œä¹Ÿæ˜¯ä¸ªé…ç½®ç±»ï¼ˆå¯¹åº”Springä¸­çš„xmlé…ç½®æ–‡ä»¶ï¼‰</p>
<p><strong>@EnableAutoConfiguration</strong></p>
<p> å¼€å¯è‡ªåŠ¨é…ç½®åŠŸèƒ½</p>
<p> ä¹‹å‰SSMä¸­éœ€è¦è‡ªå·±é…ç½®çš„ä¸œè¥¿ï¼Œç°åœ¨SpringBootå¯ä»¥è‡ªåŠ¨å¸®åŠ©é…ç½®ã€‚</p>
<p> @EnableAutoConfigurationå‘Šè¯‰SpringBootå¼€å¯è‡ªåŠ¨é…ç½®åŠŸèƒ½</p>
<p><strong>@AutoConfigurationPackage: è‡ªåŠ¨é…ç½®åŒ…</strong></p>
<pre><code>@Import(&#123;Registrar.class&#125;)
public @interface AutoConfigurationPackage &#123;
&#125;
</code></pre>
<ul>
<li>@importï¼š Springåº•å±‚æ³¨è§£@import,ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶</li>
<li>Registrar.classä½œç”¨ï¼šè‡ªåŠ¨é…ç½®åŒ…æ³¨å†Œï¼Œå°†ä¸»å¯åŠ¨ç±»çš„æ‰€åœ¨åŒ…åŠåŒ…ä¸‹é¢æ‰€æœ‰å­åŒ…ä¸­çš„ç»„ä»¶æ‰«æåˆ°Springå®¹å™¨</li>
</ul>
<p><strong>@import({AutoConfigurationImportSelector.class})ï¼šç»™å®¹å™¨å¯¼å…¥ç»„ä»¶</strong></p>
<p>AutoConfigurationImportSelector:è‡ªåŠ¨é…ç½®å¯¼å…¥<strong>é€‰æ‹©å™¨</strong>ï¼Œ</p>
<p>â€¦.æºç æ¢ç©¶åç»­è¡¥å……</p>
<p>æœ€ç»ˆå‘ç°ä¸€ä¸ªå¤šæ¬¡å‡ºç°çš„spring.propertiesæ–‡ä»¶</p>
<h5 id="3-3spring-factories"><a href="#3-3spring-factories" class="headerlink" title="3.3spring.factories"></a>3.3spring.factories</h5><p>è¿›å…¥åçœ‹åˆ°äº†è®¸å¤šè‡ªåŠ¨é…ç½®æ–‡ä»¶</p>
<p><img src="/" alt="img"></p>
<p>éšæ„ç‚¹è¿›å»ä¸€ä¸ªæ¯”å¦‚WebMvcAutoConfiguration</p>
<p>å…¶ä¸­æœ‰è®¸å¤šçš„JavaConfigé…ç½®ç±»ï¼Œä¸”éƒ½æ³¨å…¥äº†ä¸€äº›Bean</p>
<p>æ‰€ä»¥ï¼Œè‡ªåŠ¨é…ç½®çœŸæ­£å®ç°æ˜¯ä»classpathä¸­æœå¯»æ‰€æœ‰çš„META-INF&#x2F;spring.factoriesé…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å…¶ä¸­å¯¹åº”çš„<code>org.springframework.boot.autoconfigure</code>. åŒ…ä¸‹çš„é…ç½®é¡¹ï¼Œé€šè¿‡<strong>åå°„</strong>å®ä¾‹åŒ–ä¸ºå¯¹åº”æ ‡æ³¨äº†@Configurationçš„JavaConfigå½¢å¼çš„IoCå®¹å™¨é…ç½®ç±»ï¼Œç„¶åæ±‡æ€»æˆä¸ºä¸€ä¸ªå®ä¾‹å¹¶åŠ è½½IoCå®¹å™¨ä¸­ã€‚</p>
<h4 id="4-ç»“è®º"><a href="#4-ç»“è®º" class="headerlink" title="4.ç»“è®º"></a>4.ç»“è®º</h4><ol>
<li>Springbootåœ¨å¯åŠ¨çš„æ—¶å€™ä»ç±»è·¯å¾„ä¸‹çš„META-INF&#x2F;spring.factoriesä¸­è·å–EnableAutoConfigurationæŒ‡å®šçš„å€¼</li>
<li>å°†è¿™äº›å€¼ä½œä¸ºè‡ªåŠ¨é…ç½®ç±»å¯¼å…¥å®¹å™¨ï¼Œè‡ªåŠ¨é…ç½®ç±»å°±ç”Ÿæ•ˆï¼Œç„¶åå°±å¯ä»¥è‡ªåŠ¨é…ç½®</li>
<li>ä»¥å‰éœ€è¦æ‰‹åŠ¨é…ç½®çš„å†…å®¹äº¤ç”±Springboot</li>
<li>æ•´åˆJavaEE,æ•´ä½“è§£å†³æ–¹æ¡ˆå’Œè‡ªåŠ¨é…ç½®çš„ä¸œè¥¿éƒ½åœ¨Springboot-autoconfigureçš„jaråŒ…ä¸­ã€‚</li>
<li>å…¶ä¼šå°†æ‰€æœ‰éœ€è¦å¯¼å…¥çš„ç»„ä»¶ä»¥ç±»åçš„å½¢å¼è¿”å›ï¼Œè¿™äº›ç»„ä»¶ä¼šè¢«æ·»åŠ åˆ°å®¹å™¨ä¸­ã€‚</li>
<li>Springbootä¼šç»™å®¹å™¨ä¸­å¯¼å…¥éå¸¸å¤šçš„è‡ªåŠ¨é…ç½®ç±»ï¼Œï¼ˆXxxxAutoConfiguration)ï¼Œå°±æ˜¯ç»™å®¹å™¨ä¸­å¯¼å…¥è¿™ä¸ªåœºæ™¯éœ€è¦çš„æ‰€æœ‰ç»„ä»¶å¹¶è‡ªåŠ¨é…ç½®,@Configuration(javaConfig)</li>
<li>æœ‰äº†è‡ªåŠ¨é…ç½®ç±»ï¼Œçœå»äº†æ‰‹åŠ¨ç¼–å†™é…ç½®æ³¨å…¥åŠŸèƒ½ç»„ä»¶ç­‰çš„å·¥ä½œã€‚</li>
</ol>
<h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><h4 id="1ä¸ç®€å•çš„æ–¹æ³•"><a href="#1ä¸ç®€å•çš„æ–¹æ³•" class="headerlink" title="1ä¸ç®€å•çš„æ–¹æ³•"></a>1ä¸ç®€å•çš„æ–¹æ³•</h4><p>çœ‹ä¼¼åªæ˜¯è¿è¡Œäº†ä¸€ä¸ªmainæ–¹æ³•ï¼Œç»“æœå®é™…ä¸Šæ˜¯å¼€å¯äº†ä¸€ä¸ªæœåŠ¡ã€‚</p>
<pre><code>@SpringBootApplication
public class Springboot10ZookeeperApplication &#123;
    public static void main(String[] args) &#123;
        //è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªConfigurableApplicationContextå¯¹è±¡
        //å‚æ•°ä¸€ï¼šåº”ç”¨å…¥å£çš„ç±» å‚æ•°äºŒå‘½ä»¤è¡Œå‚æ•°
        SpringApplication.run(Springboot10ZookeeperApplication.class, args);
    &#125;

&#125;
</code></pre>
<p>SpringApplication.runåˆ†æï¼š</p>
<ul>
<li>ä¸€æ˜¯SpringApplicationçš„å®ä¾‹åŒ–</li>
<li>äºŒæ˜¯runæ–¹æ³•çš„æ‰§è¡Œ</li>
</ul>
<h4 id="2-SpringApplication"><a href="#2-SpringApplication" class="headerlink" title="2.SpringApplication"></a>2.SpringApplication</h4><p>è¯¥ç±»çš„ä»»åŠ¡ï¼š</p>
<ol>
<li>æ¨æ–­åº”ç”¨çš„ç±»å‹æ˜¯æ™®é€šçš„é¡¹ç›®è¿˜æ˜¯Webé¡¹ç›®</li>
<li>æŸ¥æ‰¾å¹¶åŠ è½½æ‰€æœ‰å¯ç”¨åˆå§‹åŒ–å™¨ï¼Œè®¾ç½®åˆ°initializerså±æ€§ä¸­</li>
<li>æ‰¾å‡ºæ‰€æœ‰çš„åº”ç”¨ç¨‹åºç›‘å¬å™¨ï¼Œè®¾ç½®åˆ°listenerså±æ€§ä¸­</li>
<li>æ¨æ–­å¹¶è®¾ç½®mainæ–¹æ³•çš„å®šä¹‰ç±»ï¼Œæ‰¾åˆ°è¿è¡Œçš„ä¸»ç±»ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸èƒ½å†åƒä¹‹å‰åœ¨å…¶ä»–æ–¹æ³•ä¸­è®¾ç½®mainäº†ï¼Ÿï¼‰</li>
</ol>
<p><strong>æ„é€ å™¨</strong></p>
<pre><code>public SpringApplication(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources) &#123;
    //.....
    this.webApplicationType = WebApplicationType.deduceFromClasspath();
    this.bootstrapRegistryInitializers = this.getBootstrapRegistryInitializersFromSpringFactories(); this.setInitializers(this.getSpringFactoriesInstances(ApplicationContextInitializer.class));
    this.setListeners(this.getSpringFactoriesInstances(ApplicationListener.class));
    this.mainApplicationClass = this.deduceMainApplicationClass();
&#125;
</code></pre>
<h4 id="3-runæ–¹æ³•æµç¨‹åˆ†æ"><a href="#3-runæ–¹æ³•æµç¨‹åˆ†æ" class="headerlink" title="3.runæ–¹æ³•æµç¨‹åˆ†æ"></a>3.runæ–¹æ³•æµç¨‹åˆ†æ</h4><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy91SkRBVUtyR0M3TDF2RlFNbmFSSUpTbWVaNThUMmVaaWNqYWZpYXdRTHA5dTh3YzRpYzFNank2T3lmaWJ6ZmpWb2ZlTDVwblMxTlNGS1ZqbElnNm5lSTl5U2cvNjQw?x-oss-process=image/format,png" alt="img"></p>
<h4 id="Springbootçš„ç†è§£"><a href="#Springbootçš„ç†è§£" class="headerlink" title="Springbootçš„ç†è§£"></a>Springbootçš„ç†è§£</h4><ul>
<li>è‡ªåŠ¨è£…é…</li>
<li>run()</li>
<li>å…¨é¢æ¥ç®¡SpringMVCçš„é…ç½®</li>
</ul>
<hr>
<h3 id="yamlè¯­æ³•å­¦ä¹ "><a href="#yamlè¯­æ³•å­¦ä¹ " class="headerlink" title="yamlè¯­æ³•å­¦ä¹ "></a>yamlè¯­æ³•å­¦ä¹ </h3><h4 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>Springbootä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶åç§°æ˜¯å›ºå®šçš„ã€‚</p>
<ul>
<li>applicationlproperties â€“å¯¹åº”è¯­æ³•ç»“æ„ï¼škey&#x3D;value</li>
<li>application.yaml â€“ è¯­æ³•ç»“æ„: key: value (ä¸€å®šè¦æ³¨æ„ ç©ºæ ¼ å’Œç¼©è¿›)</li>
<li>å¿…é¡»æ³¨æ„ç¼©è¿›ï¼Œç¼©è¿›æ˜¯æ§åˆ¶å±‚çº§å…³ç³»çš„ï¼ï¼ï¼å·¦ä¾§å¯¹é½çš„ä¸€åˆ—æ•°æ®éƒ½æ˜¯åŒä¸€å±‚çº§</li>
</ul>
<p><strong>é…ç½®æ–‡ä»¶çš„ä½œç”¨ï¼š</strong> **ä¿®æ”¹Springbootè‡ªåŠ¨é…ç½®çš„é»˜è®¤å€¼ï¼Œå› ä¸ºè®¸å¤šä¸œè¥¿Springbootåœ¨åº•å±‚å°±è‡ªåŠ¨é…ç½®å¥½äº†ã€‚</p>
<p>æ¯”å¦‚ä¿®æ”¹Tomcaté»˜è®¤å¯åŠ¨çš„ç«¯å£å·ã€‚</p>
<pre><code>server:
  port: 8081
</code></pre>
<h4 id="Yaml"><a href="#Yaml" class="headerlink" title="Yaml"></a>Yaml</h4><p>æ¦‚è¿°ï¼šä»¥æ•°æ®ä¸ºä¸­å¿ƒ</p>
<p>è¯­å¥ï¼š ä¸å¯çœ æ³¨æ„ç¼©è¿›â€“å±‚çº§ å¤§å°å†™æ•æ„Ÿ</p>
<p>åŒå¼•å·ä¸ä¼šè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ ä½†æ˜¯å•å¼•å·ä¼šï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>name: â€œkuang \n shenâ€ è¾“å‡º ï¼škuang æ¢è¡Œ shen</li>
<li>name: â€˜kuang \n shenâ€™ è¾“å‡º ï¼škuang \n shen</li>
</ul>
<p>ç”¨Mapè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡ï¼š</p>
<pre><code>student:
    name: qinjiang
    age: 3
</code></pre>
<p>è¡Œå†…å†™æ³•ï¼š</p>
<pre><code>student: &#123;name: qinjiang,age: 3&#125;
</code></pre>
<p>æ•°ç»„(List, set)</p>
<p>-å€¼ è¡¨ç¤ºç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ â€˜</p>
<pre><code>pets:
 - cat
 - dog
 - pig
</code></pre>
<p>è¡Œå†…å†™æ³•ï¼špets: [cat,dog,pig]</p>
<p>åˆ‡æ¢ç«¯å£</p>
<pre><code>server:
  port: 8084
</code></pre>
<h4 id="yamlæ³¨å…¥é…ç½®æ–‡ä»¶"><a href="#yamlæ³¨å…¥é…ç½®æ–‡ä»¶" class="headerlink" title="yamlæ³¨å…¥é…ç½®æ–‡ä»¶"></a>yamlæ³¨å…¥é…ç½®æ–‡ä»¶</h4><p>yamlæ–‡ä»¶æœ‰å…¶ç‹¬ç‰¹çš„ä¼˜åŠ¿ã€‚å®ƒå¯ä»¥ç»™å®ä½“ç±»ç›´æ¥æ³¨å…¥åŒ¹é…å€¼ã€‚</p>
<h5 id="yamlæ³¨å…¥é…ç½®æ–‡ä»¶-1"><a href="#yamlæ³¨å…¥é…ç½®æ–‡ä»¶-1" class="headerlink" title="yamlæ³¨å…¥é…ç½®æ–‡ä»¶"></a>yamlæ³¨å…¥é…ç½®æ–‡ä»¶</h5><ol>
<li>resourceä¸­æ–°å»ºä¸€ä¸ªapplication.yaml</li>
<li>ç¼–å†™å®ä½“ç±»Dog</li>
</ol>
<pre><code>@Component
@Data
public class Dog &#123;
    @Value(&quot;é˜¿é»„&quot;)
    private String name;
    @Value(&quot;19&quot;)
    private Integer age;
&#125;
</code></pre>
<p>ç»™Beanæ³¨å…¥å±æ€§å€¼ï¼Œå…ˆä½¿ç”¨@value</p>
<p>æµ‹è¯•è¾“å‡ºæˆåŠŸã€‚</p>
<p>å¦å¤–å†ç¼–å†™ä¸€ä¸ªç±»ï¼šPerson</p>
<pre><code>@Data
@Component
@ConfigurationProperties(prefix = &quot;person&quot;)
public class Person &#123;
    private String name;
    private Integer age;
    private Boolean happy;
    private Date birth;
    private Map&lt;String, Object&gt; maps;
    private List&lt;Object&gt; list;
    private Dog dog;
&#125;
</code></pre>
<p>é€šè¿‡yamlè¿›è¡Œæ³¨å…¥</p>
<pre><code>person:
  name: liyifan
  age: 20
  happy: false
  birth: 2020/07/07
  maps: &#123;student: no, employee: yes&#125;
  list:
    - code
    - money
    - dream?
  dog:
    name: wxt
    age: 2
</code></pre>
<p>æŠ¥é”™</p>
<p><img src="/" alt="image-20210707102942134"></p>
<p>open Decumentationè¿›å…¥å®˜ç½‘ ï¼Œæ ¹æ®æç¤ºæ·»åŠ ä¾èµ–</p>
<h5 id="åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶"><a href="#åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶" class="headerlink" title="åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶"></a>åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶</h5><ul>
<li>**@PropertySource:**åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶</li>
<li><strong>@ConfigurationProperties</strong>:é»˜è®¤ä»å…¨å±€é…ç½®æ–‡ä»¶ä¸­è·å–å€¼</li>
</ul>
<ol>
<li><p>ç„¶ååœ¨æˆ‘ä»¬çš„ä»£ç ä¸­æŒ‡å®šåŠ è½½person.propertiesæ–‡ä»¶</p>
<pre><code>@PropertySource(value = &quot;classpath:person.properties&quot;)
@Component //æ³¨å†Œbean
public class Person &#123;

    @Value(&quot;$&#123;name&#125;&quot;)
    private String name;

    ......  
&#125;
</code></pre>
</li>
</ol>
<h5 id="é…ç½®æ–‡ä»¶å ä½ç¬¦"><a href="#é…ç½®æ–‡ä»¶å ä½ç¬¦" class="headerlink" title="é…ç½®æ–‡ä»¶å ä½ç¬¦"></a>é…ç½®æ–‡ä»¶å ä½ç¬¦</h5><p>å¯ä»¥ç›´æ¥ç”Ÿæˆéšæœºæ•°</p>
<pre><code>person:
  name: qinjiang$&#123;random.uuid&#125;
  age: $&#123;random.int&#125;
  happy: false
  birth: 2020/07/13
  maps: &#123;k1: v1,k2: v2&#125;
  lists:
    - code
    - music
    - girl
  dog:
    name: $&#123;person.hell:hello&#125;_æ—ºè´¢
    age: 3
</code></pre>
<h4 id="å›é¡¾propertiesé…ç½®"><a href="#å›é¡¾propertiesé…ç½®" class="headerlink" title="å›é¡¾propertiesé…ç½®"></a>å›é¡¾propertiesé…ç½®</h4><p>yamlæ–¹æ³•æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œå¼€å‘ä¸­æœ€å¸¸ç”¨ï¼Œä¹Ÿæ˜¯Springbootæ‰€æ¨èã€‚</p>
<p><code>properties</code>é…ç½®æ–‡ä»¶åœ¨å†™ä¸­æ–‡çš„æ—¶å€™ï¼Œä¼šæœ‰ä¹±ç  ï¼Œ æˆ‘ä»¬éœ€è¦å»IDEAä¸­è®¾ç½®ç¼–ç æ ¼å¼ä¸ºUTF-8ï¼›settingsâ€“&gt;FileEncodings ä¸­é…ç½®ï¼›</p>
<h4 id="ConfigurationProperties-ä¸-Valueå¯¹æ¯”"><a href="#ConfigurationProperties-ä¸-Valueå¯¹æ¯”" class="headerlink" title="@ConfigurationProperties ä¸ @Valueå¯¹æ¯”"></a>@ConfigurationProperties ä¸ @Valueå¯¹æ¯”</h4><ol>
<li><code>@ConfigurationProperties</code>åªéœ€è¦å†™ä¸€æ¬¡å³å¯ ï¼Œ @Valueåˆ™éœ€è¦æ¯ä¸ªå­—æ®µéƒ½æ·»åŠ </li>
<li>æ¾æ•£ç»‘å®šï¼šè¿™ä¸ªä»€ä¹ˆæ„æ€å‘¢? æ¯”å¦‚æˆ‘çš„ymlä¸­å†™çš„last-nameï¼Œè¿™ä¸ªå’ŒlastNameæ˜¯ä¸€æ ·çš„ï¼Œ - åé¢è·Ÿç€çš„å­—æ¯é»˜è®¤æ˜¯å¤§å†™çš„ã€‚è¿™å°±æ˜¯æ¾æ•£ç»‘å®šã€‚å¯ä»¥æµ‹è¯•ä¸€ä¸‹</li>
<li>JSR303æ•°æ®æ ¡éªŒ ï¼Œ è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨å­—æ®µæ˜¯å¢åŠ ä¸€å±‚è¿‡æ»¤å™¨éªŒè¯ ï¼Œ å¯ä»¥ä¿è¯æ•°æ®çš„åˆæ³•æ€§</li>
<li>å¤æ‚ç±»å‹å°è£…ï¼Œymlä¸­å¯ä»¥å°è£…å¯¹è±¡ ï¼Œ ä½¿ç”¨valueå°±ä¸æ”¯æŒ</li>
</ol>
<p>å› æ­¤ï¼Œå¦‚æœä»…éœ€è¦è·å–æŸä¸ªå€¼æ—¶å¯ä»¥ä½¿ç”¨@Value</p>
<p>å¦‚æœç¼–å†™äº†ä¸€ä¸ª<strong>JavaBeanæ¥å’Œé…ç½®æ–‡ä»¶è¿›è¡Œä¸€ä¸€æ˜ å°„</strong>ï¼Œå°±ç›´æ¥**@configurationProperties**</p>
<hr>
<h3 id="JSR303æ•°æ®æ ¡éªŒ"><a href="#JSR303æ•°æ®æ ¡éªŒ" class="headerlink" title="JSR303æ•°æ®æ ¡éªŒ"></a>JSR303æ•°æ®æ ¡éªŒ</h3><p>Springbootå¯ä»¥ç”¨**@validated**æ¥æ ¡éªŒæ•°æ®ï¼Œæ•°æ®å¼‚å¸¸ä¼šç»Ÿä¸€æŠ›å‡ºã€‚</p>
<h4 id="ç¤ºä¾‹ï¼šä½¿nameåªèƒ½ä½¿ç”¨emailæ ¼å¼"><a href="#ç¤ºä¾‹ï¼šä½¿nameåªèƒ½ä½¿ç”¨emailæ ¼å¼" class="headerlink" title="ç¤ºä¾‹ï¼šä½¿nameåªèƒ½ä½¿ç”¨emailæ ¼å¼"></a>ç¤ºä¾‹ï¼šä½¿nameåªèƒ½ä½¿ç”¨emailæ ¼å¼</h4><p>1.æ·»åŠ ä¾èµ–</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>2.æŒ‡å®šæ³¨è§£</p>
<pre><code>@Component //æ³¨å†Œbean
@ConfigurationProperties(prefix = &quot;person&quot;)
@Validated  //æ•°æ®æ ¡éªŒ
public class Person &#123;
    @Email(message=&quot;é‚®ç®±æ ¼å¼é”™è¯¯&quot;) //nameå¿…é¡»æ˜¯é‚®ç®±æ ¼å¼
    private String name;
&#125;
</code></pre>
<p>è¿è¡Œç»“æœ</p>
<p><img src="https://gitee.com/lzh_gitee/SpringBoot/raw/master/SpringBoot%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/SpringBoot04%EF%BC%9AJSR303%E6%95%B0%E6%8D%AE%E6%A0%A1%E9%AA%8C%E5%8F%8A%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%88%87%E6%8D%A2.assets/1595480159290.png" alt="1595480159290"></p>
<p><strong>ä½¿ç”¨æ•°æ®æ ¡éªŒï¼Œå¯ä»¥ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼›</strong></p>
<h4 id="å¸¸è§å‚æ•°"><a href="#å¸¸è§å‚æ•°" class="headerlink" title="å¸¸è§å‚æ•°"></a>å¸¸è§å‚æ•°</h4><pre><code>@NotNull(message=&quot;åå­—ä¸èƒ½ä¸ºç©º&quot;)
private String userName;
@Max(value=120,message=&quot;å¹´é¾„æœ€å¤§ä¸èƒ½æŸ¥è¿‡120&quot;)
private int age;
@Email(message=&quot;é‚®ç®±æ ¼å¼é”™è¯¯&quot;)
private String email;

ç©ºæ£€æŸ¥
@Null       éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ºnull
@NotNull    éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ä¸ºnull, æ— æ³•æŸ¥æ£€é•¿åº¦ä¸º0çš„å­—ç¬¦ä¸²
@NotBlank   æ£€æŸ¥çº¦æŸå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯Nullè¿˜æœ‰è¢«Trimçš„é•¿åº¦æ˜¯å¦å¤§äº0,åªå¯¹å­—ç¬¦ä¸²,ä¸”ä¼šå»æ‰å‰åç©ºæ ¼.
@NotEmpty   æ£€æŸ¥çº¦æŸå…ƒç´ æ˜¯å¦ä¸ºNULLæˆ–è€…æ˜¯EMPTY.
    
Booelanæ£€æŸ¥
@AssertTrue     éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º true  
@AssertFalse    éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º false  
    
é•¿åº¦æ£€æŸ¥
@Size(min=, max=) éªŒè¯å¯¹è±¡ï¼ˆArray,Collection,Map,Stringï¼‰é•¿åº¦æ˜¯å¦åœ¨ç»™å®šçš„èŒƒå›´ä¹‹å†…  
@Length(min=, max=) string is between min and max included.

æ—¥æœŸæ£€æŸ¥
@Past       éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å‰  
@Future     éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å  
@Pattern    éªŒè¯ String å¯¹è±¡æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™

.......ç­‰ç­‰
é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ä¸€äº›æ•°æ®æ ¡éªŒè§„åˆ™
</code></pre>
<p><img src="https://gitee.com/lzh_gitee/SpringBoot/raw/master/SpringBoot%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/SpringBoot04%EF%BC%9AJSR303%E6%95%B0%E6%8D%AE%E6%A0%A1%E9%AA%8C%E5%8F%8A%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%88%87%E6%8D%A2.assets/1595480813196.png" alt="1595480813196"></p>
<h3 id="å¤šç¯å¢ƒåˆ‡æ¢"><a href="#å¤šç¯å¢ƒåˆ‡æ¢" class="headerlink" title="å¤šç¯å¢ƒåˆ‡æ¢"></a>å¤šç¯å¢ƒåˆ‡æ¢</h3><p>profileæ˜¯Springå¯¹ä¸åŒç¯å¢ƒæä¾›ä¸åŒé…ç½®åŠŸèƒ½çš„æ”¯æŒï¼Œå¯ä»¥é€šè¿‡æ¿€æ´»ä¸åŒçš„ç¯å¢ƒç‰ˆæœ¬å¿«é€Ÿåˆ‡æ¢ç¯å¢ƒã€‚</p>
<p>å¯ä»¥é€šè¿‡ç¼–å†™ä¸åŒåçš„ä¸»é…ç½®æ–‡ä»¶æ¥æŒ‡å®šå¤šä¸ªç¯å¢ƒç‰ˆæœ¬</p>
<p>æ¯”å¦‚ï¼šapplication-test.properties æµ‹è¯•ç¯å¢ƒ -dev å¼€å‘ç¯å¢ƒé…ç½®</p>
<p>è¿˜éœ€è¦é…ç½®é€‰æ‹©æ¿€æ´»çš„ç¯å¢ƒ</p>
<pre><code>#æ¯”å¦‚åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šä½¿ç”¨devç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„ç«¯å£å·è¿›è¡Œæµ‹è¯•ï¼›
#æˆ‘ä»¬å¯åŠ¨SpringBootï¼Œå°±å¯ä»¥çœ‹åˆ°å·²ç»åˆ‡æ¢åˆ°devä¸‹çš„é…ç½®äº†ï¼›
spring.profiles.active=dev
</code></pre>
<h4 id="ä½¿ç”¨yamlé…ç½®"><a href="#ä½¿ç”¨yamlé…ç½®" class="headerlink" title="ä½¿ç”¨yamlé…ç½®"></a>ä½¿ç”¨yamlé…ç½®</h4><pre><code>server:
  port: 8081
#é€‰æ‹©è¦æ¿€æ´»é‚£ä¸ªç¯å¢ƒå—
spring:
  profiles:
    active: test

---
server:
  port: 8083
spring:
  profiles: dev #é…ç½®ç¯å¢ƒçš„åç§°
---
server:
  port: 8084
spring:
  profiles: test 
</code></pre>
<p>å¦‚æœYamlå’ŒPropertieséƒ½é…ç½®äº†ç«¯å£ï¼Œæ²¡æœ‰æ¿€æ´»å…¶ä»–ç¯å¢ƒï¼Œé»˜è®¤ä¼šä½¿ç”¨properties</p>
<h4 id="é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®"><a href="#é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®" class="headerlink" title="é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®"></a>é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®</h4><p>é…ç½®æ–‡ä»¶å¯ä»¥æ”¾åœ¨å¤šä¸ªä½ç½®ã€‚å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/lzh_gitee/SpringBoot/raw/master/SpringBoot%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/SpringBoot04%EF%BC%9AJSR303%E6%95%B0%E6%8D%AE%E6%A0%A1%E9%AA%8C%E5%8F%8A%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%88%87%E6%8D%A2.assets/1595482583892.png" alt="1595482583892"></p>
<p>ä¼˜å…ˆçº§ï¼šé¡¹ç›®è·¯å¾„ä¸‹çš„config &lt; é¡¹ç›®è·¯å¾„ä¸‹é…ç½®æ–‡ä»¶ &lt; èµ„æºè·¯å¾„ä¸‹çš„configæ–‡ä»¶å¤¹é…ç½®æ–‡ä»¶ &lt; èµ„æºè·¯å¾„ä¸‹é…ç½®æ–‡ä»¶</p>
<p>é…ç½®å¯ä»¥äº’è¡¥</p>
<h3 id="è‡ªåŠ¨è£…é…åŸç†"><a href="#è‡ªåŠ¨è£…é…åŸç†" class="headerlink" title="è‡ªåŠ¨è£…é…åŸç†"></a>è‡ªåŠ¨è£…é…åŸç†</h3><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><ol>
<li><p>Springbootå¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»ï¼Œå¼€å¯äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½@EnableAutoConfiguration</p>
</li>
<li><p>@EnableAutoConfigurationä½œç”¨</p>
<ul>
<li><p>åˆ©ç”¨EnableAutoConfigurationImportSelector qç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€äº›ç»„ä»¶</p>
</li>
<li><p>selectImports()æ–¹æ³•è¿”å›äº†ä¸€ä¸ªautoConfigurationEnty,æ¥è‡ª</p>
<pre><code>this.getAutoConfigurationEntry(autoConfigurationMetadata,annotationMetadata)
</code></pre>
</li>
</ul>
</li>
</ol>
<p>åœ¨è¯¥æ–¹æ³•ä¸­ï¼š</p>
<pre><code>List&lt;String&gt; configurations = this.getCandidateConfigurations(annotationMetadata, attributes);
</code></pre>
<p>ç¿»è¯‘è¿‡æ¥ä¸ºè·å–å€™é€‰é…ç½®</p>
<pre><code>protected List&lt;String&gt; getCandidateConfigurations(AnnotationMetadata metadata, AnnotationAttributes attributes) &#123;
    List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(this.getSpringFactoriesLoaderFactoryClass(), this.getBeanClassLoader());
 Assert.notEmpty(configurations, &quot;No auto configuration classes found in META-INF/spring.factories. â€¦â€¦&quot;);
    return configurations;
&#125;
</code></pre>
<ul>
<li>æ‰«ææ‰€æœ‰jaråŒ…ç±»è·¯å¾„ä¸‹META-INF&#x2F;spring.properties</li>
<li>æ‰«æåˆ°çš„æ–‡ä»¶çš„å†…å®¹åŒ…è£…æˆpropertieså¯¹è±¡</li>
<li>ä»propertiesä¸­è·å–åˆ°EnableAutoConfiguration.classç±»å¯¹åº”çš„å€¼ï¼Œç„¶åå°†ä»–ä»¬æ·»åŠ åœ¨å®¹å™¨ä¸­ã€‚</li>
</ul>
<p>ä»¥ä¸‹ä¸º@HttpEncodingAutoConfigurationéƒ¨åˆ†æºç åˆ†æ</p>
<pre><code>//è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œç±»æ¯”ä»¥å‰ç¼–å†™çš„é…ç½®æ–‡ä»¶
@Configuration(
        proxyBeanMethods = false
)
//å¯åŠ¨æŒ‡å®šç±»çš„ConfigurationPropertiesåŠŸèƒ½   --EnablexxxxåŸºæœ¬å°±å¹²è¿™ä¸ªçš„
@EnableConfigurationProperties(&#123;ServerProperties.class&#125;)
//Springåº•å±‚æ³¨è§£@Conditionalæ³¨è§£ï¼Œæ ¹æ®ä¸åŒæ¡ä»¶åˆ¤æ–­ï¼Œæ»¡è¶³åˆ™æ•´ä¸ªé…ç½®ç±»ä¸­çš„é…ç½®å°±ç”Ÿæ•ˆ
//æ˜¯å¦æ˜¯webåº”ç”¨ï¼Œæ˜¯å°±ç”Ÿæ•ˆ
@ConditionalOnWebApplication(
        type = ConditionalOnWebApplication.Type.SERVLET
)
//å½“å‰é¡¹ç›®ä¸­æœ‰æ²¡æœ‰ä¸‹é¢è¿™ä¸ªç±» â€”â€”å°±æ˜¯ä¹‹å‰SpringMVCä¸­è¿›è¡Œä¹±ç è§£å†³çš„è¿‡æ»¤å™¨
@ConditionalOnClass(&#123;CharacterEncodingFilter.class&#125;)
//åˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé…ç½® æ‹¼æ¥çš„server.servlet.encoding.enabled è¯¥é…ç½®é»˜è®¤ç”Ÿæ•ˆ
@ConditionalOnProperty(
        prefix = &quot;server.servlet.encoding&quot;,
        value = &#123;&quot;enabled&quot;&#125;,
        matchIfMissing = true
)
public class HttpEncodingAutoConfiguration &#123;
    //å’ŒSpringbootçš„é…ç½®æ–‡ä»¶å·²æ˜ å°„
    private final Encoding properties;

    public HttpEncodingAutoConfiguration(ServerProperties properties) &#123;
        this.properties = properties.getServlet().getEncoding();
    &#125;

    @Bean //ç»™å®¹å™¨æ·»åŠ ä¸€ä¸ªç»„ä»¶ï¼Œç»„ä»¶çš„éƒ¨åˆ†å€¼ä»propertiesè·å–
    @ConditionalOnMissingBean //åˆ¤æ–­å®¹å™¨æ²¡æœ‰è¯¥ç»„ä»¶ ä¿è¯äº†è¿™ä¸ªbeanä»…æœ‰ä¸€ä¸ª
    public CharacterEncodingFilter characterEncodingFilter() &#123;
        CharacterEncodingFilter filter = new OrderedCharacterEncodingFilter();
        filter.setEncoding(this.properties.getCharset().name());
        filter.setForceRequestEncoding(this.properties.shouldForce(org.springframework.boot.web.servlet.server.Encoding.Type.REQUEST));
        filter.setForceResponseEncoding(this.properties.shouldForce(org.springframework.boot.web.servlet.server.Encoding.Type.RESPONSE));
        return filter;
    &#125;
</code></pre>
<p><strong>ä¸€å¥è¯æ€»ç»“ ï¼šæ ¹æ®å½“å‰ä¸åŒçš„æ¡ä»¶åˆ¤æ–­ï¼Œå†³å®šè¿™ä¸ªé…ç½®ç±»æ˜¯å¦ç”Ÿæ•ˆï¼</strong></p>
<ul>
<li>ä¸€ä½†è¿™ä¸ªé…ç½®ç±»ç”Ÿæ•ˆï¼›è¿™ä¸ªé…ç½®ç±»å°±ä¼šç»™å®¹å™¨ä¸­æ·»åŠ å„ç§ç»„ä»¶ï¼›</li>
<li>è¿™äº›ç»„ä»¶çš„å±æ€§æ˜¯ä»å¯¹åº”çš„propertiesç±»ä¸­è·å–çš„ï¼Œè¿™äº›ç±»é‡Œé¢çš„æ¯ä¸€ä¸ªå±æ€§åˆæ˜¯å’Œé…ç½®æ–‡ä»¶ç»‘å®šçš„ï¼›</li>
<li>æ‰€æœ‰åœ¨é…ç½®æ–‡ä»¶ä¸­èƒ½é…ç½®çš„å±æ€§éƒ½æ˜¯åœ¨xxxxPropertiesç±»ä¸­å°è£…ç€ï¼›</li>
<li>é…ç½®æ–‡ä»¶èƒ½é…ç½®ä»€ä¹ˆå°±å¯ä»¥å‚ç…§æŸä¸ªåŠŸèƒ½å¯¹åº”çš„è¿™ä¸ªå±æ€§ç±»</li>
</ul>
<p>è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆå¿…é¡»åœ¨ä¸€å®šæ¡ä»¶ä¸‹ã€‚</p>
<table>
<thead>
<tr>
<th>@Conditionalæ‰©å±•æ³¨è§£</th>
<th>ä½œç”¨(åˆ¤æ–­æ˜¯å¦æ»¡è¶³å½“å‰æŒ‡å®šæ¡ä»¶)</th>
</tr>
</thead>
<tbody><tr>
<td>@ConditionalOnJava</td>
<td>ç³»ç»Ÿçš„javaç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚</td>
</tr>
<tr>
<td>@ConditionalOnBean</td>
<td>å®¹å™¨ä¸­å­˜åœ¨æŒ‡å®šBean ;</td>
</tr>
<tr>
<td>@ConditionalOnMissingBean</td>
<td>å®¹å™¨ä¸­ä¸å­˜åœ¨æŒ‡å®šBean ;</td>
</tr>
<tr>
<td>@ConditionalOnExpression</td>
<td>æ»¡è¶³SpELè¡¨è¾¾å¼æŒ‡å®š</td>
</tr>
<tr>
<td>@ConditionalOnClass</td>
<td>ç³»ç»Ÿä¸­æœ‰æŒ‡å®šçš„ç±»</td>
</tr>
<tr>
<td>@ConditionalOnMissingClass</td>
<td>ç³»ç»Ÿä¸­æ²¡æœ‰æŒ‡å®šçš„ç±»</td>
</tr>
<tr>
<td>@ConditionalOnSingleCandidate</td>
<td>å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªæŒ‡å®šçš„Bean ,æˆ–è€…è¿™ä¸ªBeanæ˜¯é¦–é€‰Bean</td>
</tr>
<tr>
<td>@ConditionalOnProperty</td>
<td>ç³»ç»Ÿä¸­æŒ‡å®šçš„å±æ€§æ˜¯å¦æœ‰æŒ‡å®šçš„å€¼</td>
</tr>
<tr>
<td>@ConditionalOnResource</td>
<td>ç±»è·¯å¾„ä¸‹æ˜¯å¦å­˜åœ¨æŒ‡å®šèµ„æºæ–‡ä»¶</td>
</tr>
<tr>
<td>@ConditionalOnWebApplication</td>
<td>å½“å‰æ˜¯webç¯å¢ƒ</td>
</tr>
<tr>
<td>@ConditionalOnNotWebApplication</td>
<td>å½“å‰ä¸æ˜¯webç¯å¢ƒ</td>
</tr>
<tr>
<td>@ConditionalOnJndi</td>
<td>JNDIå­˜åœ¨æŒ‡å®šé¡¹</td>
</tr>
</tbody></table>
<p>é€šè¿‡åœ¨yamlä¸­è®¾ç½®dubug&#x3D;trueå¯ä»¥é€šè¿‡æ‰“å°çŸ¥é“å“ªäº›è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆã€‚</p>
<p>é¦–é¡µé…ç½®ï¼šæ³¨æ„ï¼Œæ‰€æœ‰çš„é™æ€èµ„æºéƒ½æ˜¯ç”±thymeleafå¼•æ“æ¥ç®¡; @{} #{}â€¦..</p>
<p>å›½é™…åŒ–é…ç½®ï¼š</p>
<ol>
<li>éœ€è¦é…ç½®i18næ–‡ä»¶</li>
<li>å¦‚æœéœ€è¦åœ¨é¡¹ç›®ä¸­è¿›è¡ŒæŒ‰é’®è‡ªåŠ¨åˆ‡æ¢ï¼Œéœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªç»„ä»¶LocaleResolver</li>
<li>è®°å¾—å°†è‡ªå·±å†™çš„ç»„ä»¶é…ç½®åˆ°Springå®¹å™¨ä¸­</li>
</ol>
<p>æŠŠlçœ‹æˆäº†1</p>
<p>å¤ä¹ HttpServletRequest</p>
<h3 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h3><h4 id="å‰åç«¯åˆ†ç¦»"><a href="#å‰åç«¯åˆ†ç¦»" class="headerlink" title="å‰åç«¯åˆ†ç¦»"></a>å‰åç«¯åˆ†ç¦»</h4><ul>
<li>å‰ç«¯â€“å‰ç«¯æ§åˆ¶å±‚ã€è§†å›¾å±‚</li>
<li>ä¼ªé€ åç«¯æ•°æ®ï¼Œjsonï¼Œä¸éœ€è¦åç«¯å‰ç«¯æ•´ä¸ªé¡¹ç›®ä¾æ—§å¯ä»¥è·‘</li>
<li>åç«¯â€“ æ§åˆ¶å±‚ã€æœåŠ¡å±‚ã€æ•°æ®è®¿é—®å±‚</li>
<li>å‰åç«¯é€šè¿‡APIè¿›è¡Œäº¤äº’ï¼Œç›¸å¯¹ç‹¬ç«‹ä¸”æ¾è€¦åˆ</li>
</ul>
<p>ç”±æ­¤äº§ç”Ÿäº†æ–°çš„é—®é¢˜ï¼šå‰åç«¯é›†æˆè”è°ƒï¼Œæ— æ³•åšåˆ°â€œåŠæ—¶åå•†ï¼Œå°½æ—©è§£å†³â€</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li><p>å®šä¹‰schemaï¼Œå¹¶å®æ—¶è·Ÿè¸ªæœ€æ–°çš„APIï¼Œé™ä½é›†æˆé£é™©</p>
</li>
<li><p>å‰åç«¯åˆ†ç¦»ï¼š</p>
<ul>
<li>å‰ç«¯æµ‹è¯•åç«¯æ¥å£ï¼špostman</li>
<li>åç«¯æä¾›æ¥å£ï¼šå®æ—¶æ›´æ–°æœ€æ–°çš„æ¶ˆæ¯åŠæ”¹åŠ¨</li>
</ul>
<p>Restful APIæ–‡æ¡£åœ¨çº¿è‡ªåŠ¨ç”Ÿæˆå™¨ &#x3D;&gt; APIæ–‡æ¡£ä¸APIå®šä¹‰åŒæ­¥æ›´æ–°</p>
</li>
</ol>
<hr>
<h3 id="å‘˜å·¥ç®¡ç†ç³»ç»Ÿ"><a href="#å‘˜å·¥ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="å‘˜å·¥ç®¡ç†ç³»ç»Ÿ"></a>å‘˜å·¥ç®¡ç†ç³»ç»Ÿ</h3><p>PathVariable</p>
<p>å‰ç«¯ä¸­éšè—åŸŸçš„æ ¼å¼ï¼šhiddenï¼Ÿï¼Ÿ ä¸ºä»€ä¹ˆå¢åŠ äº†éšè—åŸŸå°±å¯ä»¥æ­£å¸¸ä¿®æ”¹äº†è€Œä¸æ˜¯</p>
<p>å¦‚æœé™æ€å¯¼å…¥åŒ…ï¼Œä¼šè¿åSpringçš„ä¸€ä¸ªåŸç†</p>
<h3 id="å¾®æœåŠ¡å…¥é—¨"><a href="#å¾®æœåŠ¡å…¥é—¨" class="headerlink" title="å¾®æœåŠ¡å…¥é—¨"></a>å¾®æœåŠ¡å…¥é—¨</h3><p>what ï¼Ÿ åˆ†å¸ƒå¼ç³»ç»Ÿ</p>
<p>åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯è‹¥å¹²ç‹¬ç«‹è®¡ç®—æœºçš„é›†åˆï¼Œè¿™äº›è®¡ç®—æœºå¯¹äºç”¨æˆ·æ¥è¯´å¦‚åŒå•ä¸ªç›¸å…³çš„ç³»ç»Ÿã€‚</p>
<p>æ˜¯ç”±ä¸€ç»„é€šè¿‡ç½‘ç»œè¿›è¡Œ<strong>é€šä¿¡</strong>ï¼Œä¸ºäº†<strong>å®Œæˆå…±åŒçš„ä»»åŠ¡</strong>è€ŒååŒå·¥ä½œçš„è®¡ç®—æœºèŠ‚ç‚¹ç»„æˆçš„ç³»ç»Ÿã€‚ç†æ‰€å½“ç„¶åœ°ï¼Œæ˜¯å»ºç«‹åœ¨ç½‘ç»œä¸Šçš„ã€‚</p>
<p><strong>ç›®çš„</strong>æ˜¯åˆ©ç”¨æ›´å¤šçš„æœºå™¨ï¼Œå¤„ç†æ›´å¤šçš„æ•°æ®ã€‚</p>
<p>è¦æ˜ç¡®çš„æ˜¯ï¼Œçºµè§‚è®¡ç®—æœºå‘å±•å²ï¼Œè§£å†³æ—§çš„é—®é¢˜çš„åŒæ—¶ä¸€å®šä¼šå¼•å…¥æ–°çš„é—®é¢˜ã€‚</p>
<p>å› æ­¤åªæœ‰ï¼š</p>
<ul>
<li>å½“åŸå•èŠ‚ç‚¹å¤„ç†èƒ½åŠ›æ— æ³•æ»¡è¶³æ—¥ç›Šå¢é•¿çš„è®¡ç®—ã€å­˜å‚¨ä»»åŠ¡</li>
<li>ä¸”åŒæ—¶ç¡¬ä»¶æˆæœ¬è¿‡é«˜</li>
<li>åº”ç”¨ç¨‹åºæ— æ³•å†ä¼˜åŒ–</li>
</ul>
<p>æ‰éœ€è¦è€ƒè™‘åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ å› ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿå¤šèŠ‚ç‚¹ï¼Œæ˜¯é€šè¿‡ç½‘ç»œé€šä¿¡çš„æ‹“æ‰‘ç»“æ„ã€‚ç½‘ç»œå¹¶ä¸å¯é ã€‚</p>
<h4 id="Dubboæ–‡æ¡£"><a href="#Dubboæ–‡æ¡£" class="headerlink" title="Dubboæ–‡æ¡£"></a>Dubboæ–‡æ¡£</h4><p><img src="https://gitee.com/lzh_gitee/springboot_image/raw/master/img/dubbo-architecture-roadmap.jpg" alt="img"></p>
<p>åœ¨åˆ†å¸ƒå¼æœåŠ¡æ¶æ„ä¸­ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨ä»¥åŠæ•´åˆçš„<strong>åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ï¼ˆRPCï¼‰</strong>æ˜¯å…³é”®</p>
<p><img src="https://gitee.com/lzh_gitee/springboot_image/raw/master/img/image-20200801133710784.png" alt="image-20200801133710784"></p>
<p>what?RPC</p>
<p>æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œä¹Ÿæ˜¯ä¸€ç§æŠ€æœ¯çš„æ€æƒ³ï¼Œè€Œä¸æ˜¯è§„èŒƒã€‚</p>
<p>å®ƒå…è®¸ç¨‹åºè°ƒç”¨å¦ä¸€åœ°å€ç©ºé—´ï¼ˆé€šå¸¸æ˜¯å…±äº«ç½‘ç»œä¸Šçš„ï¼‰çš„è¿‡ç¨‹æˆ–å‡½æ•°ï¼Œè€Œä¸æ˜¯ç¨‹åºå‘˜æ˜¾å¼ç¼–ç è¯¥è¿œç¨‹è°ƒç”¨çš„ç»†èŠ‚ã€‚å³ä¸ç®¡æ˜¯è°ƒç”¨æœ¬åœ°è¿˜æ˜¯è°ƒç”¨è¿œç¨‹ï¼Œæœ¬è´¨ä¸Šç¼–å†™çš„ä»£ç åŸºæœ¬ç›¸åŒã€‚ï¼ˆå¦‚åé¢è¦ä½¿ç”¨åˆ°çš„TicketServiceæ¥å£ï¼‰</p>
<p><strong>RPCè¦è§£å†³çš„ä¸¤ä¸ªé—®é¢˜ï¼š</strong></p>
<ol>
<li>è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒæœåŠ¡ä¹‹é—´çš„è°ƒç”¨é—®é¢˜ã€‚</li>
<li>è¿œç¨‹è°ƒç”¨æ—¶ï¼Œè¦èƒ½å¤Ÿåƒæœ¬åœ°è°ƒç”¨ä¸€æ ·æ–¹ä¾¿ï¼Œè®©è°ƒç”¨è€…æ„ŸçŸ¥ä¸åˆ°è¿œç¨‹è°ƒç”¨çš„é€»è¾‘ã€‚</li>
</ol>
<p>RPCä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼šé€šè®¯ï¼Œåºåˆ—åŒ–ã€‚</p>
<p><img src="https://gitee.com/lzh_gitee/springboot_image/raw/master/img/image-20200801134657756.png" alt="image-20200801134657756"></p>
<hr>
<p>æµ‹è¯•ç¯å¢ƒæ­å»º</p>
<p>Dubboæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼šé¢å‘æ¥å£çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæ™ºèƒ½å®¹é”™å’Œè´Ÿè½½å‡è¡¡ï¼Œä»¥åŠæœåŠ¡è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°ã€‚</p>
<p><img src="https://gitee.com/lzh_gitee/springboot_image/raw/master/img/architecture.png" alt="img"></p>
<p>Provider:æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ï¼ŒæœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</p>
<p>Consumerï¼šè°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ï¼ŒæœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­åŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥å†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</p>
<p>Registry:æ³¨å†Œä¸­å¿ƒï¼Œè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚</p>
<p>Monitor:æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</p>
<p>è°ƒç”¨å…³ç³»è¯´æ˜ï¼š</p>
<ul>
<li>æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</li>
<li>æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</li>
<li>æ³¨å†Œä¸­å¿ƒè¿”å›</li>
<li>æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</li>
</ul>
<h4 id="Dubboç¯å¢ƒæ­å»º"><a href="#Dubboç¯å¢ƒæ­å»º" class="headerlink" title="Dubboç¯å¢ƒæ­å»º"></a>Dubboç¯å¢ƒæ­å»º</h4><p>dubboæ¨èä½¿ç”¨zookeeperæ³¨å†Œä¸­å¿ƒ</p>
<p>Zookeeperä¸‹è½½ï¼š<a href="https://gitee.com/link?target=http://archive.apache.org/dist/zookeeper/zookeeper-3.6.1/">http://archive.apache.org/dist/zookeeper/zookeeper-3.6.1/</a> å¤ªæ…¢</p>
<p><a href="https://gitee.com/link?target=https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/">https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/</a></p>
<ol>
<li>è€Œåè§£å‹ï¼Œè¿è¡ŒzkServer.cmd(å¼€å¯zookeeperæœåŠ¡)</li>
<li>å¯èƒ½ä¼šé—ªé€€ï¼š â€“è§£å†³ï¼šç¼–è¾‘zkServer.cmdæ–‡ä»¶æœ«å°¾åœ¨å€’æ•°ç¬¬äºŒè¡Œæ·»åŠ pauseï¼Œå‡ºé”™å°±ä¸ä¼šé€€å‡ºè€Œä¼šæç¤ºå‡ºé”™ä¿¡æ¯ã€‚</li>
<li>ä¿®æ”¹zoo.cfgé…åˆæ–‡ä»¶ï¼š</li>
</ol>
<ul>
<li>å¼€å§‹æ²¡æœ‰è¿™ä¸ªä¸œè¥¿è¦å¤åˆ¶zoo_sample.cfgæ”¹å</li>
<li>æ³¨æ„å‡ ä¸ªä½ç½®ï¼š</li>
</ul>
<p>dataDir &#x3D; .&#x2F;ä¸´æ—¶æ•°æ®å­˜å‚¨çš„ç›®å½•ï¼ˆå¯å†™ç›¸å¯¹è·¯å¾„ï¼‰</p>
<p>clientPort&#x3D;2181 zookeeperçš„ç«¯å£å·</p>
<ul>
<li>ä¿®æ”¹åå†æ¬¡å¯åŠ¨zookeeper</li>
</ul>
<p>é‡åˆ°äº†å‡ ä¸ªé—®é¢˜ï¼Œ å…¶ä¸­Zookeeperå¦‚æœæŠ¥äº†Zookeeper audit is disabledå¯å»confæ–‡ä»¶å¤¹ä¸‹å°†å…¶é…ç½®æ–‡ä»¶zoo.cfgæ·»åŠ ä¸€è¡Œaudit.enable&#x3D;trueå³å¯ã€‚</p>
<p>4.ä½¿ç”¨zkCli.cmdæµ‹è¯•:</p>
<p>ls &#x2F; åˆ—å‡ºzookeeperæ ¹ä¸‹ä¿å­˜çš„æ‰€æœ‰èŠ‚ç‚¹</p>
<p>create-e &#x2F;fan 123 :åˆ›å»ºä¸€ä¸ª&#x2F;fanèŠ‚ç‚¹ å€¼ä¸º123</p>
<p>get &#x2F;fan è·å–&#x2F;fanèŠ‚ç‚¹çš„å€¼</p>
<h4 id="å®‰è£…dubbo-admin"><a href="#å®‰è£…dubbo-admin" class="headerlink" title="å®‰è£…dubbo-admin"></a>å®‰è£…dubbo-admin</h4><p>dubboæœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæœåŠ¡è½¯ä»¶ã€‚è€Œæ˜¯ä¸€ä¸ªjaråŒ…ï¼Œå¯ä»¥å¸®åŠ©javaç¨‹åºè¿æ¥åˆ°zookeeper,å¹¶åˆ©ç”¨zookeeperæ¶ˆè´¹ã€æä¾›æœåŠ¡ã€‚</p>
<p>dubbo-adminæ˜¯ä¸€ä¸ªå¯è§†åŒ–çš„ç›‘æ§ç¨‹åºï¼Œèƒ½å¤Ÿç®¡ç†ç›‘æ§ä¼—å¤šçš„dubboæœåŠ¡ã€‚</p>
<p>1.<strong>ä¸‹è½½</strong></p>
<p>åœ°å€ ï¼š<a href="https://gitee.com/link?target=https://github.com/apache/dubbo-admin/tree/master">https://github.com/apache/dubbo-admin/tree/master</a></p>
<p>2.<strong>è§£å‹è¿›å…¥ç›®å½•</strong></p>
<p>ä¿®æ”¹dubbo-admin çš„application.properties æŒ‡å®šzookeeperåœ°å€ï¼š</p>
<pre><code>server.port=7001
spring.velocity.cache=false
spring.velocity.charset=UTF-8
spring.velocity.layout-url=/templates/default.vm
spring.messages.fallback-to-system-locale=false
spring.messages.basename=i18n/message
spring.root.password=root
spring.guest.password=guest
dubbo.registry.address=zookeeper://127.0.0.1:2181
</code></pre>
<p>3.åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰“åŒ…dubbo-admin</p>
<pre><code>mvn clean package -Dmaven.test.skip=true
</code></pre>
<p>è¿è¡Œè¯¥å‘½ä»¤æ—¶æ˜¾ç¤ºmvnæ‰¾ä¸åˆ°,åŸå› æ˜¯æ²¡æœ‰åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®mavenï¼Œåœ¨ç³»ç»Ÿå˜é‡ä¸­é…ç½®Pathï¼Œæ–°åŠ ä¸€æ¡</p>
<p>å†æ·»åŠ ä¸€æ¡MAVEN_HOME:D:\IntelliJ IDEA 2019.3.5\plugins\maven\lib\maven3\bin</p>
<p>å°±æ˜¯mavençš„åœ°å€ã€‚</p>
<p>4.æ‰§è¡Œdubbo-admin\targetä¸‹çš„dubbo-admin-0.0.1-SNAPSHOT.jar</p>
<pre><code>java -jar dubbo-admin-0.0.1-SNAPSHOT.jar
</code></pre>
<p>æ­¤è¿‡ç¨‹ä¸­zookeeperçš„æœåŠ¡ä¸€å®šè¦æ‰“å¼€</p>
<p>æ‰§è¡Œå®Œæ¯•åå»è®¿é—®localhost:7001,é»˜è®¤è´¦å·å’Œå¯†ç éƒ½æ˜¯root</p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<ul>
<li>zookeeperæ³¨å†Œä¸­å¿ƒ</li>
<li>dubbo-admin:æ˜¯ä¸€ä¸ªç›‘æ§ç®¡ç†åå°ï¼ŒæŸ¥çœ‹æ³¨å†Œäº†å“ªäº›æœåŠ¡ï¼Œå“ªäº›æœåŠ¡è¢«æ¶ˆè´¹äº†ã€‚</li>
<li>dubbo:jaråŒ…</li>
</ul>
<h4 id="æ•´åˆSpringboot"><a href="#æ•´åˆSpringboot" class="headerlink" title="æ•´åˆSpringboot"></a>æ•´åˆSpringboot</h4><p>æ³¨æ„å¯¼åŒ…é—®é¢˜ï¼Œå°¤å…¶æ˜¯åŒç±»å åŒæ³¨è§£å</p>
<p><strong>æ¡†æ¶æ­å»ºï¼š</strong></p>
<ol>
<li>å¯åŠ¨zookeeper</li>
<li>IDEAåˆ›å»ºä¸€ä¸ªé¡¹ç›®</li>
<li>åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼šprovider-server é€‰æ‹©webä¾èµ–å³å¯</li>
<li>å†™ä¸€ä¸ªæœåŠ¡</li>
</ol>
<hr>
<p>ç¼–å†™æ¥å£</p>
<pre><code>package com.fan.service;
public interface TicketService &#123;
    public String getTicket();
&#125;
</code></pre>
<p>ç¼–å†™å®ç°ç±»</p>
<pre><code>package com.fan.service;

public class TicketServiceImpl implements TicketService &#123;
    @Override
    public String getTicket() &#123;
        return &quot;ä¹°åˆ°ä»Šå¤©çš„ç¥¨äº†&quot;;
    &#125;
&#125;
</code></pre>
<p>5.åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼Œå®ç°consumer-server</p>
<p>6.é¡¹ç›®åˆ›å»ºå®Œæ¯•ï¼Œå†™ä¸€ä¸ªæœåŠ¡ã€‚</p>
<p>éœ€è¦å»æ³¨å†Œä¸­å¿ƒä¸­æ‹¿æœåŠ¡ã€‚</p>
<h5 id="æœåŠ¡æä¾›è€…"><a href="#æœåŠ¡æä¾›è€…" class="headerlink" title="æœåŠ¡æä¾›è€…"></a>æœåŠ¡æä¾›è€…</h5><p>1.å°†æœåŠ¡æä¾›è€…æ³¨å†Œè‡³æ³¨å†Œä¸­å¿ƒï¼Œå¯¼åŒ…ã€‚ dubboçš„ä¾èµ–</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;
    &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;2.7.3&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>zookeeperçš„åŒ…åœ¨mavenä»“åº“ä¸‹è½½ zkclient</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt;
    &lt;artifactId&gt;zkclient&lt;/artifactId&gt;
    &lt;version&gt;0.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>è¯¥ä¾èµ–ä¸æ—¥å¿—å­˜åœ¨ä¾èµ–å†²çªï¼Œéœ€è¦é™¤å»</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;
    &lt;artifactId&gt;curator-framework&lt;/artifactId&gt;
    &lt;version&gt;2.12.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;
    &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt;
    &lt;version&gt;2.12.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;
    &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;
    &lt;version&gt;3.4.14&lt;/version&gt;
    &lt;!--æ’é™¤è¿™ä¸ªslf4j-log4j12 è§£å†³æ—¥å¿—å†²çª--&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
</code></pre>
<p>2.åœ¨springbooté…ç½®æ–‡ä»¶ä¸­é…ç½®dubboç›¸å…³å±æ€§</p>
<pre><code>server.port=8081
#å½“å‰åº”ç”¨åå­—
dubbo.application.name=provider-server-demo
#æ³¨å†Œä¸­å¿ƒåœ°å€ -- åœ¨zookeeperé…ç½®æ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°
dubbo.registry.address=zookeeper://127.0.0.1:2181
#æ‰«ææŒ‡å®šåŒ…ä¸‹æœåŠ¡
dubbo.scan.base-packages=com.fan.service
</code></pre>
<p>3.åœ¨serviceçš„å®ç°ç±»ä¸­é…ç½®æœåŠ¡æ³¨è§£ï¼Œå‘å¸ƒæœåŠ¡ã€‚**!!!!æ³¨æ„å¯¼åŒ…é—®é¢˜**</p>
<pre><code>package com.fan.service;

import org.apache.dubbo.config.annotation.Service;
import org.springframework.stereotype.Component;
@Service   //å¯ä»¥è¢«æ‰«æåˆ°ï¼Œåœ¨é¡¹ç›®ä¸€å¯åŠ¨å°±è‡ªåŠ¨æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ
@Component   //ä½¿ç”¨Dubboåå°½é‡ä¸è¦ç”¨@Serviceæ³¨è§£
public class TicketServiceImpl implements TicketService &#123;
    @Override
    public String getTicket() &#123;
        return &quot;ä¹°åˆ°ä»Šå¤©çš„ç¥¨äº†&quot;;
    &#125;
&#125;
</code></pre>
<p>åº”ç”¨å¯åŠ¨ï¼Œdubboå°±ä¼šæ‰«ææŒ‡å®šçš„åŒ…ä¸‹å¸¦æœ‰@Componentæ³¨è§£çš„æœåŠ¡ï¼Œå°†å…¶å‘å¸ƒåˆ°æŒ‡å®šçš„æ³¨å†Œä¸­å¿ƒ</p>
<p>å¯åŠ¨ååœ¨dubboçš„æ³¨å†Œä¸­å¿ƒ localhost:7701ä¸­å¯ä»¥çœ‹åˆ°</p>
<p><img src="https://gitee.com/lzh_gitee/springboot_image/raw/master/img/image-20200801205620564.png" alt="image-20200801205620564"></p>
<p><img src="https://gitee.com/lzh_gitee/springboot_image/raw/master/img/image-20200801205708690.png" alt="image-20200801205708690"></p>
<h5 id="æœåŠ¡æ¶ˆè´¹è€…"><a href="#æœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="æœåŠ¡æ¶ˆè´¹è€…"></a>æœåŠ¡æ¶ˆè´¹è€…</h5><p>1.å¯¼å…¥ä¾èµ–</p>
<pre><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;

    &lt;!--dubbo--&gt;
    &lt;!-- Dubbo Spring Boot Starter --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;
        &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;
        &lt;version&gt;2.7.3&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!--zookeeper--&gt;
    &lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt;
        &lt;artifactId&gt;zkclient&lt;/artifactId&gt;
        &lt;version&gt;0.1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- å¼•å…¥zookeeper --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;
        &lt;artifactId&gt;curator-framework&lt;/artifactId&gt;
        &lt;version&gt;2.12.0&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;
        &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt;
        &lt;version&gt;2.12.0&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;
        &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;
        &lt;version&gt;3.4.14&lt;/version&gt;
        &lt;!--æ’é™¤è¿™ä¸ªslf4j-log4j12--&gt;
        &lt;exclusions&gt;
            &lt;exclusion&gt;
                &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
                &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
            &lt;/exclusion&gt;
        &lt;/exclusions&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.fan&lt;/groupId&gt;
        &lt;artifactId&gt;provider-server-demo&lt;/artifactId&gt;
        &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
        &lt;scope&gt;compile&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
<p>2.é…ç½®applicaiton.properties</p>
<pre><code>server.port=8002
#å½“å‰åº”ç”¨åå­—
dubbo.application.name=consumer-server-demo
#æ³¨å†Œä¸­å¿ƒåœ°å€
dubbo.registry.address=zookeeper://127.0.0.1:2181
</code></pre>
<p>3.æ­£å¸¸æ­¥éª¤éœ€è¦å°†æœåŠ¡æä¾›è€…çš„æ¥å£æ‰“åŒ…ï¼Œç„¶åç”¨pomæ–‡ä»¶å¯¼å…¥ï¼Œæ­¤å¤„åˆ©ç”¨åŒååŒ…ä¿è¯è·¯å¾„æ­£ç¡®ç›´æ¥ç”¨ã€‚å°±æ˜¯åœ¨æœåŠ¡æ¶ˆè´¹è€…æ¨¡å—ä¸‹åˆ›å»ºä¸€ä¸ªå’ŒæœåŠ¡æä¾›è€…ç›¸åŒçš„TicketServiceæ¥å£ã€‚</p>
<p>4.å®Œå–„æ¶ˆè´¹è€…çš„æœåŠ¡ç±»</p>
<pre><code>package com.fan.service;

import org.apache.dubbo.config.annotation.Reference;
import org.springframework.stereotype.Service;
@Service  //æ³¨å…¥Springå®¹å™¨ä¸­
public class UserService &#123;
    //å»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡   å¦‚æ­¤æ‰å¯æ‹¿åˆ°provider-serveræä¾›çš„ç¥¨
    @Reference
    TicketService ticketService;
    public void bugTicket() &#123;
        String ticket = ticketService.getTicket();
        System.out.println(&quot;åœ¨æ³¨å†Œä¸­å¿ƒä¹°åˆ°&quot; + ticket);
    &#125;

&#125;
</code></pre>
<p>5.æµ‹è¯•ç±»ç¼–å†™</p>
<pre><code>@SpringBootTest(classes = &#123;ConsumerServerDemoApplication.class&#125;)
class ConsumerServerDemoApplicationTests &#123;
    @Autowired
    UserService userService;

    @Test
    void contextLoads() &#123;
        userService.bugTicket();
    &#125;

&#125;
</code></pre>
<p>åœ¨æ­¤å¤„è¿ç”¨æ§åˆ¶å°æŠ¥é”™æ‰¾åˆ°äº†â€œå¤šä¸ªä¸»å¯åŠ¨ç±»â€å› æ­¤åœ¨@SpringbBootTestæ³¨è§£ååˆ¶å®šäº†ä¸€ä¸‹classes</p>
<p>å¯åŠ¨æµ‹è¯•ï¼š</p>
<ol>
<li>å¼€å¯zookeeper</li>
<li>æ‰“å¼€dubbo-adminç›‘æ§ï¼ˆå¯çœå»</li>
<li>å¼€å¯æœåŠ¡è€…</li>
<li>æ¶ˆè´¹è€…æ¶ˆè´¹æµ‹è¯•</li>
</ol>
<p>æ§åˆ¶å°æ˜¾ç¤ºï¼šåœ¨æ³¨å†Œä¸­å¿ƒä¹°åˆ°ä¹°åˆ°ä»Šå¤©çš„ç¥¨äº†</p>
<p><img src="/" alt="image-20210704125640858"></p>
<p>åŒæ—¶ï¼Œç›‘æ§ä¸­å¿ƒä¼šè®°å½•åˆ°ï¼š</p>
<p><img src="https://gitee.com/lzh_gitee/springboot_image/raw/master/img/image-20200801222026747.png" alt="image-20200801222026747"></p>
<p>é—®é¢˜è®°å½•ï¼š</p>
<p>åœ¨é…ç½®springboot-dubbo-zookeeperä¸­ï¼ŒServiceä¸­**æ³¨æ„å¯¼åŒ…é—®é¢˜ ** åŒ…æ‹¬åæ¥çš„Reference</p>
<p>ä½¿ç”¨dubboå°±å°½é‡ä¸è¦ç”¨@Serviceæ³¨è§£å®¹æ˜“æ··æ·†ï¼ŒåŒæ—¶Controllerå±‚æ³¨å…¥å¯¹åº”Serviceæ—¶ä¸è¦ç”¨@Autowiredè€Œæ˜¯ç”¨@Reference</p>
<pre><code>@SpringBootTest(classes = &#123;ConsumerServerDemoApplication.class&#125;) //ç»™æµ‹è¯•ç±»æŒ‡å®šä¸»å¯åŠ¨ç±»
</code></pre>
<hr>
<h3 id="æ³¨è§£ä»¬"><a href="#æ³¨è§£ä»¬" class="headerlink" title="æ³¨è§£ä»¬"></a>æ³¨è§£ä»¬</h3><p><strong>åŸºç¡€æ³¨è§£</strong></p>
<p><code>@ConditionalOnBean</code>æ˜¯ä¾èµ–,<code>@ConditionalOnMissBean</code>æ˜¯æ’æ–¥,<code>@Conditional</code>ä¸ºæ¡ä»¶</p>
<p>@Configuration å°±æ˜¯é…ç½®æ–‡ä»¶çš„ä½œç”¨ï¼Œæ³¨æ„é…ç½®ç±»ä¸‹ç»„ä»¶é»˜è®¤æ˜¯å•å®ä¾‹å¯¹è±¡</p>
<p>@Configuration(proxyBean&#x3D;true)ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•ã€‚Springbootä¼šæ£€æŸ¥è¯¥ç»„ä»¶æ˜¯ä¸æ˜¯åœ¨å®¹å™¨ä¸­ï¼Œæ€»æ˜¯ä½¿å…¶æ˜¯å•å®ä¾‹çš„ã€‚</p>
<p>Fullæ¨¡å¼å’ŒLiteæ¨¡å¼</p>
<p>@Import ç»™å®¹å™¨ä¸­å¯¼å…¥ç»„ä»¶ï¼Œé»˜è®¤ç»„ä»¶åå°±æ˜¯å…¨ç±»å</p>
<p><strong>Web</strong></p>
<ul>
<li>@RequestAttributeæ³¨è§£çš„å‚æ•°åœ¨é¡¹ç›®é‡Œæ˜¯è‡ªå·±è§£æå‡ºæ¥çš„ï¼Œå¹¶ä¸æ˜¯å‰ç«¯ä¼ é€’çš„ã€‚å…·ä½“ä¸€ç‚¹ï¼Œåœ¨é¡¹ç›®é‡Œçš„æ‹¦æˆªå™¨é‡Œä¼šå¯¹<strong>Tokenä¿¡æ¯è¿›è¡Œè§£æï¼Œè§£æå‡ºæ¥çš„å‚æ•°é‡æ–°æ”¾åœ¨è¯·æ±‚é‡Œ</strong>ï¼ˆç”¨httpServletRequest.setAttribute(name, value)ï¼‰ï¼Œåè¾¹æ¥å£æ¥æ”¶å‚æ•°æ—¶å°±ç”¨è¿™ä¸ªæ³¨è§£ã€‚</li>
<li>@RequestParamæ³¨è§£åˆ™è¡¨ç¤ºè¿™ä¸ªå‚æ•°æ˜¯é€šè¿‡å‰ç«¯ä¼ é€’è¿‡æ¥çš„ï¼Œå¦‚æœè¯·æ±‚é‡Œæ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œåˆ™ä¼šæŠ¥é”™400 Bad Requestã€‚è¿™ä¸ªæ³¨è§£ç”¨æ¥<strong>è§£æè¯·æ±‚è·¯å¾„é‡Œ</strong>çš„å‚æ•°ï¼ˆgetè¯·æ±‚ï¼‰æˆ–è€…postè¯·æ±‚ä¸­formè¡¨å•æ ¼å¼çš„è¯·æ±‚å‚æ•°ï¼›</li>
<li>@RequestBodyæ³¨è§£ç”¨æ¥æ¥æ”¶POSTè¯·æ±‚BODYé‡Œçš„å‚æ•°ï¼Œæ ¼å¼ä¸ºJSONæ ¼å¼ã€‚</li>
<li>@ResponseBody</li>
</ul>
<p>ä¸€å®šè¦æ³¨æ„éšç€æŠ€æœ¯çš„å¢é•¿ï¼Œä¼š<strong>å­˜åœ¨åŒåçš„æ³¨è§£</strong>ï¼Œå°±å¦‚åŒåŒåçš„ç±»ä¸€æ ·ï¼Œè¿™äº›åŒåçš„æ³¨è§£æ¥è‡ªä¸åŒçš„åŒ…ä¼šå¯¹ç¨‹åºé€ æˆå¾ˆå¤§çš„å½±å“ï¼ï¼ï¼</p>
<hr>
<h2 id="ä¸­é—´ä»¶å’Œé«˜çº§ç‰¹æ€§"><a href="#ä¸­é—´ä»¶å’Œé«˜çº§ç‰¹æ€§" class="headerlink" title="ä¸­é—´ä»¶å’Œé«˜çº§ç‰¹æ€§"></a>ä¸­é—´ä»¶å’Œé«˜çº§ç‰¹æ€§</h2><h3 id="Springboot-ç¼“å­˜"><a href="#Springboot-ç¼“å­˜" class="headerlink" title="Springboot-ç¼“å­˜"></a>Springboot-ç¼“å­˜</h3><p>é…ç½®ï¼š</p>
<pre><code>mybatis:
  configuration:
    map-underscore-to-camel-case: true
    # æ§åˆ¶å°æ‰“å°Sqlåˆ¤æ–­ç¼“å­˜äº†æ²¡æœ‰
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
</code></pre>
<h4 id="åŸºç¡€ï¼š"><a href="#åŸºç¡€ï¼š" class="headerlink" title="åŸºç¡€ï¼š"></a>åŸºç¡€ï¼š</h4><p>ç¼“å­˜ä½œç”¨ï¼š å°†æ–¹æ³•çš„è¿è¡Œç»“æœè¿›è¡Œç¼“å­˜ä»¥åéœ€è¦ç›¸åŒçš„æ•°æ®æ—¶ç›´æ¥ä»ç¼“å­˜ä¸­æ‹¿ æ‰€è°“è¿è¡Œç»“æœ å½“ç„¶å°±æ˜¯return xxx</p>
<p>CacheProviderï¼šå¯¹CacheManagerçš„åˆ›å»ºã€é…ç½®ã€ç®¡ç†ä¸æ§åˆ¶ã€‚ä¸€ä¸ªåº”ç”¨åœ¨è¿è¡ŒæœŸé—´å¯ä»¥è®¿é—®å¤šä¸ªè¿™ç©æ„å„¿ï¼Œä½†æ˜¯è¿™ç©æ„å„¿å’Œ-Manageræ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚</p>
<p>CacheManagerï¼šå¯¹Cacheçš„ä½œç”¨ç›¸å¯¹äºCacheProviderå¯¹å…¶çš„ä½œç”¨ã€‚åªèƒ½å¯¹åº”ä¸€ä¸ª-Providerã€‚</p>
<p>Cache:ç±»ä¼¼Mapçš„æ•°æ®ç»“æ„ã€‚</p>
<p>Entryï¼šç±»æ¯”mapï¼Œä¸€ä¸ªç¼“å­˜å®ä½“</p>
<p>Expiryï¼šæ¯ä¸ªå­˜å‚¨çš„æ¡ç›®çš„æœ‰æ•ˆæœŸã€‚</p>
<p>Springæä¾›äº†Cacheæ¥å£ï¼Œè§„èŒƒå®šä¹‰ç¼“å­˜ç»„ä»¶ï¼ŒåŒ…æ‹¬ç¼“å­˜çš„å„ç§æ“ä½œã€‚ç»Ÿä¸€ä¸åŒCacheæŠ€æœ¯ï¼Œå¦‚RedisCacheã€EhCacheCacheã€ConcurrentMapCache.</p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/20181215152657263.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>å…³æ³¨ç‚¹ï¼š</p>
<p>1.ç¡®å®šæ–¹æ³•éœ€è¦è¢«ç¼“å­˜ä»¥åŠå…¶ç¼“å­˜ç­–ç•¥ã€‚</p>
<p>2.ä»ç¼“å­˜ä¸­è¯»å–ä¹‹å‰ç¼“å­˜å­˜å‚¨çš„æ•°æ®ã€‚</p>
<table>
<thead>
<tr>
<th>æ¦‚å¿µ&#x2F;æ³¨è§£</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>CacheManager</td>
<td>ç¼“å­˜ç®¡ç†å™¨ï¼Œç®¡ç†å„ç§ç¼“å­˜(Cache)ç»„ä»¶</td>
</tr>
<tr>
<td>ç¼“å­˜æ¥å£ï¼Œå®šä¹‰ç¼“å­˜æ“ä½œ</td>
<td>å®ç°æœ‰ï¼šRedisCacheã€EhCacheCacheã€ConcurrentMapCacheç­‰</td>
</tr>
<tr>
<td>@Cacheable</td>
<td>é’ˆå¯¹æ–¹æ³•é…ç½®ï¼Œæ ¹æ®æ–¹æ³•çš„è¯·æ±‚å‚æ•°å¯¹ç»“æœç¼“å­˜</td>
</tr>
<tr>
<td>@CacheEvict</td>
<td>æ¸…ç©ºç¼“å­˜</td>
</tr>
<tr>
<td>@CachePut</td>
<td>ä¿è¯æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆå¸Œæœ›ç»“æœè¢«ç¼“å­˜ï¼ˆä¸ableçš„ä¸åŒåœ¨äºableæ³¨è§£çš„æ–¹æ³•æœ‰ç¼“å­˜å°±ä¸å»è°ƒç”¨è¿™ä¸ªæ–¹æ³•äº†ï¼‰å¸¸ç”¨äºç¼“å­˜æ›´æ–°</td>
</tr>
<tr>
<td>@EnableCaching</td>
<td>å¼€å¯åŸºäºæ³¨è§£çš„ç¼“å­˜</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>Cache ç¼“å­˜æ¥å£ï¼Œå®šä¹‰ç¼“å­˜æ“ä½œã€‚å®ç°æœ‰ï¼šRedisCacheã€EhCacheCacheã€ConcurrentMapCacheç­‰ CacheManager ç¼“å­˜ç®¡ç†å™¨ï¼Œç®¡ç†å„ç§ç¼“å­˜(Cache)ç»„ä»¶ @Cacheable ä¸»è¦é’ˆå¯¹æ–¹æ³•é…ç½®ï¼Œèƒ½å¤Ÿæ ¹æ®æ–¹æ³•çš„è¯·æ±‚å‚æ•°å¯¹å…¶ç»“æœè¿›è¡Œç¼“å­˜ @CacheEvict æ¸…ç©ºç¼“å­˜ @CachePut <strong>ä¿è¯</strong>æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆå¸Œæœ›ç»“æœè¢«ç¼“å­˜ã€‚å¦‚æœæ˜¯Cacheableé‚£ä¹ˆå‘ç°å·²ç»æœ‰ç¼“å­˜å°±ä¸æ‰§è¡Œè¿™ä¸ªæ–¹æ³•äº†ã€‚å› æ­¤è¿™é‡Œè¯´çš„æ˜¯ï¼Œä¿è¯ã€‚ @EnableCaching å¼€å¯åŸºäºæ³¨è§£çš„ç¼“å­˜</p>
<p>keyGenerator ç¼“å­˜æ•°æ®æ—¶keyç”Ÿæˆç­–ç•¥ serialize ç¼“å­˜æ•°æ®æ—¶valueåºåˆ—åŒ–ç­–ç•¥</p>
<p>â€ƒ@Cacheableæ³¨è§£çš„å±æ€§ï¼š</p>
<p>å±æ€§å æè¿° cacheNames&#x2F;value æŒ‡å®šç¼“å­˜çš„åå­—ï¼Œç¼“å­˜ä½¿ç”¨CacheManagerç®¡ç†å¤šä¸ªç¼“å­˜ç»„ä»¶Cacheï¼Œè¿™äº›Cacheç»„ä»¶å°±æ˜¯æ ¹æ®è¿™ä¸ªåå­—è¿›è¡ŒåŒºåˆ†çš„ã€‚å¯¹ç¼“å­˜çš„çœŸæ­£CRUDæ“ä½œåœ¨Cacheä¸­å®šä¹‰ï¼Œæ¯ä¸ªç¼“å­˜ç»„ä»¶Cacheéƒ½æœ‰è‡ªå·±å”¯ä¸€çš„åå­—ï¼Œé€šè¿‡cacheNamesæˆ–è€…valueå±æ€§æŒ‡å®šï¼Œç›¸å½“äºæ˜¯å°†ç¼“å­˜çš„é”®å€¼å¯¹è¿›è¡Œåˆ†ç»„ã€‚</p>
<p>ç¼“å­˜çš„åå­—æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥å°†ä¸€ä¸ªç¼“å­˜é”®å€¼å¯¹åˆ†åˆ°å¤šä¸ªç»„é‡Œé¢ key ç¼“å­˜æ•°æ®æ—¶çš„keyçš„å€¼ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨<strong>æ–¹æ³•å‚æ•°</strong>çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨SpELè¡¨è¾¾å¼è®¡ç®—keyçš„å€¼ keyGenerator ç¼“å­˜çš„ç”Ÿæˆç­–ç•¥ï¼Œå’ŒkeyäºŒé€‰ä¸€ï¼Œéƒ½æ˜¯ç”Ÿæˆé”®çš„ï¼ŒkeyGeneratorå¯è‡ªå®šä¹‰ cacheManager æŒ‡å®šç¼“å­˜ç®¡ç†å™¨(å¦‚ConcurrentHashMapã€Redisç­‰) cacheResolver å’ŒcacheManageråŠŸèƒ½ä¸€æ ·ï¼Œå’ŒcacheManageräºŒé€‰ä¸€ condition æŒ‡å®šç¼“å­˜çš„æ¡ä»¶(æ»¡è¶³ä»€ä¹ˆæ¡ä»¶æ—¶æ‰ç¼“å­˜)ï¼Œå¯ç”¨SpELè¡¨è¾¾å¼(å¦‚#id&gt;0ï¼Œè¡¨ç¤ºå½“å…¥å‚idå¤§äº0æ—¶æ‰ç¼“å­˜) unless å¦å®šç¼“å­˜ï¼Œå³æ»¡è¶³unlessæŒ‡å®šçš„æ¡ä»¶æ—¶ï¼Œæ–¹æ³•çš„ç»“æœä¸è¿›è¡Œç¼“å­˜ï¼Œä½¿ç”¨unlessæ—¶å¯ä»¥åœ¨è°ƒç”¨çš„æ–¹æ³•è·å–åˆ°ç»“æœä¹‹åå†è¿›è¡Œåˆ¤æ–­(å¦‚#result&#x3D;&#x3D;nullï¼Œè¡¨ç¤ºå¦‚æœç»“æœä¸ºnullæ—¶ä¸ç¼“å­˜) sync æ˜¯å¦ä½¿ç”¨å¼‚æ­¥æ¨¡å¼è¿›è¡Œç¼“å­˜ã€‚</p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/image-20211125142516875.png" alt="image-20211125142516875"></p>
<p>æ³¨æ„åŒºåˆ†cacheNames(value)å’Œkey ä¸¤ä¸ªçš„åŒºåˆ«ï¼Œè™½ç„¶éƒ½æ˜¯æ ‡è¯†ï¼Œä½†æ˜¯äºŒè€…çš„çº§åˆ«ä¸åŒã€‚</p>
<p>ä½¿ç”¨Springç¼“å­˜æŠ½è±¡æ—¶æˆ‘ä»¬éœ€è¦å…³æ³¨ä»¥ä¸‹ä¸¤ç‚¹ï¼› 1ã€ç¡®å®šæ–¹æ³•éœ€è¦è¢«ç¼“å­˜ä»¥åŠä»–ä»¬çš„ç¼“å­˜ç­–ç•¥ 2ã€ä»ç¼“å­˜ä¸­è¯»å–ä¹‹å‰ç¼“å­˜å­˜å‚¨çš„æ•°æ®</p>
<p>demoï¼š æŒ‡å®šcacheçš„åå­—ï¼Œè®¾å®škey , ç¬¬ä¸€ä¸ªå‚æ•°å¤§äº1æ‰ç¼“å­˜</p>
<pre><code>@Cacheable(cacheNames = &quot;emp&quot;, key = &quot;#root.methodName+&#39;[&#39;+#id+&#39;]&#39;&quot;, condition = &quot;#a0&gt;1&quot;)
public Employee getEmp(Integer id) &#123;
    log.info(&quot;æŸ¥è¯¢&#123;&#125;å·å‘˜å·¥&quot;, id);
    return employeeMapper.getEmpById(id);
&#125;
</code></pre>
<h4 id="Cacheable"><a href="#Cacheable" class="headerlink" title="@Cacheable"></a>@Cacheable</h4><p>ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶å»æŸ¥å¯¹åº”çš„cacheNameså’Œkeyæ˜¯å¦ä¸ºç©ºï¼Œä¸æ˜¯åˆ™æ”¾å…¥å¦‚æœæ˜¯å°±ç›´æ¥æ‹¿ï¼Œè€Œä¸å»æ‰§è¡Œæ–¹æ³•ã€‚é»˜è®¤åŠ è½½çš„CacheManageræ˜¯SimpleCacheConfigurationï¼Œè¿›å…¥è¯¥ç±»ä¸­å‘ç°æ˜¯åˆ›å»ºäº†ä¸€ä¸ªConcurrentMapCacheManagerï¼Œè¯¥ç±»ä¸­ç”Ÿæˆäº†ä¸€ä¸ªConcurrentMapä½œä¸ºCacheçš„å­˜å‚¨ã€‚</p>
<pre><code>private final ConcurrentMap&lt;String, Cache&gt; cacheMap = new ConcurrentHashMap&lt;&gt;(16);
@Override
@Nullable
public Cache getCache(String name) &#123;
   Cache cache = this.cacheMap.get(name);
   if (cache == null &amp;&amp; this.dynamic) &#123;
      synchronized (this.cacheMap) &#123;
         cache = this.cacheMap.get(name);
         if (cache == null) &#123;
            cache = createConcurrentMapCache(name);
            this.cacheMap.put(name, cache);
         &#125;
      &#125;
   &#125;
   return cache;
&#125;
</code></pre>
<p>KeyGenerator</p>
<pre><code>@Configuration
public class MyCacheConfig &#123;
    @Bean(&quot;myKeyGenerator&quot;)
    public KeyGenerator generator() &#123;
        return (target, method, params) -&gt; method.getName() + &quot;[&quot;+ Arrays.asList(params).toString() +&quot;]&quot;;
    &#125;
&#125;
</code></pre>
<h4 id="CachePut"><a href="#CachePut" class="headerlink" title="@CachePut"></a>@CachePut</h4><p>ä¸Šé¢çš„@Cacheableæ˜¯åœ¨æ–¹æ³•è°ƒç”¨å‰ä¼šå»ç¼“å­˜ä¸­æ ¹æ®æŒ‡å®šçš„valueæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ï¼Œè€Œputæ˜¯å…ˆè°ƒç”¨æ–¹æ³•ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œåå°†<strong>æ‰§è¡Œç»“æœ</strong>æ”¾å›ç¼“å­˜ã€‚æ—¢è°ƒç”¨äº†æ–¹æ³•åŒæ—¶åˆæ›´æ–°äº†ç¼“å­˜ï¼Œæ¯”å¦‚æˆ‘ä»¬åšupdateçš„æ—¶å€™ã€‚</p>
<p>åœ¨åˆ©ç”¨ç¼“å­˜</p>
<p><strong>æ³¨æ„keyå¯¹äºæ›´æ–°</strong>ç¼“å­˜å†…å®¹çš„ä½œç”¨ï¼Œå¦‚æœæƒ³è¦é’ˆå¯¹åŒä¸€ä¸ªç¼“å­˜åšä¸åŒçš„æ“ä½œä¸€å®šè¦ä¿è¯keyæ˜¯ç›¸åŒçš„ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æ“ä½œçš„å¯¹äºæ•°æ®åº“æ¥è¯´æ˜¯åŒä¸€æ¡æ•°æ®ï¼Œä½†æ˜¯å› ä¸ºkeyä¸åŒä¼šé€ æˆä¸æ˜¯åŒä¸€å—ç¼“å­˜ã€‚</p>
<p>è¿™ç‚¹è¦æ ¼å¤–æ³¨æ„ï¼Œå¦å¤–è¿˜æœ‰@Cacheableä¸@CachePutçš„æ‰§è¡Œæ—¶æœºé—®é¢˜ã€‚</p>
<p>ä¸€ä¸ªç–‘é—®ï¼šç¼“å­˜æ˜¯ä¸æ˜¯åº”è¯¥åŠ é”ï¼Œä¸ç„¶ä¸¤ä¸ªç”¨æˆ·ä¸€ä¸ªå»æŸ¥ä¸€ä¸ªå»æ”¹é‚£ä¹ˆæ˜¯ä¼šå‡ºé—®é¢˜çš„å‘€ã€‚ç§’æ€ï¼Ÿ</p>
<pre><code>@CachePut(value = &quot;emp&quot;, key = &quot;#employee.id&quot;)
public Integer updateEmp(Employee employee) &#123;
    log.info(&quot;æ›´æ–°&#123;&#125;å·å‘˜å·¥çš„ä¿¡æ¯ä¸º&#123;&#125;&quot;, employee.getId(), employee.toString());
    return employeeMapper.updateEmp(employee);

&#125;
</code></pre>
<p>åœ¨å°†æ–¹æ³•è¿”å›å€¼è®¾ç½®ä¸ºIntegeræ—¶é‡åˆ°äº†æŠ¥é”™ï¼Œå› ä¸ºè¿”å›å¯¹è±¡æ˜¯è¦å­˜å…¥ç¼“å­˜çš„ï¼Œæ˜¾ç„¶åŒä¸€ä¸ªEntryå­˜å…¥çš„å¯¹è±¡ç±»å‹è¦ç›¸åŒã€‚</p>
<h4 id="CacheEvict"><a href="#CacheEvict" class="headerlink" title="@CacheEvict"></a>@CacheEvict</h4><p>è¿™é‡Œåªæ˜¯åˆ é™¤ç¼“å­˜ä¸­çš„ä¿¡æ¯ æŒ‡å®šç¼“å­˜ æŒ‡å®šEntry æ¸…ç©ºè¯¥ç¼“å­˜æ‰€æœ‰Entry åœ¨æ–¹æ³•è°ƒç”¨å‰å°±æ¸…ç©ºç¼“å­˜ï¼ˆé»˜è®¤æ˜¯false</p>
<pre><code>@CacheEvict(value = &quot;emp&quot;, key=&quot;#id&quot; allEntries = true, beforeInvocation = true)
public void deleteEmp(Integer id) &#123;
    log.info(&quot;åˆ é™¤ç¼“å­˜ä¸­çš„å‘˜å·¥&#123;&#125;ä¿¡æ¯&quot;, id);
    //employeeMapper.deleteEmpById(id);
&#125;
</code></pre>
<h4 id="Caching"><a href="#Caching" class="headerlink" title="@Caching"></a>@Caching</h4><p>åˆ¶å®šå¤æ‚è§„åˆ™â€”â€”ç»„åˆæ‹³</p>
<pre><code>@Caching(cacheable = &#123;
        @Cacheable(key = &quot;#lastName&quot;)
&#125;, put = &#123;
        @CachePut(key = &quot;#result.id&quot;),
        @CachePut(key = &quot;#result.email&quot;)
&#125;)
public Employee getEmpByLastName(String lastName) &#123;
    return employeeMapper.selectEmpByLastName(lastName);
&#125;
</code></pre>
<p>@CacheConfig -å¯ä»¥ä¸ºä¸€ä¸ªç±»æŒ‡å®šç»Ÿä¸€çš„cacheNames(æ²¡æœ‰valueäº†) cacheManager</p>
<h4 id="äºŒçº§ç¼“å­˜"><a href="#äºŒçº§ç¼“å­˜" class="headerlink" title="äºŒçº§ç¼“å­˜"></a>äºŒçº§ç¼“å­˜</h4><p>Caffine+Redis</p>
<p><img src="/" alt="å›¾ç‰‡"></p>
<p>ä»…ä»è¯¥å›¾ä¸Šçœ‹ï¼Œå…¶å®è¯»å–å¤šçº§ç¼“å­˜å’Œè¯»å–å•çº§ç¼“å­˜çš„åŒºåˆ«å°±æ˜¯å¤šäº†ä¸€çº§ä»äºŒçº§ç¼“å­˜å†™å…¥ä¸€çº§ç¼“å­˜ï¼Œé‚£ä¹ˆæ˜¯å¦æ¯ç§æƒ…å†µéƒ½æ˜¯å¦‚æ­¤å‘¢ï¼Œè¿™æ ·å­çš„æ“ä½œå¤šäº†ä¸€æ¬¡å†™å…¥ã€‚</p>
<p>å¦å¤–è€ƒè™‘åˆ°LRUæ’åºç­‰ï¼Œæ˜¯å¦ä¸¤çº§ç¼“å­˜ä¹‹é—´éƒ½å¯ä»¥ç”¨åŒä¸€ç§æ’åºæ–¹å¼å‘¢ï¼Ÿ</p>
<p>åˆ©ç”¨æœ€åŸå§‹çš„ï¼Œè‡ªå®šä¹‰Cacheå—ï¼Œå»æ“ä½œ</p>
<p>é…ç½®ï¼š</p>
<pre><code>@Configuration
public class CaffeineConfig &#123;
    @Bean
    public Cache&lt;String, Object&gt; getCaffeineCache() &#123;
        return Caffeine.newBuilder()
                .initialCapacity(128)
                .maximumSize(1024)
                .expireAfterWrite(60, TimeUnit.SECONDS)
                .build();
    &#125;
&#125;
</code></pre>
<p>æŸ¥è¯¢ï¼š</p>
<pre><code>public JaOrder getOrderById(String id) &#123;
    String key = Constants.ORDER_COSTANT + id;
    JaOrder jaOrder = (JaOrder) cache.get(key, k -&gt; &#123;
        // å…ˆæŸ¥è¯¢redis
        Object obj = redisTemplate.opsForValue().get(k);
        if (ObjectUtil.isNotEmpty(obj)) &#123;
            log.info(&quot;Get data from redis&quot;);
            return obj;

        &#125;
        log.info(&quot;--------------------------&gt;Get data from database&lt;----------------------------&quot;);
        JaOrder dbJaOrder = orderDao.selectOrder(id);
        redisTemplate.opsForValue().set(k, dbJaOrder, 120, TimeUnit.SECONDS);
        return dbJaOrder;

    &#125;);
    return jaOrder;
&#125;
</code></pre>
<p>è¿™ç§å°±æ˜¯å°†redisçš„ç¼“å­˜å’Œcaffeineçš„ç¼“å­˜å¤„ç†éƒ½äº¤ç”±å¼€å‘äººå‘˜ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚â€”â€”è¿™é‡Œå¼•ç”³å‡ºä¸€ä¸ªæ¦‚å¿µï¼šå¯¹ä»£ç çš„å…¥ä¾µï¼Œæ˜¯å¯¹ä¸šåŠ¡ä»£ç çš„å…¥ä¾µå§ï¼Œè¿™äº›ç¼“å­˜å…¬å…±çš„ä¸œè¥¿è¿˜æ˜¯åº”è¯¥å°½å¯èƒ½çš„ä¸ä¸šåŠ¡ä»£ç å‰¥ç¦»å¼€ã€‚</p>
<p>åŸºäºæ³¨è§£@Cachexxx ï¼ˆå°†æœ¬åœ°ç¼“å­˜æ‰˜ç®¡ç»™Springbootï¼‰</p>
<pre><code>@Cacheable(value = &quot;order&quot;, key = &quot;#id&quot;)
public JaOrder getOrderById(String id) &#123;
    String key = Constants.ORDER_COSTANT + id;
    Object obj = redisTemplate.opsForValue().get(k);
    if (ObjectUtil.isNotEmpty(obj)) &#123;
        log.info(&quot;Get data from redis&quot;);
        return (JaOrder) obj;
    &#125;
    // å…ˆæŸ¥è¯¢redis
    log.info(&quot;--------------------------&gt;Get data from database&lt;----------------------------&quot;);
    JaOrder dbJaOrder = orderDao.selectOrder(id);
    redisTemplate.opsForValue().set(k, dbJaOrder, 120, TimeUnit.SECONDS);
    return dbJaOrder;

&#125;
</code></pre>
<p>è‡ªå®šä¹‰æ³¨è§£ä¸åˆ‡é¢ï¼Œè¿›ä¸€æ­¥å‡å°‘å¯¹ä¸šåŠ¡ä»£ç çš„å…¥ä¾µ(è¿™é‡Œæ²¡æœ‰å¯¹Cacheè¿›è¡Œéš”ç¦»)ã€‚</p>
<p>ä¸€ç‚¹æ€æƒ³â€”â€” è§£å†³å…¥ä¾µï¼šä¸šåŠ¡çš„å½’ä¸šåŠ¡çš„ï¼Œé€šç”¨çš„å½’é€šç”¨çš„ï¼Œä¸¤è€…ä¸è¦è€¦åˆåœ¨ä¸€èµ·ã€‚</p>
<p>è‡ªå®šä¹‰æ³¨è§£ï¼š</p>
<pre><code>@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface DoubleCache &#123;
    String cacheName();
    String key();
    long timeOut() default 120;
    CacheType type() default CacheType.FULL;
&#125;
</code></pre>
<p>è‡ªå®šä¹‰åˆ‡é¢</p>
<pre><code>@Slf4j
@Component
@Aspect
public class CacheAspect &#123;

    @Autowired
    private Cache cache;

    @Autowired
    private RedisTemplate redisTemplate;


    /**
     * æŒ‡å®šåˆ‡ç‚¹
     */
    @Pointcut(&quot;@annotation(com.fan.common.anno.DoubleCache)&quot;)
    public void cacheAspect()&#123;

    &#125;

    @Around(&quot;cacheAspect()&quot;)
    public Object doArount(ProceedingJoinPoint point) throws Throwable &#123;
        MethodSignature signature = (MethodSignature) point.getSignature();
        Method method = signature.getMethod();
        // æ‹¼æ¥è§£æSpringElè¡¨è¾¾å¼çš„map
        String[] paramNames = signature.getParameterNames();
        // çœ‹èµ·æ¥ä¸¤è¡Œéƒ½æ˜¯å‚æ•° ä¸€è¡Œæ˜¯å®é™…ä¸Šçš„å‚æ•° ä¸€è¡Œæ˜¯å¯¹åº”çš„å‚æ•°å€¼
        Object[] args = point.getArgs();
        TreeMap&lt;String, Object&gt; treeMap = new TreeMap&lt;&gt;();
        for (int i = 0; i &lt; paramNames.length; i++) &#123;
            treeMap.put(paramNames[i], args[i]);
        &#125;

        DoubleCache cacheAnno = method.getAnnotation(DoubleCache.class);
        String elResult = ELParser.parse(cacheAnno.key(), treeMap);
        String realKey = cacheAnno.cacheName() + Constants.COLON + elResult;

        // å¼ºåˆ¶æ›´æ–°
        if (cacheAnno.type() == CacheType.PUT) &#123;
            Object object = point.proceed();
            redisTemplate.opsForValue().set(realKey, object, cacheAnno.timeOut(), TimeUnit.SECONDS);
            cache.put(realKey, object);
            return object;

        &#125; else if (cacheAnno.type() == CacheType.DELETE) &#123;
            redisTemplate.delete(realKey);
            cache.invalidate(realKey);
            return point.proceed();
        &#125;
        Object caffeineCache = cache.getIfPresent(realKey);
        if (Objects.nonNull(caffeineCache)) &#123;
            log.info(&quot;get data from caffeine&quot;);
            return  caffeineCache;
        &#125;
        Object redisCache = redisTemplate.opsForValue().get(realKey);
        if (Objects.nonNull(redisCache)) &#123;
            log.info(&quot;get data from redis&quot;);
            cache.put(realKey, redisCache);
            return redisCache;
        &#125;
        log.info(&quot;get data from database&quot;);
        Object object = point.proceed();
        if (Objects.nonNull(object)) &#123;
            // å†™å…¥redis
            redisTemplate.opsForValue().set(realKey, object, cacheAnno.timeOut(), TimeUnit.SECONDS);
            cache.put(realKey, object);
        &#125;
        return object;

    &#125;
    
&#125;
</code></pre>
<h3 id="æ¶ˆæ¯é˜Ÿåˆ—"><a href="#æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—"></a>æ¶ˆæ¯é˜Ÿåˆ—</h3><p><strong>å¼‚æ­¥å¤„ç†</strong></p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzY2NDQxOA==,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><strong>åº”ç”¨è§£è€¦<img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzY2NDQxOA==,size_16,color_FFFFFF,t_70-16378923797595.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></strong></p>
<p><strong>æµé‡å‰Šå³°</strong></p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/20191106170829599.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><strong>é‡è¦æ¦‚å¿µ</strong>ï¼š</p>
<p>æ¶ˆæ¯ä»£ç† å’Œ ç›®çš„åœ° æ‰€è°“RabbitMQå°±æ˜¯æ¶ˆæ¯ä»£ç†çš„ä¸€ç§è§„èŒƒ</p>
<p>æ¶ˆæ¯å‘é€è€…å‘é€æ¶ˆæ¯åç”±æ¶ˆæ¯ä»£ç†æ¥ç®¡ï¼Œæ¶ˆæ¯ä»£ç†ä¿è¯æ¶ˆæ¯å‘é€åˆ° æŒ‡å®š ç›®çš„åœ°</p>
<p>å…¶ä¸­ç›®çš„åœ°ä¸»è¦æ˜¯ä¸¤ç§å½¢å¼ï¼š</p>
<p>é˜Ÿåˆ—ï¼šç‚¹å¯¹ç‚¹æ¶ˆæ¯é€šä¿¡. å‘é€-æ”¾å…¥é˜Ÿåˆ— æ¥æ”¶è€…è¯»å–åç§»å‡º ä¸€æ¡æ¶ˆæ¯å‘é€è€…å’Œæ¥æ”¶è€…æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯å¹¶ä¸ä»£è¡¨æ¥æ”¶æ–¹åªèƒ½æœ‰ä¸€ä¸ªã€‚ é˜Ÿåˆ—å°±æ˜¯æ¶ˆæ¯çš„å®¹å™¨ä¹Ÿæ˜¯ç»ˆç‚¹ï¼Œ äº¤æ¢å™¨å†³å®šæ¶ˆæ¯å‘å¾€å“ªé‡Œã€‚ ç”±äº¤æ¢å™¨å‘é€åˆ°é˜Ÿåˆ—ã€‚</p>
<p>ä¸»é¢˜ï¼šå‘å¸ƒ&#x2F;è®¢é˜…æ¶ˆæ¯é€šä¿¡</p>
<hr>
<p><strong>RabbitMQ</strong></p>
<hr>
<p>æ¦‚å¿µï¼šå…³è”å…³ç³»è§å›¾12</p>
<p>Message: æ¶ˆæ¯ä¸å…·åï¼Œç”±æ¶ˆæ¯å¤´å’Œæ¶ˆæ¯ä½“ç»„æˆï¼Œæ¶ˆæ¯ä½“ä¸é€æ˜ï¼Œè€Œæ¶ˆæ¯å¤´åˆ™ç”±ä¸€ç³»åˆ—å¯é€‰å±æ€§ç»„æˆã€‚</p>
<p>æ¶ˆæ¯å¤´ç»„æˆï¼šè·¯ç”±é”® ï¼Œä¼˜å…ˆæƒï¼Œ ä¼ é€æ¨¡å¼ï¼ˆæ¶ˆæ¯æ˜¯å¦éœ€è¦æŒä¹…æ€§å­˜å‚¨</p>
<p><strong>Publisher</strong>:ç”Ÿäº§è€…ï¼Œä¹Ÿæ˜¯å‘äº¤æ¢å™¨å‘å¸ƒæ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚</p>
<p>**Consumer:**æ¶ˆæ¯çš„æ¶ˆè´¹è€…ï¼Œè¡¨ç¤ºä»ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å¾—æ¶ˆæ¯çš„å®¢æˆ·ç«¯ç¨‹åºã€‚</p>
<p><strong>Exchange</strong>ï¼šäº¤æ¢å™¨ï¼Œæ¥æ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯å¹¶å°†è¿™äº›æ¶ˆæ¯<strong>è·¯ç”±</strong>ç»™æœåŠ¡å™¨ä¸­çš„é˜Ÿåˆ—ã€‚type:direct(default type) fanoutã€topicã€headersï¼Œä¸åŒç±»å‹çš„Exchangeè½¬å‘æ¶ˆæ¯çš„ç­–ç•¥æœ‰æ‰€åŒºåˆ«</p>
<p><strong>Queue</strong>:æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¿å­˜æ¶ˆæ¯ç›´åˆ°å‘é€ç»™æ¶ˆè´¹è€…ï¼Œå®¹å™¨ã€ç»ˆç‚¹ã€‚å¯æ”¾å…¥ä¸€æˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚ä¸Exchangeæ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚</p>
<p>**Binding:**æ¶ˆæ¯é˜Ÿåˆ—å’Œäº¤æ¢å™¨ä¹‹é—´çš„å…³è”ã€‚ å³ï¼šåŸºäºè·¯ç”±é”®å°†äº¤æ¢å™¨å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„ç»‘å®šèµ·æ¥çš„è§„åˆ™ã€‚</p>
<p>å› æ­¤äº¤æ¢å™¨åˆå¯ä»¥è¯´æˆæ˜¯ç”±ç»‘å®šæ„æˆçš„è·¯ç”±è¡¨ã€‚</p>
<p><strong>Connectionï¼š</strong>ç½‘ç»œè¿æ¥ï¼Œæ¯”å¦‚ä¸€ä¸ªTCPè¿æ¥</p>
<p><strong>Channelï¼š</strong>ä¿¡é“,å¤šè·¯å¤ç”¨è¿æ¥ä½¿ç”¨ã€‚å»ºç«‹åœ¨Connectionå†…çš„è™šæ‹Ÿè¿æ¥ï¼ˆè¿™é‡Œå›é¡¾ä¸‹è®¡ç®—æœºç½‘ç»œï¼‰ï¼Œå®é™…ä¸ŠAMQPå‘½ä»¤éƒ½æ˜¯é€šè¿‡ä¿¡é“å‘å‡ºçš„ï¼Œå‘å¸ƒæ¶ˆæ¯ã€è®¢é˜…é˜Ÿåˆ—å’Œæ¥æ”¶æ¶ˆæ¯éƒ½æ˜¯é€šè¿‡ä¿¡é“å®Œæˆã€‚</p>
<p>å¯¹äºOSæ¥è¯´ï¼Œå»ºç«‹å’Œé”€æ¯TCPè¿æ¥éƒ½æ˜¯éå¸¸æ˜‚è´µçš„å¼€é”€ï¼Œå› æ­¤å¼•å…¥äº†ä¿¡é“æ¦‚å¿µä»¥è¾¾åˆ°å¤ç”¨TCPè¿æ¥çš„ç›®çš„ã€‚</p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzY2NDQxOA==,size_16,color_FFFFFF,t_70-16378958071427.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p> å›¾12</p>
<p><strong>Broker</strong>ï¼šæ¶ˆæ¯æœåŠ¡å™¨å®ä½“ã€‚</p>
<p><strong>Virtual</strong> <strong>Host</strong>ï¼šä¸€æ‰¹äº¤æ¢å™¨ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œç›¸å…³å¯¹è±¡ã€‚ï¼ˆæš‚ä¸”ç†è§£ä¸ºå°†è¿™äº›å¯¹è±¡â€œå°è£…â€äº†èµ·æ¥</p>
<p>JMSï¼šJavaæ¶ˆæ¯æœåŠ¡ AMQPï¼šé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼šå‘é€æ—¶æ¶ˆæ¯ç±»å‹æ˜¯byte[]ï¼Œå¤æ‚çš„æ¶ˆæ¯å¯ä»¥åºåˆ—åŒ–åå‘é€</p>
<p>åè®®ã€‚è¿è¡ŒåŸç†è§å›¾13</p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzY2NDQxOA==,size_16,color_FFFFFF,t_70-16379082459579.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p> å›¾13</p>
<p>æµ‹è¯•ï¼š</p>
<p>å…ˆåœ¨dockerä¸­éƒ¨ç½²ï¼š 8.140.23.86:5672</p>
<p>åœ¨15672ç«¯å£ä¸‹æ˜¯å…¶web ç®¡ç†é¡µé¢ï¼Œä¸éœ€è¦å¦å¤–å»å¯åŠ¨ã€‚å…ˆå»ºç«‹å‡ ä¸ªäº¤æ¢å™¨å’Œé˜Ÿåˆ—å¦‚ä¸‹ï¼Œäº¤æ¢å™¨æŒ‡å®šç±»å‹ã€‚</p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/image-20211129095107180.png" alt="image-20211129095107180"></p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/image-20211129095245524.png" alt="image-20211129095245524"></p>
<p>ç„¶ååœ¨äº¤æ¢å™¨ä¸­å»ºç«‹å‡ ä¸ªç»‘å®šå…³ç³»ï¼ŒæŒ‡å®šè·¯ç”±é”®ã€‚ï¼ˆåœ¨é˜Ÿåˆ—å’Œäº¤æ¢å™¨ä¸­å¯ä»¥æ¸…æ¥šçœ‹åˆ°è¯¥äº¤æ¢å™¨ç»‘å®šäº†å“ªäº›é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—è¢«å“ªäº›äº¤æ¢å™¨ç»‘å®šäº†ã€‚éƒ½æ˜¯åŸºäºè·¯ç”±é”®æ¥çš„ï¼‰</p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/image-20211129095526029.png" alt="image-20211129095526029"></p>
<h4 id="æ•´åˆ"><a href="#æ•´åˆ" class="headerlink" title="æ•´åˆ"></a>æ•´åˆ</h4><ul>
<li>è‡ªåŠ¨é…ç½®</li>
<li>1ã€RabbitAutoConfiguration</li>
<li>2ã€æœ‰è‡ªåŠ¨é…ç½®äº†è¿æ¥å·¥å‚ConnectionFactoryï¼›</li>
<li>3ã€RabbitProperties å°è£…äº† RabbitMQçš„é…ç½®</li>
<li>4ã€ RabbitTemplate ï¼šç»™RabbitMQå‘é€å’Œæ¥å—æ¶ˆæ¯ï¼›</li>
<li>5ã€ AmqpAdmin ï¼š RabbitMQç³»ç»Ÿç®¡ç†åŠŸèƒ½ç»„ä»¶;</li>
<li>AmqpAdminï¼šåˆ›å»ºå’Œåˆ é™¤ Queueï¼ŒExchangeï¼ŒBinding</li>
<li>6ã€@EnableRabbit + @RabbitListener ç›‘å¬æ¶ˆæ¯é˜Ÿåˆ—çš„å†…å®¹</li>
</ul>
<p>æµ‹è¯•è¿‡ç¨‹ä¸­å¾ˆå¥‡æ€ªï¼Œä¸æ•™ç¨‹ç›¸æ¯”æ²¡æœ‰æŒ‡å®šç¼–ç æ ¼å¼ä¹Ÿå¯ä»¥æ­£å¸¸æ¥æ”¶ä¸­æ–‡å­—ç¬¦ã€‚æ¨æµ‹æ˜¯1.0åˆ°2.0çš„æ”¹è¿›å§ã€‚</p>
<pre><code>@Autowired
RabbitTemplate rabbitTemplate;

@Test
void contextLoads() &#123;
    /**
     * 1.å•æ’­ï¼ˆç‚¹å¯¹ç‚¹
     * Messageéœ€è¦è‡ªå·±æ„é€ ä¸€ä¸ªï¼Œå®šä¹‰æ¶ˆæ¯å†…å®¹å’Œæ¶ˆæ¯å¤´
     */
    //rabbitTemplate.send(exchange, routeKey, message);
    /**
     *  objecté»˜è®¤ä½œä¸ºæ¶ˆæ¯ä½“ï¼Œåªéœ€è¦ä¼ å…¥è¦å‘é€çš„å¯¹è±¡ï¼Œè‡ªåŠ¨åºåˆ—åŒ–å‘é€ç»™rabbitMQ
     */
    //rabbitTemplate.convertAndSend(exchange, routeKey, object);
    Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();
    map.put(&quot;msg&quot;, &quot;æˆ‘æçˆ¹&quot;);
    map.put(&quot;data&quot;, Arrays.asList(&quot;HelloWorld&quot;, 123, true));
    rabbitTemplate.convertAndSend(&quot;test.direct&quot;, &quot;chuzhongtian.test&quot;, map);

&#125;

@Test
public void receieve() &#123;
    Object obj = rabbitTemplate.receiveAndConvert(&quot;chuzhongtian.test&quot;);
    System.out.println(obj.getClass().toString());
&#125;
</code></pre>
<p><strong>ç›‘å¬</strong></p>
<p>@EnableRabbit æ”¾åœ¨ä¸»å¯åŠ¨ç±»ä¸Š</p>
<p>@RabbitListener ä¸ä¸Šé¢çš„é…åˆç›‘å¬æ¶ˆæ¯é˜Ÿåˆ—</p>
<pre><code>@RabbitListener(queues = &quot;chuzhongtian.test&quot;)
public void receive(Map&lt;String, String&gt; message) &#123;
    System.out.println(&quot;æ”¶åˆ°æ¶ˆæ¯&quot; + message);
&#125;
</code></pre>
<p>@RabbitListenerè¿™ä¸ªæ³¨è§£æ‰€åœ¨çš„æ–¹æ³•æ¥æ”¶å‚æ•°çš„ç±»å‹è¦å’Œæ¶ˆæ¯ç±»å‹ä¸€è‡´ã€‚</p>
<p><strong>AmqpAdminç®¡ç†ç»„ä»¶çš„ä½¿ç”¨</strong></p>
<pre><code>@Autowired
    AmqpAdmin admin;

@Test
public void createExchange() &#123;
    admin.declareExchange(new DirectExchange(&quot;admin.test&quot;));  //æŒ‡å®šç±»å‹ å‘½å
    admin.declareQueue(new Queue(&quot;admque.test&quot;, true));  //å‘½åå¹¶åˆ¶å®šä¸ºæŒä¹…åŒ–
    admin.declareBinding(new Binding(&quot;admque.test&quot;, Binding.DestinationType.QUEUE,
                &quot;admin.test&quot;, &quot;admin.test&quot;, null)); //åœ¨ä¸¤ä¸ªå¯¹è±¡é—´å»ºç«‹è”ç³»
    System.out.println(&quot;åˆ›å»ºæˆåŠŸ&quot;);
&#125;
</code></pre>
<h3 id="ElasticSearch"><a href="#ElasticSearch" class="headerlink" title="ElasticSearch"></a>ElasticSearch</h3><p>å‰ç½®ï¼šè¿™ä¸ªä¸œè¥¿dockeré‡Œå®‰è£…æ¯”è¾ƒéº»çƒ¦ï¼Œè¿˜éœ€è¦æŒ‡å®šä¸‹å†…å­˜</p>
<p>ä¸ç„¶é»˜è®¤1ä¸ªGBå¯åŠ¨å°±å…³äº†ã€‚è€Œä¸”ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸æŒ‡å®šç‰ˆæœ¬å°±ä¼šæœ‰ç”¨5.å‡ ï¼Œä¸‹è½½7.å¤šè¿˜å¿…é¡»è¦æœ‰JDKï¼Œ</p>
<pre><code>docker run -e ES_JAVA_OPTS=&quot;-Xms128m -Xmx128m&quot; -d -p 9200:9200 -p 9300:9300 --name elasticsearch xxx 
</code></pre>
<p>ç„¶åè¿˜éœ€è¦åˆ©ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤å»æŸ¥åˆ°åº•å“ªå‡ºé”™äº†ï¼Œæ€»ä¹‹pullä¸€ä¸ªé•œåƒå¹¶æˆåŠŸå¯åŠ¨å¹¶ä¸æ€»æ˜¯é¡ºåˆ©ï¼Œä¸­é—´åœ¨ä½¿ç”¨docker ps æ—¶å°½ç®¡èƒ½æŸ¥åˆ°elasticsearchå¯åŠ¨äº†ç„¶è€Œå…¶å®è¿˜æ˜¯æ²¡æœ‰å¯åŠ¨æˆåŠŸï¼Œå› ä¸ºæµè§ˆå™¨æ— æ³•è®¿é—®åˆ°ã€‚</p>
<pre><code>docker logs -f xxx
</code></pre>
<hr>
<p><strong>é¢å‘æ–‡æ¡£</strong></p>
<p>å¯¹è±¡å¾€å¾€æ˜¯å¤æ‚çš„ï¼Œï¼ˆè¿™ç‚¹èµ·å› å’Œredisé‚£æ—¶ç±»ä¼¼ï¼‰ä½ ä¸å¯èƒ½åˆ©ç”¨è¡¨æ ¼å­˜å‚¨è¿™ä¸ªå¯¹è±¡å†…éƒ¨æ•°æ®çš„å¤æ‚å…³ç³»ã€‚</p>
<p>ä½†æ˜¯ElasticSearchç”±äºæ˜¯é¢å‘æ–‡æ¡£ï¼ˆç±»æ¯”json)çš„ï¼Œå¯ä»¥å­˜ä¸‹æ•´ä¸ªå¯¹è±¡æˆ–æ–‡æ¡£å› æ­¤æ²¡æœ‰å…³ç³»ã€‚è¿™é‡Œåˆ©ç”¨çš„æ˜¯ç´¢å¼•ã€‚ç´¢å¼•å¯¹äºelasticsearchæœ‰ä¸¤ç§å«ä¹‰ï¼ŒåŠ¨è¯ä¹‰ç±»ä¼¼insertçš„ä½œç”¨å°±æ˜¯å­˜å‚¨ä¸€ä¸ªæ–‡æ¡£åˆ°ç´¢å¼•ä¸­ã€‚</p>
<p>æŸ¥è¡Œåˆ—ä¸æŸ¥æ–‡æ¡£çš„ä¸åŒã€‚</p>
<p><img src="https://gitee.com/Hs_Leo/notes/raw/develop/SpringBoot.assets/20190817152545368.png" alt="img"></p>
<p>ElasticSearchæ¯”è¾ƒå¥½çš„ä¸€ç‚¹æ˜¯å¯ä»¥ç›´æ¥åˆ©ç”¨postmanå‘é€ä¸€ä¸ªputè¯·æ±‚å°±ä¼šæ·»åŠ ä¸€ä¸ªç´¢å¼•ï¼Œæ¯”å¦‚ï¼š<a href="https://gitee.com/link?target=http://8.140.23.86:9200/megacorp/employee/1">http://8.140.23.86:9200/megacorp/employee/1</a> ç«¯å£å·åçš„è¡¨ç¤ºä¸€ä¸ªèŠ‚ç‚¹åç§°ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•ã€‚å¦‚æœç³»ç»Ÿä¸­æ²¡æœ‰ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªï¼Œemployeeè¡¨ç¤ºæ–‡æ¡£åï¼ˆå¯¹è±¡åï¼‰ã€‚1æ˜¯è¿™æ¡æ•°æ®çš„æ ‡è¯†ã€‚</p>
<p>ä¸è¿‡å‘é€è¯·æ±‚åå‘ç°ä¸€ç›´æ²¡æœ‰å“åº”ï¼Œå“åº”åæŠ¥çš„æ˜¯ä¸€ä¸ª SERVICE_UNAVAILABLE&#x2F;1&#x2F;state not recovered &#x2F;initializedçš„é”™è¯¯ï¼Œå»ä¿®æ”¹é…ç½®æ–‡ä»¶elasticsearch.ymlï¼Œå¢æ·»node.name: node-1åå‘ç°å¯ä»¥äº†ã€‚è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆåªæœ‰çŸ­çŸ­ä¸¤è¡Œã€‚</p>
<pre><code>// request
&#123;
    &quot;first_name&quot; : &quot;John&quot;,
    &quot;last_name&quot; :  &quot;Smith&quot;,
    &quot;age&quot; :        25,
    &quot;about&quot; :      &quot;I love to go rock climbing&quot;,
    &quot;interests&quot;: [ &quot;sports&quot;, &quot;music&quot; ]
&#125;

// response
&#123;
  &quot;_index&quot;: &quot;megacorp&quot;,
  &quot;_type&quot;: &quot;employee&quot;,
  &quot;_id&quot;: &quot;1&quot;,
  &quot;_version&quot;: 1,
  &quot;result&quot;: &quot;created&quot;,
  &quot;_shards&quot;: &#123;
    &quot;total&quot;: 2,
    &quot;successful&quot;: 1,
    &quot;failed&quot;: 0
  &#125;,
  &quot;_seq_no&quot;: 0,
  &quot;_primary_term&quot;: 1
&#125;
</code></pre>
<p>å†æ·»åŠ å‡ ä¸ªæ•°æ®ï¼Œåªè¦ä¿®æ”¹åé¢çš„æ ‡è¯†å°±å¯ä»¥äº†ï¼Œä¸€ä¸ªæ ‡è¯†ä¸‹åº”è¯¥åªèƒ½å­˜å‚¨ä¸€ä¸ªæ•°æ®ã€‚</p>
<p>æ£€ç´¢ï¼Œè¯·æ±‚uriä¸å˜æ–¹å¼ä¿®æ”¹ä¸ºGETå³å¯ã€‚_sourceä¸­å°±æ˜¯å­˜å…¥çš„æ•°æ®å†…å®¹ã€‚è¿˜æœ‰è¡¨ç¤ºç´¢å¼•åç§°ã€æ–‡æ¡£åã€è¡¨ç¤ºç­‰ç­‰çš„å“åº”å¤´ï¼Œfoundè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚çš„ç»“æœã€‚è¿™é‡Œçš„typeè¯´æ˜è¿™ä¸ªidä¸‹çš„æ•°æ®è¢«ä¿®æ”¹è¿‡ã€‚</p>
<pre><code>&#123;
  &quot;_index&quot;: &quot;megacorp&quot;,
  &quot;_type&quot;: &quot;employee&quot;,
  &quot;_id&quot;: &quot;2&quot;,
  &quot;_version&quot;: 2,
  &quot;_seq_no&quot;: 2,
  &quot;_primary_term&quot;: 1,
  &quot;found&quot;: true,
  &quot;_source&quot;: &#123;
    &quot;first_name&quot;: &quot;Douglas&quot;,
    &quot;last_name&quot;: &quot;Fir&quot;,
    &quot;age&quot;: 35,
    &quot;about&quot;: &quot;I like to build cabinets&quot;,
    &quot;interests&quot;: [
      &quot;forestry&quot;
    ]
  &#125;
&#125;
</code></pre>
<p>åˆ é™¤ç›´æ¥åˆ‡æ¢ä¸ºDELETEè¯·æ±‚å°±å¯ä»¥äº†ï¼Œè¿”å›çš„foundä¸­æŸ¥çœ‹æ˜¯falseã€‚</p>
<p>HEADè¯·æ±‚ æ£€æŸ¥ä¸€ä¸‹æ— å“åº”å¤´è¿”å›</p>
<p>å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œä¾ç„¶ä½¿ç”¨PUTè¯·æ±‚ï¼Œä¸æ”¹å˜æ ‡è¯†ã€‚è¯†åˆ«ä¸ºupdateï¼Œå¹¶æ‰§è¡ŒæˆåŠŸã€‚</p>
<pre><code>&#123;
  &quot;_index&quot;: &quot;megacorp&quot;,
  &quot;_type&quot;: &quot;employee&quot;,
  &quot;_id&quot;: &quot;2&quot;,
  &quot;_version&quot;: 2,
  &quot;result&quot;: &quot;updated&quot;,
  &quot;_shards&quot;: &#123;
    &quot;total&quot;: 2,
    &quot;successful&quot;: 1,
    &quot;failed&quot;: 0
  &#125;,
  &quot;_seq_no&quot;: 6,
  &quot;_primary_term&quot;: 1
&#125;
</code></pre>
<p>è¿™å°±æ˜¯RESTé£æ ¼ã€‹ã€‹ã€‹ã€‹ã€‹ï¼Ÿ</p>
<p>å‘é€æŸ¥è¯¢è¯·æ±‚:<a href="https://gitee.com/link?target=http://8.140.23.86:9200/megacorp/employee/_search?q=last_name:smith">http://8.140.23.86:9200/megacorp/employee/_search?q&#x3D;last_name:smith</a> è‹¥æŸ¥è¯¢æ‰€æœ‰åˆ™å»æ‰ï¼Ÿåçš„å‚æ•°ã€‚</p>
<p>è¿™ç§ä¹Ÿæ˜¯æœ‰æŸ¥è¯¢è§„åˆ™çš„ï¼Œæ ¹æ®ä¸€è·¯å­¦æ¥Linuxçš„æ­£åˆ™è¡¨è¾¾å¼ã€ç¼“å­˜ä¸­çš„åŒ¹é…è§„åˆ™ç­‰ç­‰ä¼¼ä¹è¿™ç§è¾…åŠ©çš„å¼€å‘å·¥å…·æ€»ä¼šè‡ªå¸¦ä¸€äº›â€œå°å¥—è·¯â€ç¼–å†™è¯†åˆ«ã€‚â€“ è¿™æ˜¯ä¸€ç§ä»€ä¹ˆè¶‹åŠ¿å‘¢ï¼Ÿ</p>
<p>æ¯”å¦‚æˆ‘ä»¬å‘ä¸€ä¸ªPOSTè¯·æ±‚çš„æŸ¥è¯¢ï¼Œå› ä¸ºè¦å¸¦ä¸Šä¸‹é¢è¿™ä¸ªè¯·æ±‚ä½“ä½œä¸ºè¯·æ±‚çš„è§„åˆ™ã€‚è¿™é‡Œè¡¨ç¤ºè¦æ‰¾last_nameæ˜¯smithçš„ä¸”Filterå¹´é¾„å¤§äº25çš„ï¼ˆä¸è¦æŠŠFilterç†è§£ä¸ºè¿‡æ»¤æ‰ç¬¦åˆæ¡ä»¶è€Œæ˜¯è¿‡æ»¤å‰©ä¸‹ç¬¦åˆæ¡ä»¶çš„</p>
<pre><code>&#123;
    &quot;query&quot; : &#123;
        &quot;bool&quot;: &#123;
            &quot;must&quot;: &#123;
                &quot;match&quot; : &#123;
                    &quot;last_name&quot; : &quot;smith&quot; 
                &#125;
            &#125;,
            &quot;filter&quot;: &#123;
                &quot;range&quot; : &#123;
                    &quot;age&quot; : &#123; &quot;gt&quot; : 25 &#125; 
                &#125;&#125;&#125;&#125;&#125;
</code></pre>
<p>è¿˜å¯ä»¥æä¾›æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ¯”å¦‚åªç»™å‡ºå¯¹åº”çš„å­—æ®µaboutåªè¦å…¶ä¸­å«æœ‰rock climbingå°±å¯ä»¥</p>
<pre><code>&#123;
    &quot;query&quot; : &#123;
        &quot;match_phrase&quot; : &#123;
            &quot;about&quot; : &quot;rock climbing&quot;
        &#125;
    &#125;
&#125;
</code></pre>
<p>ç»¼ä¸Šçœ‹æ¥å°½ç®¡æ˜¯ä¸€ç§å­˜å‚¨æ–‡æ¡£çš„å·¥å…·ï¼Œä½†æ˜¯å®é™…ä¸Šè¿˜æ˜¯å€Ÿé‰´äº†å…³ç³»å‹æ•°æ®åº“çš„ä¸€äº›ä¸œè¥¿ã€‚ï¼ˆéƒ½æ˜¯ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šå˜›</p>
<p>æ³¨æ„ç‰ˆæœ¬é€‚é…çš„é—®é¢˜ï¼Œä»»ä½•ä¸­é—´ä»¶éƒ½æ˜¯è¿™æ ·ã€‚Spring Springbootè‡ªå¸¦è£…ç®±çš„ä¸­é—´ä»¶ä¹‹é—´çš„ç‰ˆæœ¬åº”è¯¥ä¸æ˜¯é—®é¢˜ä¸»è¦æ˜¯è¦å’Œæ‰€è¿æ¥çš„å·¥å…·çš„ç‰ˆæœ¬ã€‚</p>
<h4 id="æ•´åˆ-1"><a href="#æ•´åˆ-1" class="headerlink" title="æ•´åˆ"></a>æ•´åˆ</h4><p>æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§Jestï¼ˆçœ‹æºç å’Œæ•™ç¨‹è¯´çš„ç‰ˆæœ¬å·®çš„å¤šï¼Œæ‰€ä»¥æš‚ä¸è®°å½•ï¼‰è¿™é‡Œåªè¯´ä¸‹SpringData</p>
<pre><code>spring:
  data:
    elasticsearch:
      cluster-name: xxxx    #è§è¿æ¥çš„elasticsearch.yaml
      cluster-nodes: ip:9300  #è¿™é‡Œé…ç½®çš„portæ˜¯9300ï¼Œæ˜¯èŠ‚ç‚¹é—´é€šä¿¡ç”¨çš„åœ°å€,æ³¨é‡Šæ‰è¯¥è¡Œå‘ç°                                #æ²¡ä»€ä¹ˆå½±å“ï¼Œå°±æ˜¯é›†ç¾¤é—´ç”¨çš„
      repositories:
        enabled: true
  elasticsearch:
    rest:
      uris: http://ip:9200  #è¿™é‡Œè¦é…ç½®å¯¹å¤–çš„ç«¯å£9200
</code></pre>
<p>å‡†å¤‡ä¸€ä¸ªå®ä½“ç±»ï¼ˆå’Œæˆ‘ä»¬äº‹å…ˆputå…¥elasticsearchçš„å±æ€§å¯¹åº”ï¼‰@Documentè¿™ä¸ªæ³¨è§£æœ‰ç‚¹å¥‡æ€ªï¼Œé™¤äº†indexNameå…¶ä½™å±æ€§éƒ½è¿‡æ—¶äº†ã€‚</p>
<pre><code>@Data
@AllArgsConstructor
@NoArgsConstructor
@Document(indexName = &quot;china&quot;, indexStoreType = &quot;book&quot;)
public class Book &#123;
    private String bookName;

    private String author;

    private Integer id;
&#125;
</code></pre>
<p>æŸ¥è¯¢çš„æ–¹æ³•ï¼š</p>
<pre><code>public interface BookRepository extends ElasticsearchRepository&lt;Book, Integer&gt; &#123;
    /**
     *  ä¹‹å‰å°è¯•çš„æ“ä½œè¿™ä¸ªRepositoryä¸­éƒ½æœ‰ï¼ˆå…¶å®å°±æ˜¯mapperï¼‰æ¯”å¦‚å¢åˆ ã€è®¡æ•°ç°åœ¨å†™ä¸€ä¸ªè‡ªå®šä¹‰æ–¹      * æ³•è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢
     */
    List&lt;Book&gt; findByBookNameLike(String bookName);
&#125;
</code></pre>
<p>æµ‹è¯•ï¼š</p>
<pre><code>@Test
void contextLoads() &#123;
    List&lt;Book&gt; list = bookRepository.findByBookNameLike(&quot;æ¸¸&quot;);
    for (Book book : list) &#123;
        System.out.println(book);
    &#125;

&#125;
// æŸ¥è¯¢å‡ºçš„ç»“æœï¼šBook(bookName=è¥¿æ¸¸è®°, author=å´æ‰¿æ©, id=1)
</code></pre>
<h3 id="EasyExcel"><a href="#EasyExcel" class="headerlink" title="EasyExcel"></a>EasyExcel</h3><p>ä¸€å¼€å§‹å‚ç…§å®˜æ–¹æ–‡æ¡£ï¼Œæ•´äº†ä¸€ä¸ªç›‘å¬å™¨å†™æ³•ï¼Œä½†æ˜¯ä¸€ç›´è°ƒç”¨ä¸äº†ç›‘å¬å™¨ä¸­çš„æ–¹æ³•ï¼Œç»“æœæœåˆ°ä¸€ä¸ªæ›´å¥½ç”¨çš„ã€‚</p>
<p>è¿™é‡Œçš„<code>@ExcelProperty</code>ä¸è¡¨æ ¼æ ‡é¢˜å¯¹ç…§</p>
<pre><code>@ExcelProperty(&quot;å­¦å·&quot;)
private String number;
@ExcelProperty(&quot;å‡ºç”Ÿæ—¥æœŸ&quot;)
private Date date;
</code></pre>
<p>åˆ©ç”¨EasyExcelå°†ç±»çš„å±æ€§å’ŒExcelä¸­çš„æ ‡é¢˜å¯¹åº”å¥½ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°ä¸€ä¸ªListï¼Œåé¢çš„æ“ä½œå°±æ–¹ä¾¿äº†ã€‚è¿™é‡Œsheeté»˜è®¤è¯»å–çš„æ˜¯sheet1</p>
<p><strong>è¯»è¡¨</strong></p>
<pre><code>String fileName = &quot;C:\\xxx\\xxxx\\studentpart.xls&quot;;
List&lt;Student&gt; studentList = EasyExcel.read(fileName).head(Student.class).sheet().doReadSync();
</code></pre>
<p><strong>å†™è¡¨</strong></p>
<pre><code>Set&lt;String&gt; writeColumns = new HashSet&lt;&gt;();
writeColumns.add(&quot;number&quot;);
// è¿™é‡Œå¯ä»¥æŒ‡å®šå†™å…¥å¯¹è±¡çš„å“ªäº›å±æ€§ï¼Œå±æ€§æŒ‰é¡ºåºå’ŒExcelæ ‡é¢˜å¯¹åº”ã€‚  åŒæ—¶è¿˜å¯ä»¥åˆ©ç”¨excluidexxxæŒ‡å®šæ’é™¤
EasyExcel.write(newTable, Student.class).includeColumnFiledNames(writeColumns).sheet().doWrite(studentList);
</code></pre>
<p><strong>TODOé—ç•™çš„é—®é¢˜</strong>ï¼šèƒ½ä¸èƒ½ç›´æ¥æŒ‡å®šå†™å…¥æŸä¸€åˆ—è€Œä¸æ˜¯æ¯æ¬¡éƒ½æŠŠè¡¨è¦†ç›–äº†ï¼Ÿ</p>
<p>è¯»å–ä¸åˆ°ç›‘å¬å™¨çš„æ–¹æ³•æ˜¯ä¸æ˜¯å› ä¸ºæ²¡æœ‰å°†å…¶æ³¨å…¥Springå®¹å™¨ä¸­ï¼Ÿ</p>
<h3 id="Beanç›¸å…³"><a href="#Beanç›¸å…³" class="headerlink" title="Beanç›¸å…³"></a>Beanç›¸å…³</h3><p>Springbootæ‹¦æˆªå™¨beanæ— æ³•æ³¨å…¥</p>
<p>æ‹¦æˆªå™¨çš„æ‰§è¡Œåœ¨beanåˆå§‹åŒ–å‰ã€‚</p>
<p>è¿™æ¬¡é”™è¯¯çš„å‘ç°è¯´æ˜äº†è§£å·¥å…·å…¶èƒŒååŸç†å¾ˆé‡è¦ã€‚</p>
<h3 id="è‡ªå®šä¹‰starter"><a href="#è‡ªå®šä¹‰starter" class="headerlink" title="è‡ªå®šä¹‰starter"></a>è‡ªå®šä¹‰starter</h3><pre><code>@Configuration
@ConditionalOnMissingBean
@EnableConfigurationProperties (xxxx.class)
@ConfigurationProperties ä¸ä¸Šè€…ç›¸ä¼´ç›¸ç”Ÿï¼Œä¸Šé¢çš„æ³¨è§£ä½œç”¨å°±æ˜¯ä¸ºäº†ä½¿è¢«è¯¥æ³¨è§£æ³¨è§£çš„ç±»èƒ½å¤Ÿç”Ÿæ•ˆï¼Œä½¿è¯¥æ³¨è§£ä½œç”¨çš„ç±»æ²¡æœ‰@Componentæˆ–ç­‰æ•ˆæ³¨è§£ä¾ç„¶èƒ½å¤Ÿæ³¨å…¥IoCå®¹å™¨ä¸­ã€‚è¯¥ç±»å¯ä»¥ä½¿*.yaml(*.properties)ä¸­è®¾å®šçš„å€¼ä¸JavaBeanç»‘å®šã€‚
</code></pre>
<p>è‡ªå®šä¹‰starterï¼Œå°±æ˜¯åˆ›å»ºä¸‰ä¸ªæ¨¡å—</p>
<p>ä¸€ä¸ªtestæ¨¡å— â€”â€” å»è°ƒç”¨</p>
<p>ä¸€ä¸ªstarteræ¨¡å— â€”â€”å®é™…ä¸Šæ˜¯èµ·äº†ä¸€ä¸ªæ¡¥æ¢çš„ä½œç”¨ï¼Œæ²¡æœ‰ä»€ä¹ˆå…·ä½“çš„é€»è¾‘ï¼Œåªæ˜¯æŠŠæˆ‘ä»¬é¡¹ç›®æ‰€éœ€çš„å¤šä¸ªå­æ¨¡å—çš„ä¾èµ–å¼•å…¥å…¶ä¸­ã€‚</p>
<p>ä¸€ä¸ªautoconfigsomethingæ¨¡å— â€”â€”çœŸæ­£çš„å®ç°é€»è¾‘</p>
<p>é¦–å…ˆï¼Œå°†autoconfigsomethingæ¨¡å—æ³¨å…¥è¿›starteræ¨¡å—ä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡starterå»å¯åŠ¨è¿™ä¸ªæ¨¡å—ï¼Œç„¶åå°†starteræ¨¡å—æ³¨å…¥åˆ°testæ¨¡å—ä¸­</p>
<p>æµ‹è¯•ï¼š</p>
<pre><code>@RestController
public class HelloController &#123;

    @Autowired
    private HelloService helloService;

    @GetMapping(&quot;/hello&quot;)
    public String sayHello() &#123;
        String test = helloService.sayHello(&quot;å‡¡&quot;);
        return test;
    &#125;
&#125;
</code></pre>
<p>è¯¥testæ¨¡å—ä¸‹çš„controllerä¸­å»è°ƒç”¨sayHelloï¼Œä¸æ­¤åŒæ—¶å¯¹åº”çš„application.yamlé…ç½®å¥½äº†suffix</p>
<p>autoconfigæ¨¡å—</p>
<pre><code>public class HelloService &#123;
    // æš‚æ—¶å…ˆä¸æ”¾åœ¨å®¹å™¨ä¸­
    @Autowired
    HelloProperties helloProperties;
    public String sayHello(String name) &#123;
        return helloProperties.getPrefix()+name+helloProperties.getSuffix();
    &#125;
&#125;
</code></pre>
<p>helloServiceæ³¨å…¥åˆ°å¯¹åº”çš„controllerä¸­ï¼ŒhelloPropertiesæ³¨å…¥åœ¨å…¶ä¸­ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼ŒhelloPropertiesç”¨@ConfigurationPropertiesæ³¨è§£å’Œyamlé…ç½®æ–‡ä»¶ç»‘å®šäº†ï¼Œä½†æ˜¯è¯¥æ¨¡å—ä¸‹å¹¶ä¸å­˜åœ¨yamlæœ€ç»ˆä¾ç„¶æˆåŠŸè¾“å‡ºé‚£ä¹ˆæ˜¾ç„¶æˆ‘ä»¬çš„è‡ªå®šä¹‰starteræ˜¯ç”Ÿæ•ˆäº†çš„</p>
<pre><code>@ConfigurationProperties(prefix = &quot;fan.hello&quot;)
@Data
@NoArgsConstructor
@AllArgsConstructor
public class HelloProperties &#123;
    private String prefix;
    private String suffix;

&#125;
</code></pre>
<p>æ³¨æ„åˆ°ï¼Œä¸Šé¢çš„@HelloServiceæ²¡æœ‰@Serviceæ³¨è§£ä½†æ˜¯ä¾ç„¶ä¸å½±å“æ³¨å…¥æ˜¯å› ä¸ºåœ¨autoconfigæ¨¡å—ä¸‹çš„èµ„æºæ–‡ä»¶å¤¹ä¸­è®¾ç½®äº†ï¼š</p>
<pre><code>org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.fan.auto.HelloServiceAutoConfig
</code></pre>
<p>æ¯æ¬¡å¯åŠ¨éƒ½ä¼šè‡ªåŠ¨è£…é…ä¸€ä¸ªHelloServiceAutoConfigçš„ç±»ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>@Configuration
@ConditionalOnMissingBean(HelloService.class)    //å¦‚æœæ²¡æœ‰HelloServiceç±»è¯¥autoconfigå°±ç”Ÿæ•ˆï¼ˆæ˜¾ç„¶å¦‚æœæˆ‘ä»¬åœ¨HelloSerivceä¸ŠåŠ ä¸€ä¸ª@Serviceæˆ–ç­‰æ•ˆçš„æ³¨è§£é‚£ä¹ˆè¿™ä¸ªé…ç½®ç±»å°±æ²¡ç”¨äº†
@EnableConfigurationProperties(HelloProperties.class)  // é»˜è®¤å°†è¿™ä¸ªç±»æ”¾åœ¨å®¹å™¨ä¸­
public class HelloServiceAutoConfig &#123;

    @Bean //è¿™ä¸ªæ³¨è§£ä¸Šé¢è¯´è¿‡
    public HelloService helloService() &#123;
        return new HelloService();
    &#125;
&#125;
</code></pre>
<p>ä¸Šé¢æ˜¯æ ¹æ®ç¨‹åºé€»è¾‘å€’æ¨çš„æ€è·¯ï¼Œå…·ä½“è®¾è®¡ä¸æ˜¯å¦‚æ­¤ï¼Œå†é‡æ¸©ç†è§£ã€‚</p>
<h3 id="å®šæ—¶ä»»åŠ¡"><a href="#å®šæ—¶ä»»åŠ¡" class="headerlink" title="å®šæ—¶ä»»åŠ¡"></a>å®šæ—¶ä»»åŠ¡</h3><p>Springbootæä¾›äº†@EnableSchdulingå’Œ @Scheduledæ³¨è§£ã€‚</p>
<p>ä½†æ˜¯è¿™ç§å¹¶ä¸æ–¹ä¾¿ç”¨æˆ·è‡ªå®šä¹‰ã€‚</p>
<p>æ¯”è¾ƒä¸€ä¸‹å’Œpty-scheduleræœ‰ä»€ä¹ˆä¸åŒã€‚</p>
<p>å¦å¤–è¿™ç§@EnableXXç‰¹åˆ«å¸¸è§ï¼Œè¿™ä¸ªæ³¨è§£é™¤äº†å¯ç”¨æŸä¸ªåŠŸèƒ½ä»¥å¤–æš‚æ—¶çœ‹ä¸å‡ºæ¥æœ‰ä»€ä¹ˆåˆ«çš„ç”¨å¤„ï¼Œè¿™ä¹ˆå¤„ç†æ˜¯å› ä¸ºå¯åŠ¨çš„æ—¶å€™å°½å¯èƒ½ä½¿ç¨‹åºè½»é‡åŒ–å—ï¼Ÿ</p>
<p>åˆ†åˆ«ç‚¹è¿›å»@EnableAutoConfiguration @EnableCaching @EnableSwagger å‘ç°åœ¨è¿™äº›æ³¨è§£çš„æºç ä¸Šéƒ½æœ‰Import(XXXXSelector.class) ã€‚Springä¼šæŠŠselectImport<strong>æ–¹æ³•çš„è¿”å›å€¼å¯¹åº”çš„Beanæ³¨å…¥</strong>åˆ°Springå®¹å™¨</p>
<p>ç„¶è€Œå®é™…ä¸Šå¹¶ä¸éƒ½æ˜¯è¿™æ ·ã€‚æ¯”å¦‚@EnableScheduling importçš„æ˜¯é…ç½®ç±»ï¼Œä¼šå°†<strong>æŒ‡å®šçš„Beanæ³¨å…¥</strong>Springå®¹å™¨ä¸­ã€‚</p>
<p>è¿™ç§@EnableXXæœ¬è´¨ä¸Šè¯´æ¥æ˜¯æ¿€æ´»äº†Springbootçš„æŸäº›ç®¡ç†åŠŸèƒ½ã€‚</p>
<p>JVMæ¯•ç«Ÿæ˜¯æ¶è®¾åœ¨ç¨‹åºå’ŒOSé—´çš„ï¼Œå½“ç„¶å¯ä»¥è·å¾—ç³»ç»Ÿå‚æ•°ï¼ˆè¿™ç‚¹åœ¨è§£å†³ä¹±ç é—®é¢˜æ—¶åº”è¯¥å¯ä»¥æƒ³åˆ°äº†ï¼‰</p>
<p>æ ¹æ®å¯¹å…¬å¸çš„å®šæ—¶ä»»åŠ¡çš„æ¢ç©¶ï¼Œè¿›ä¸€æ­¥æ˜ç™½äº†<strong>æºç çš„é‡è¦æ€§</strong>ã€‚å¦‚æœå¯¹æºç ä¸äº†è§£ï¼Œå¾ˆéš¾åšå‡ºåŸåˆ›æ€§çš„ä¸šåŠ¡ã€‚æ¯”å¦‚å®šæ—¶ä»»åŠ¡ï¼Œå®šæ—¶ä»»åŠ¡çš„ç”Ÿæˆï¼Œæ—¶é—´å‚æ•°çš„é…ç½®ã€‚ã€‚ã€‚</p>
<h3 id="Springboot-Actuator"><a href="#Springboot-Actuator" class="headerlink" title="Springboot Actuator"></a>Springboot Actuator</h3><p>what?:ä¸€ä¸ªç›‘æ§ç³»ç»Ÿæ•°æ®çš„æ¡†æ¶</p>
<p>yamlé…ç½®ï¼š</p>
<pre><code># actuaotorç›‘æ§è®¾ç½®
management:
  # server:
    # port: 8001
  endpoints:
    # enabled-by-default: æ§åˆ¶æ˜¯å¦éƒ½é»˜è®¤å¼€å¯
    web:  # è¿™é‡Œé…ç½®jmxå°±æ˜¯å¦å¤–ä¸€ç§äº†ï¼Œæˆ‘ä»¬è¿™æ˜¯é’ˆå¯¹
      exposure:
        # é»˜è®¤å€¼è®¿é—®health,infoç«¯ç‚¹ï¼Œç”¨*å¯ä»¥åŒ…å«å…¨éƒ¨ç«¯ç‚¹ï¼Œè¿™ä¸ªä¸è®¾ç½®çš„è¯åªè®¾ç½®enabledè¿˜æ˜¯çœ‹ä¸åˆ°è¿™äº›æŒ‡æ ‡
        include: &quot;*&quot;
        # ä¿®æ”¹è®¿é—®è·¯å¾„
      base-path: /actuator
  endpoint:
    shutdown:   # shutdown caches beans ç­‰ç®—æ˜¯idã€‚é™¤äº†shutdownå…¶ä½™çš„éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œ
      enabled: true
    health:
      show-details: ALWAYS # è·å¾—å¥åº·æ£€æŸ¥ä¸­æ‰€æœ‰æŒ‡æ ‡çš„è¯¦ç»†ä¿¡æ¯
    loggers:
      enabled: true
    beans:
      enabled: true
      cache:
        time-to-live: 10s   # é…ç½®è¯¥endpoint ç¼“å­˜æ—¶é—´
</code></pre>
<p>å¦‚æœï¼ˆè·¨åŸŸè¯·æ±‚æ—¶ï¼‰OriginæŒ‡å®šçš„æºï¼Œä¸åœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„HTTPå›åº”ã€‚æµè§ˆå™¨å‘ç°ï¼Œè¿™ä¸ªå›åº”çš„å¤´ä¿¡æ¯æ²¡æœ‰åŒ…å«Access-Control-Allow-Originå­—æ®µï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œå°±çŸ¥é“å‡ºé”™äº†ï¼Œä»è€ŒæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢«XMLHttpRequestçš„onerrorå›è°ƒå‡½æ•°æ•è·ã€‚æ³¨æ„ï¼Œè¿™ç§é”™è¯¯æ— æ³•é€šè¿‡çŠ¶æ€ç è¯†åˆ«ï¼Œå› ä¸ºHTTPå›åº”çš„çŠ¶æ€ç æœ‰å¯èƒ½æ˜¯200ã€‚</p>

  </div>
  <div id=""></div>
</div>

<script>
  
Fancybox.bind('[data-fancybox="fancybox-gallery-img"]', {
  dragToClose: true,
  Toolbar: true,
  closeButton: "top",
  Image: {
    zoom: true,
  },
  on: {
    initCarousel: (fancybox) => {
      const slide = fancybox.Carousel.slides[fancybox.Carousel.page];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
    "Carousel.change": (fancybox, carousel, to, from) => {
      const slide = carousel.slides[to];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
  },
});
</script>

<style>
    #noneimg img {
        display: none;
        z-index: 9999;
        /* width: 600px !important; */
        min-width: 0%;
        max-width: 90%;
        max-height: 80%;
        border-radius: 0px;
        position: fixed;
        box-shadow: 0 0 0px #c3c3c300 !important;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto !important;
    }

    @media screen and (max-width:600px) {
        #noneimg img {
            max-width: 88%
        }
    }
</style>

    <div class="post-paging">
    
    <a href="/2024/01/08/LSS/spring/">
        <div class="post-paging-last">
            <span>ä¸Šä¸€ç¯‡</span>
            <p>Spring</p>
        </div>
    </a>
    

    
    <a href="/2024/01/08/LSS/springcloud/">
        <div class="post-paging-next">
            <span>ä¸‹ä¸€ç¯‡</span>
            <p>Spring Cloud</p>
        </div>
    </a>
    
</div>
</div>
		
<div class="footer">
	<div class="Copyright">
		Â©2024 By SoftLipa. ä¸»é¢˜ï¼š<a
			style="text-decoration: none;display: contents; color: #898F9F;"
			target="_blank" rel="noopener" href="https://github.com/79e/hexo-theme-quiet">Quiet</a>
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
		</a>
		
	</div>
</div>

<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            transition: border .5s;
            border: 1px solid rgba(18, 24, 58, 0.06);

            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari å’Œ Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $( '#js-go_top' )
	.gotoTop( {
		offset: 500,
		speed: 300,
		animationShow: {
			'transform': 'translate(0,0)',
			'transition': 'transform .5s ease-in-out'
		},
		animationHide: {
			'transform': 'translate(100px,0)',
			'transition': 'transform .5s ease-in-out'
		}
	} );
</script>


    <!-- Gitalk -->
    <script>
        const data = '{"clientID":"02b3c","clientSecret":"adfc7b4","repo":"gimment","owner":"duneng","admin":"duneng"}'
        const gitalk = new Gitalk({
            ...JSON.parse( data),
            id:location.pathname,
            distractionFreeMode:false
        })
        
        if(Boolean('false')){
            gitalk.render('gitalk-container')
        }
    </script>

<script>
	console.log('\n %c Hexo-Quiet ä¸»é¢˜ %c https://github.com/79e/hexo-theme-quiet \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
</script>
	</body>
</html>

