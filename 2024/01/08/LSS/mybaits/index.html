<!DOCTYPE html>
<html>
	<head>
		
<title>Mybatis-9.28-ğŸ§ </title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/dragon.ico">

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="java,mybatis,">
<meta name="description" content="mybatiså­¦ä¹ è¿‡ç¨‹">


<script src="/js/jquery.min.js"></script>


<script src="/js/index.js"></script>


<script src="/js/fancybox.umd.js"></script>


<script src="/js/fancybox-images.js"></script>


<script src="/js/gitalk.min.js"></script>


<script src="/js/hljs.min.js"></script>
 
<script>hljs.highlightAll();</script>

	<meta name="generator" content="Hexo 6.3.0"></head>

	<body>
		
	<div class="header">
		<div class="header-top" id="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/dragon.png" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										ä¸»é¡µ
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										æ–‡æ¡£
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/categories">
										åˆ†ç±»
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/tags">
										æ ‡ç­¾
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/links">
										å‹æƒ…é“¾æ¥
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/about">
										æˆ‘
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>SoftLipa</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">ä¸»é¡µ</a>
        </li>
        
        <li>
            <a href="/archives">æ–‡æ¡£</a>
        </li>
        
        <li>
            <a href="/categories">åˆ†ç±»</a>
        </li>
        
        <li>
            <a href="/tags">æ ‡ç­¾</a>
        </li>
        
        <li>
            <a href="/links">å‹æƒ…é“¾æ¥</a>
        </li>
        
        <li>
            <a href="/about">æˆ‘</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
        </a>
        
    </div>
</div>
<div class='shelter'>
</div>
<style>
    .shelter{
        background-color: #333;
        opacity:0.5;
        cursor: pointer;
        display: none; 
        position: fixed;
        left: 0;
        top: 0; 
        right: 0;
        bottom: 0;
        z-index: 1998;
    }
    .sidebar {
        width: 66%;
        height: 100%;
        position: fixed;
        top: 0;
        right: -100%;
        bottom: 0;
        background: #fff;
        z-index: 1999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815);
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $( function () {
	$( '.h-right-close>svg' )
		.click( function () {
			$( '.sidebar' )
				.animate( {
					right: "0"
				}, 500 );
			$( '.shelter' )
				.fadeIn( "slow" )
		} );
	$( '.shelter' )
		.click( function ( e ) {
			$( '.sidebar' )
				.animate( {
					right: "-100%"
				}, 500 );
			$( '.shelter' )
				.fadeOut( "slow" )
		} )
} )

</script>

<div class="post">
    <div class="post-header-background post-header-img"
    style="background: url('https://tu.ltyuanfang.cn/api/fengjing.php')" 
>
    <div class="post-header-background-content">
        <ul class="post-header-tag">
            
            
            <li><a href="/tags/java">java</a></li>
            
            <li><a href="/tags/mybatis">mybatis</a></li>
            
            
        </ul>
        
        <h1>Mybatis-9.28</h1>
        <div class="post-header-info">
            <div class="post-header-info-author">
                
                    <svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
                        <path
                            d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
                            p-id="2902" fill="#ffffff"></path>
                    </svg>
                    
                <span class="post-header-info-author-text"> <a href="../../about">SoftLipa</a></span>
                <div class="post-header-info-author-categories">
                    
                         <a href="../../categories/java/" target="_blank" >java</a>
                    
                </div>
                <p>2024-01-08 09:33:36</p>
            </div>
        </div>
    </div>
</div>
    <div class="post-content" id="content">
  
  <div id="article" class="post-content-info">
    

    <h3 id="Mybatis-9-28"><a href="#Mybatis-9-28" class="headerlink" title="Mybatis-9.28"></a>Mybatis-9.28</h3><h3 id="1ç®€ä»‹"><a href="#1ç®€ä»‹" class="headerlink" title="1ç®€ä»‹"></a>1ç®€ä»‹</h3><p>ç¯å¢ƒ:</p>
<p>JDK1.8 Mysql 5.7 maven 3.6.1 IDEA</p>
<p>å›é¡¾ï¼š</p>
<p>JDBC MySQL maven junit</p>
<p>æ¡†æ¶ï¼šé…ç½®æ–‡ä»¶ï¼Œçœ‹å®˜æ–¹æ–‡æ¡£</p>
<h5 id="1-1ä»€ä¹ˆæ˜¯Mybatis"><a href="#1-1ä»€ä¹ˆæ˜¯Mybatis" class="headerlink" title="1.1ä»€ä¹ˆæ˜¯Mybatis"></a>1.1ä»€ä¹ˆæ˜¯Mybatis</h5><p><strong>æŒä¹…å±‚æ¡†æ¶ï¼Œ</strong>å®ƒæ”¯æŒè‡ªå®šä¹‰ SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis å…é™¤äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç ä»¥åŠè®¾ç½®å‚æ•°å’Œè·å–ç»“æœé›†çš„å·¥ä½œã€‚MyBatis å¯ä»¥é€šè¿‡ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸå§‹ç±»å‹ã€æ¥å£å’Œ Java POJOï¼ˆPlain Old Java Objectsï¼Œæ™®é€šè€å¼ Java å¯¹è±¡ï¼‰ä¸ºæ•°æ®åº“ä¸­çš„è®°å½•ã€‚</p>
<p>mavenä»“åº“</p>
<pre><code>&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
    &lt;version&gt;3.5.2&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h5 id="1-2æŒä¹…åŒ–"><a href="#1-2æŒä¹…åŒ–" class="headerlink" title=".1.2æŒä¹…åŒ–"></a>.1.2æŒä¹…åŒ–</h5><p>æŒä¹…åŒ–å°±æ˜¯å°†ç¨‹åºçš„æ•°æ®åœ¨æŒä¹…çŠ¶æ€å’Œç¬æ—¶çŠ¶æ€è½¬åŒ–çš„è¿‡ç¨‹</p>
<p>â‘ ä¸èƒ½ä¸¢æ‰ä¸€äº›å¯¹è±¡</p>
<p>â‘¡å†…å­˜å¤ªè´µ</p>
<h5 id="1-3æŒä¹…å±‚"><a href="#1-3æŒä¹…å±‚" class="headerlink" title="1.3æŒä¹…å±‚"></a>1.3æŒä¹…å±‚</h5><p>å®ŒæˆæŒä¹…åŒ–å·¥ä½œçš„ä»£ç å—ï¼Œå±‚ç•Œé™ååˆ†æ˜æ˜¾ã€‚</p>
<h5 id="1-4ä¸ºä»€ä¹ˆéœ€è¦"><a href="#1-4ä¸ºä»€ä¹ˆéœ€è¦" class="headerlink" title="1.4ä¸ºä»€ä¹ˆéœ€è¦"></a>1.4ä¸ºä»€ä¹ˆéœ€è¦</h5><p>sqlå’Œä»£ç çš„åˆ†ç¦»,æä¾›äº†å¯ç»´æŠ¤æ€§</p>
<h3 id="2-ç¬¬ä¸€ä¸ªMybatisç¨‹åº"><a href="#2-ç¬¬ä¸€ä¸ªMybatisç¨‹åº" class="headerlink" title="2.ç¬¬ä¸€ä¸ªMybatisç¨‹åº"></a>2.ç¬¬ä¸€ä¸ªMybatisç¨‹åº</h3><h5 id="2-1æ­å»ºç¯å¢ƒ"><a href="#2-1æ­å»ºç¯å¢ƒ" class="headerlink" title="2.1æ­å»ºç¯å¢ƒ"></a>2.1æ­å»ºç¯å¢ƒ</h5><p>åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼š</p>
<pre><code>CREATE DATABASE mybatis;
USE mybatis;

CREATE TABLE user(
id INT(20) NOT NULL PRIMARY KEY,
last_name VARCHAR(30) DEFAULT NULL,
pwd VARCHAR(30) DEFAULT NULL
)ENGINE=INNODB DEFAULT CHARSET=utf8;

INSERT INTO user(id, last_name, pwd) VALUES
(&#39;1&#39;, &#39;Rose&#39;, &#39;123456&#39;),
(&#39;2&#39;, &#39;Jack&#39;, &#39;123456&#39;),
(&#39;3&#39;, &#39;Luffy&#39;, &#39;123456&#39;)
</code></pre>
<p>1.æ–°å»ºä¸€ä¸ªç©º<strong>maven</strong>é¡¹ç›®</p>
<p>mavençš„æ ¸å¿ƒæ€æƒ³ï¼š<strong>çº¦å®šå¤§äºé…ç½®</strong>ã€‚ Mavenä¼šè§„å®šå¦‚ä½•ç¼–å†™Javaä»£ç </p>
<p>2.åˆ é™¤src</p>
<p>3.å¯¼å…¥mavenä¾èµ–</p>
<pre><code>&lt;dependencies&gt;
        &lt;!--MySqlé©±åŠ¨--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;5.1.6&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!--Mybatis--&gt;
        &lt;!-- --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
            &lt;version&gt;3.5.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre>
<h5 id="2-2-åˆ›å»ºæ¨¡å—"><a href="#2-2-åˆ›å»ºæ¨¡å—" class="headerlink" title="2.2 åˆ›å»ºæ¨¡å—"></a>2.2 åˆ›å»ºæ¨¡å—</h5><p>ç¼–å†™mybatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ â€“æ­¤æ­¥éª¤å‘½åæ—¶æ³¨æ„ï¼Œåé¢æ„å»ºSqlSessionFactoryæ—¶éœ€è¦ç”¨åˆ°æ–‡ä»¶è·¯å¾„</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
    &lt;!--ç¯å¢ƒ--&gt;
    &lt;environments default=&quot;development&quot;&gt;
        &lt;environment id=&quot;development&quot;&gt;
            &lt;transactionManager type=&quot;JDBC&quot;/&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&quot;/&gt;
                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
                &lt;property name=&quot;password&quot; value=&quot;woaini123&quot;/&gt;
            &lt;/dataSource&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;
  &lt;!--æ³¨æ„æ­¤å¤„è¿˜æœ‰mappers--&gt;
&lt;/configuration&gt;
</code></pre>
<p>ç¼–å†™Mybatiså·¥å…·ç±»</p>
<pre><code>    //æå‡ä½œç”¨åŸŸ
    private static SqlSessionFactory sqlSessionFactory;
    static &#123;
        try &#123;
            //ä½¿ç”¨Mybatisç¬¬ä¸€æ­¥ï¼šè·å–sqlSessionFactoryå¯¹è±¡
            String resource = &quot;mybatis-config.xml&quot;;
            InputStream  inputStream = Resources.getResourceAsStream(resource);
            sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
        &#125; catch (IOException e) &#123;
            e.printStackTrace();
        &#125;
    &#125;
    /*
    å·²ç»æœ‰äº†sqlSessionFactory,åˆ™å¯ä»¥è·å–SqlSessionå®ä¾‹
    SqlSessionå®Œå…¨åŒ…å«äº†é¢å‘æ•°æ®åº“æ‰§è¡ŒSQLå‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰æ–¹æ³•
     */
    public static SqlSession getSqlSession() &#123;
        return sqlSessionFactory.openSession();

    &#125;
</code></pre>
<h5 id="2-3ç¼–å†™ä»£ç "><a href="#2-3ç¼–å†™ä»£ç " class="headerlink" title="2.3ç¼–å†™ä»£ç "></a>2.3ç¼–å†™ä»£ç </h5><p>java.com.xx.ä¸‹åˆ›å»ºä¸€pojoåŒ… å†åˆ›å»ºUserç±»</p>
<p>å®ä½“ç±»ï¼šUserç±»ï¼Œå¹¶åˆ›å»ºå…¶æ— å‚ã€å…¨å‚æ„é€ æ–¹æ³•ï¼Œä¸setå’Œgetæ–¹æ³•</p>
<p>Daoæ¥å£ <strong>æ­¤å¤„æ³¨æ„æ‰§è¡ŒSQLè¯­å¥è¿”å›çš„ç±»å‹æ˜¯ä¸æ–¹æ³•ç±»å‹ä¸€è‡´çš„</strong></p>
<pre><code>public interface UserDao &#123;
    List&lt;User&gt; getUserList();
&#125;
</code></pre>
<p>æ¥å£å®ç°ç±» ä¸€ä¸ªMapperé…ç½®æ–‡ä»¶ï¼ˆéšç€è¿™ä¸€æ¥å£ç±»ï¼Œè§ä¸‹ä»£ç ä¸­namespace)</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;!--namespace=ç»‘å®šä¸€ä¸ªå¯¹åº”çš„Dao/Mapperæ¥å£--&gt;
&lt;mapper namespace=&quot;com.fan.dao.UserDao&quot;&gt;
    &lt;!--select id å¯¹åº”æ–¹æ³•å  resultTypeï¼ˆmap) è¿”å›ç»“æœ--&gt;
    &lt;select id=&quot;getUserList&quot; resultType=&quot;com.fan.pojo.User&quot;&gt;
        select * from mybatis.user;
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre>
<h5 id="2-4æµ‹è¯•"><a href="#2-4æµ‹è¯•" class="headerlink" title="2.4æµ‹è¯•"></a>2.4æµ‹è¯•</h5><p>æ³¨æ„ç‚¹ï¼šorg.apache.ibatis.binding.BindingException: Type interface com.fan.dao.UserDao is not known to the MapperRegistry.</p>
<p><strong>MapperRegistryæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œmappers</p>
<pre><code>&lt;mappers&gt;
        &lt;mapper resource=&quot;ç»å¯¹è·¯å¾„ï¼Œè§†æƒ…å†µè€Œå®š&quot;/&gt;
    &lt;/mappers&gt;
</code></pre>
<p>Mavenä¸­å¯¼ä¸å‡º ava.lang.<strong>ExceptionInInitializerError at</strong></p>
<p>åœ¨çˆ¶å·¥ç¨‹å’Œå­å·¥ç¨‹çš„pomä¸­æ·»åŠ </p>
<pre><code>    &lt;build&gt;
        &lt;resources&gt;
            &lt;resource&gt;
                &lt;directory&gt;src/main/resources&lt;/directory&gt;
                &lt;includes&gt;
                    &lt;include&gt;**/*.properties&lt;/include&gt;
                    &lt;include&gt;**/*.xml&lt;/include&gt;
                &lt;/includes&gt;
                &lt;filtering&gt;true&lt;/filtering&gt;
            &lt;/resource&gt;
            &lt;resource&gt;
                &lt;directory&gt;src/main/java&lt;/directory&gt;
                &lt;includes&gt;
                    &lt;include&gt;**/*.properties&lt;/include&gt;
                    &lt;include&gt;**/*.xml&lt;/include&gt;
                &lt;/includes&gt;
                &lt;filtering&gt;true&lt;/filtering&gt;
            &lt;/resource&gt;
        &lt;/resources&gt;
    &lt;/build&gt;
</code></pre>
<p>junit<strong>æµ‹è¯•</strong></p>
<pre><code>    @Test
    public void test() &#123;
       //ç¬¬ä¸€æ­¥ï¼šè·å¾—SqlSessionå¯¹è±¡
        SqlSession sqlSession = MybatisUtils.getSqlSession();
        //æ‰§è¡ŒSql æ–¹å¼ä¸€ getMapper
        UserDao userDao = sqlSession.getMapper(UserDao.class);
        List&lt;User&gt; userList = userDao.getUserList();
        for (User user: userList) &#123;
            System.out.println(user);
        &#125;
        //å…³é—­SqlSession
        sqlSession.close();
    &#125;
</code></pre>
<p>å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼š</p>
<p>1.é…ç½®æ–‡ä»¶æ²¡æœ‰æ³¨å†Œ</p>
<p>2.ç»‘å®šæ¥å£é”™è¯¯</p>
<p>3.æ–¹æ³•åä¸å¯¹ ä»vvä»v</p>
<p>4.è¿”å›ç±»å‹ä¸å¯¹</p>
<p>5.Mavenå¯¼å‡ºèµ„æºé—®é¢˜</p>
<p>6.æ‰‹æ»‘åœ¨é…ç½®æ–‡ä»¶å°¤å…¶æ˜¯æ•°æ®åº“é…ç½®å¤„å¤šæ•²äº†ä¸€ä¸ªç©ºæ ¼</p>
<h3 id="3-CRUD"><a href="#3-CRUD" class="headerlink" title="3.CRUD"></a>3.CRUD</h3><h4 id="1-namespace"><a href="#1-namespace" class="headerlink" title="1.namespace"></a>1.namespace</h4><p>namespaceä¸­çš„åŒ…åè¦ä¸Dao&#x2F;Mapperä¸­æ¥å£åŒ…åä¸€è‡´</p>
<h4 id="2-select"><a href="#2-select" class="headerlink" title="2.select"></a>2.select</h4><p>é€‰æ‹©æŸ¥è¯¢è¯­å¥ï¼š</p>
<ul>
<li>id:å¯¹åº”namespaceä¸­çš„æ–¹æ³•å</li>
<li>resultType:Sqlè¯­å¥æ‰§è¡Œçš„è¿”å›å€¼</li>
<li>paramaterTypeï¼š ä¼ é€’çš„å‚æ•°ï¼ˆä¼¼ä¹ä¸å†™ä¹Ÿå¯è¿è¡Œï¼‰</li>
</ul>
<p>å¥—è·¯ï¼š</p>
<p>1.ç¼–å†™æ¥å£ æ¥å£å®šä¹‰çš„æ˜¯ä¸€ç»„è§„åˆ™ï¼Œå®ç°ç±»å¯ä»¥å®ç°ç»§æ‰¿å¤šä¸ªæ¥å£</p>
<pre><code>User getUserById(int id); //æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·
</code></pre>
<p>2.ç¼–å†™å¯¹åº”çš„mapperä¸­çš„sqlè¯­å¥</p>
<pre><code>&lt;select id=&quot;getUserById&quot; parameterType=&quot;int&quot; resultType=&quot;com.fan.pojo.User&quot;&gt;
        select * from mybatis.user where id = #&#123;id&#125;
    &lt;/select&gt;
</code></pre>
<p>3.æµ‹è¯•</p>
<pre><code>public void getUserById()&#123;
        //æŸ¥è¯¢ä¸€è¡Œæµ‹è¯•
        SqlSession sqlSession = MybatisUtils.getSqlSession();
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
       User user = mapper.getUserById(1);
        System.out.println(user);
        sqlSession.close();
    &#125;
</code></pre>
<h4 id="3-insert"><a href="#3-insert" class="headerlink" title="3.insert"></a>3.insert</h4><p>é€šè¿‡ä¸»é”®æ·»åŠ ç”¨æˆ· ç”¨æˆ·éœ€è¦å®Œæ•´çš„ä¿¡æ¯</p>
<pre><code>int addUser(User user);
&lt;!--    å¯¹è±¡ä¸­çš„å±æ€§å¯ç›´æ¥å–å‡º--&gt;
    &lt;insert id=&quot;addUser&quot; parameterType=&quot;com.fan.pojo.User&quot;&gt;
        insert into mybatis.user(id, last_name, pwd) values (#&#123;id&#125;, #&#123;last_name&#125;, #&#123;pwd&#125;);
    &lt;/insert&gt;
</code></pre>
<p>å¢åˆ æ”¹è¦æäº¤äº‹åŠ¡ æ³¨æ„int res</p>
<pre><code>        SqlSession sqlSession = MybatisUtils.getSqlSession();
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        int res = mapper.addUser(new User(4, &quot;ç†åŒ–ç”Ÿ&quot;, &quot;123333&quot; ));
        if (res &gt; 0) &#123;
            System.out.println(&quot;æ’å…¥æˆåŠŸ&quot;);
        &#125;
        //ä¸€å®šè¦æäº¤äº‹åŠ¡
        sqlSession.commit();
//        mapper.addUser(new User(4, &quot;ç†åŒ–ç”Ÿ&quot;, &quot;123333&quot;));è¿™æ ·æ’å…¥æ²¡æœ‰ç”¨
        sqlSession.close();
</code></pre>
<h4 id="4-update-ç±»æ¯”æ’å…¥"><a href="#4-update-ç±»æ¯”æ’å…¥" class="headerlink" title="4.update ç±»æ¯”æ’å…¥"></a>4.update ç±»æ¯”æ’å…¥</h4><p>æ­¤å¤„æ˜¯æ•´è¡Œæ”¹åŠ¨</p>
<pre><code>int updateUser(User user);
&lt;!--set xxx--&gt; 
&lt;update id=&quot;updateUser&quot; parameterType=&quot;com.fan.pojo.User&quot;&gt;
        update mybatis.user set last_name=#&#123;last_name&#125;, pwd=#&#123;pwd&#125; where id = #&#123;id&#125;;
    &lt;/update&gt;
public void updateUser() &#123;
        SqlSession sqlSession = MybatisUtils.getSqlSession();
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        mapper.updateUser(new User(4, &quot;lihua&quot;, &quot;123333&quot;));
        //ä¾ç„¶éœ€è¦æäº¤äº‹åŠ¡
        sqlSession.commit();
        sqlSession.close();
    &#125;
</code></pre>
<h4 id="5-delete"><a href="#5-delete" class="headerlink" title="5.delete"></a>5.delete</h4><pre><code>int deleteUser(int id);
&lt;delete id=&quot;deleteUser&quot; parameterType=&quot;int&quot;&gt;
        delete from mybatis.user where id = #&#123;id&#125;;
    &lt;/delete&gt;
public void deleteUser() &#123;
        SqlSession sqlSession = MybatisUtils.getSqlSession();
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        mapper.deleteUser(4);
        sqlSession.commit();
        sqlSession.close();
    &#125;
</code></pre>
<p>æ³¨æ„ç‚¹ï¼š</p>
<p>å¢åˆ æ”¹éœ€è¦å®ç°äº‹åŠ¡ sqlSession.commit();</p>
<h4 id="6-åˆ†æé”™è¯¯"><a href="#6-åˆ†æé”™è¯¯" class="headerlink" title="6.åˆ†æé”™è¯¯"></a>6.åˆ†æé”™è¯¯</h4><p>namespace &#x3D;åŒ…å .</p>
<p>resourceä¸­**æ ¸å¿ƒé…ç½®æ–‡ä»¶ç»‘å®šMapperç”¨&#x2F;,**æ ¸å¿ƒé…ç½®æ–‡ä»¶å¿…é¡»ç¬¦åˆè§„èŒƒ</p>
<p>æ ‡ç­¾è¦ä¸€ä¸€å¯¹åº”ä¸èƒ½åŒ¹é…é”™</p>
<p>è¯»é”™ä»åå‘å‰è¯»</p>
<p>Nulllpointer â€“</p>
<p><strong>ä¸»é”®ä¸èƒ½å†²çª</strong></p>
<p>è¾“å‡ºçš„xmlæ–‡ä»¶ä¸­å­˜åœ¨ä¹±ç é—®é¢˜ mavenèµ„æºå¯¼å‡ºé—®é¢˜</p>
<h4 id="7-ä¸‡èƒ½çš„Map"><a href="#7-ä¸‡èƒ½çš„Map" class="headerlink" title="7.ä¸‡èƒ½çš„Map"></a>7.ä¸‡èƒ½çš„Map</h4><p>å‡è®¾å®ä½“ç±»ä¸­æˆ–æ•°æ®åº“ä¸­çš„è¡¨ï¼Œå­—æ®µæˆ–å‚æ•°è¿‡å¤šï¼Œåº”è€ƒè™‘ä½¿ç”¨Map</p>
<p>æ²¡æœ‰å®ä½“ç±»é™å®šçš„ä¸¥æ ¼ å­—æ®µè®¾ç½®#{}ï¼Œä¸å¿…åœ¨æ„ä¸€ä¸€å¯¹åº”</p>
<pre><code>int addUser2(Map&lt;String, Object&gt; map);
&lt;insert id=&quot;addUser&quot; parameterType=&quot;map&quot;&gt;
        insert into mybatis.user(id, pwd) values (#&#123;userid&#125;, #&#123;password&#125;);
    &lt;/insert&gt;
public void addUser2() &#123;
        SqlSession sqlSession = MybatisUtils.getSqlSession();
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();
//        map.put(&quot;userid&quot;, 5);
//        map.put(&quot;userName&quot;, &quot;JAck&quot;);
        //å¦‚æœåªä¿®æ”¹å¯†ç 

        map.put(&quot;password&quot;, &quot;233232&quot;);
        mapper.addUser2(map);
        sqlSession.close();
    &#125;
</code></pre>
<p>Mapä¼ é€’å‚æ•°ï¼Œç›´æ¥åœ¨sqlä¸­å–å‡ºKeyå³å¯ã€‚[paramaterType&#x3D;â€mapâ€]</p>
<p>å¯¹è±¡ä¼ é€’å‚æ•°ï¼Œç›´æ¥åœ¨sqlä¸­å–å¯¹è±¡çš„å±æ€§ã€‚[paramaterType&#x3D;â€Objectâ€]</p>
<p>åªæœ‰ä¸€ä¸ªåŸºæœ¬ç±»å‹å‚æ•°çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥åœ¨sqlä¸­å–åˆ°ã€‚</p>
<p>å¤šä¸ªå‚æ•°ç”¨Mapï¼Œ<strong>æˆ–è€…æ³¨è§£</strong></p>
<h4 id="8-æ€è€ƒé¢˜-æ¨¡ç³ŠæŸ¥è¯¢ï¼ï¼ï¼"><a href="#8-æ€è€ƒé¢˜-æ¨¡ç³ŠæŸ¥è¯¢ï¼ï¼ï¼" class="headerlink" title="8.æ€è€ƒé¢˜ æ¨¡ç³ŠæŸ¥è¯¢ï¼ï¼ï¼"></a>8.æ€è€ƒé¢˜ æ¨¡ç³ŠæŸ¥è¯¢ï¼ï¼ï¼</h4><p>æ¨¡ç³ŠæŸ¥è¯¢æ€ä¹ˆå†™ï¼Ÿ</p>
<p>1.Javaä»£ç æ‰§è¡Œæ—¶ï¼Œä¼ é€’é€šé…ç¬¦%</p>
<pre><code>List&lt;User&gt; getUserLike(String value);
</code></pre>
<p>2.åœ¨sqlæ‹¼æ¥ä¸­ä½¿ç”¨é€šé…ç¬¦</p>
<pre><code>select * from mybatis.user where last_name like &quot;%&quot;#&#123;value&#125;&quot;%&quot;;
&lt;select id=&quot;getUserLike&quot; resultType=&quot;com.fan.pojo.User&quot;&gt;
        select * from mybatis.user where last_name like #&#123;value&#125;;
    &lt;/select&gt;
 public void getUserLike() &#123;
        SqlSession sqlSession = MybatisUtils.getSqlSession();
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        //%ä¸€å®šè¦åŠ  è”ç³»æ•°æ®åº“æŸ¥è¯¢ä¸­çš„like
        List&lt;User&gt; userList = mapper.getUserLike(&quot;%ç†%&quot;);
        for (User user:userList) &#123;
            System.out.println(user);
        &#125;
        sqlSession.close();


    &#125;
</code></pre>
<h3 id="4-é…ç½®è§£æ"><a href="#4-é…ç½®è§£æ" class="headerlink" title="4.é…ç½®è§£æ"></a>4.é…ç½®è§£æ</h3><h4 id="1-æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#1-æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="1.æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>1.æ ¸å¿ƒé…ç½®æ–‡ä»¶</h4><ul>
<li>mybatis-config.xml (å› æ­¤ä¸‹é¢çš„è¯¸å¤šæ“ä½œå‡ ä¹éƒ½æ˜¯åœ¨mybatis-configä¸­)</li>
<li>æ³¨æ„å…¶æ ‡ç­¾å±æ€§å¥³</li>
<li>Mybatisçš„é…ç½®æ–‡ä»¶åŒ…å«äº†å½±å“Mybatisè¡Œä¸ºçš„è®¾ç½®å’Œå±æ€§ä¿¡æ¯</li>
</ul>
<pre><code>configurationï¼ˆé…ç½®ï¼‰
propertiesï¼ˆå±æ€§ï¼‰
settingsï¼ˆè®¾ç½®ï¼‰
typeAliasesï¼ˆç±»å‹åˆ«åï¼‰
typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰
objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰
pluginsï¼ˆæ’ä»¶ï¼‰
environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰
environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰
transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰
dataSourceï¼ˆæ•°æ®æºï¼‰
databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰
mappersï¼ˆæ˜ å°„å™¨ï¼‰
</code></pre>
<h4 id="2-ç¯å¢ƒé…ç½®-environments"><a href="#2-ç¯å¢ƒé…ç½®-environments" class="headerlink" title="2.ç¯å¢ƒé…ç½®(environments)"></a>2.ç¯å¢ƒé…ç½®(environments)</h4><p>Mybatiså¯ä»¥é…ç½®æˆé€‚åº”å¤šç§ç¯å¢ƒ</p>
<p>ä¸è¿‡è¦è®°ä½ï¼šå°½ç®¡å¯ä»¥é…ç½®å¤šä¸ªç¯å¢ƒï¼Œä½†æ¯ä¸ªSqlSessionFactoryå®ä¾‹åªèƒ½é€‰æ‹©ä¸€ç§ç¯å¢ƒ</p>
<p>Mybatisé»˜è®¤çš„äº‹åŠ¡ç®¡ç†å™¨(transaction)å°±æ˜¯JDBCï¼Œè¿æ¥æ± (datasource)ï¼šPOOLED</p>
<h4 id="3-å±æ€§ï¼ˆproperties"><a href="#3-å±æ€§ï¼ˆproperties" class="headerlink" title="3.å±æ€§ï¼ˆproperties)"></a>3.å±æ€§ï¼ˆproperties)</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡propertieså±æ€§æ¥å®ç°å¼•ç”¨é…ç½®æ–‡ä»¶</p>
<p>è¿™äº›å±æ€§å¯ä»¥åœ¨å¤–éƒ¨è¿›è¡Œé…ç½®ï¼Œå¹¶å¯ä»¥è¿›è¡ŒåŠ¨æ€æ›¿æ¢ã€‚ä½ æ—¢å¯ä»¥åœ¨å…¸å‹çš„ Java å±æ€§æ–‡ä»¶ä¸­é…ç½®è¿™äº›å±æ€§ï¼Œä¹Ÿå¯ä»¥åœ¨ properties å…ƒç´ çš„å­å…ƒç´ ä¸­è®¾ç½®ã€‚ã€db.propertiesã€‘</p>
<h5 id="1-ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶"><a href="#1-ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶" class="headerlink" title="1.ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶"></a>1.ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶</h5><pre><code>driver=com.mysql.jdbc.Driver
#ä½¿ç”¨MySQL8.0+ è¿˜éœ€æ·»åŠ æ—¶åŒºçš„é…ç½®ï¼š &amp;serverTimezone=Asia/Shanghai
url=jdbc:mysql://localhost:3306/mybatis?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8
username = root
password = woaini123
</code></pre>
<h5 id="2-å¼•å…¥"><a href="#2-å¼•å…¥" class="headerlink" title="2.å¼•å…¥"></a>2.å¼•å…¥</h5><pre><code>æ–¹å¼ä¸€ 
               &lt;properties resource=&quot;db.properties&quot;/&gt;
               &lt;property name=&quot;driver&quot; value=&quot;$&#123;driver&#125;&quot;/&gt;
                &lt;property name=&quot;url&quot; value=&quot;$&#123;url&#125;&quot;/&gt;
                &lt;property name=&quot;username&quot; value=&quot;$&#123;username&#125;&quot;/&gt;
                &lt;property name=&quot;password&quot; value=&quot;$&#123;password&#125;&quot;/&gt;
æ–¹å¼äºŒ
&lt;properties resource=&quot;db.properties&quot;&gt;
        &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
        &lt;property name=&quot;pwd&quot; value=&quot;woaini123&quot;/&gt;
&lt;/properties&gt;
</code></pre>
<p>â‘ å¦å»ºdb.propertiesï¼Œå±æ€§å…¨å†™</p>
<p>â‘¡db.propertiesä¸­å†™ä¸€éƒ¨åˆ†,æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­å†™ä¸€éƒ¨åˆ†ã€‚</p>
<ul>
<li>å¯ä»¥ç›´æ¥å¼•å…¥å¤–éƒ¨æ–‡ä»¶</li>
<li>å¯ä»¥åœ¨å…¶ä¸­å¢åŠ ä¸€äº›å±æ€§é…ç½®</li>
<li>ä¸¤ä¸ªæ–‡ä»¶ä¸­åŒä¸€å­—æ®µï¼Œä¼˜å…ˆå¼•ç”¨å¤–éƒ¨é…ç½®æ–‡ä»¶</li>
</ul>
<h4 id="4-åˆ«å"><a href="#4-åˆ«å" class="headerlink" title="4.åˆ«å"></a>4.åˆ«å</h4><ul>
<li><p>ç±»å‹åˆ«åå¯ä¸º Java ç±»å‹è®¾ç½®ä¸€ä¸ªç¼©å†™åå­—</p>
</li>
<li><p>å®ƒä»…ç”¨äº XML é…ç½®ï¼Œæ„åœ¨é™ä½å†—ä½™çš„å…¨é™å®šç±»åä¹¦å†™</p>
<p>ç¬¬ä¸€ç§</p>
<pre><code>&lt;typeAliases&gt;
        &lt;typeAlias type=&quot;com.fan.pojo.User&quot; alias=&quot;User&quot;/&gt;
&lt;/typeAliases&gt;
</code></pre>
<p><strong>å¤šä¸ªç±»</strong>â€“ä¹Ÿå¯æŒ‡å®šä¸€ä¸ªåŒ…åï¼ŒMyBatisä¼šåœ¨åŒ…åä¸‹æœç´¢éœ€è¦çš„JavaBean</p>
<p>å¦‚ï¼šæ‰«æå®ä½“ç±»çš„åŒ…ï¼Œå®ƒçš„é»˜è®¤åˆ«åå°±ä¸ºè¿™ä¸ªç±»çš„ç±»åï¼Œé¦–å­—æ¯å°å†™</p>
</li>
</ul>
<pre><code>&lt;typeAliases&gt;
        &lt;package name=&quot;com.fan.pojo&quot;/&gt;
&lt;/typeAliases&gt;
</code></pre>
<p>å®ä½“ç±»è¾ƒå°‘æ—¶ï¼Œå¯ç”¨ç¬¬ä¸€ç§ã€‚è¾ƒå¤šæ—¶ï¼Œå»ºä»¥ç¬¬äºŒç§ï¼ˆä¹¦å†™æ›´ç®€ä¾¿ï¼‰</p>
<p>ç¬¬ä¸€ç§å¯ä»¥DIYåˆ«åï¼Œç¬¬äºŒç§åˆ™ä¸å¯ã€‚</p>
<p>è‹¥ç¬¬äºŒç§éè¦æ”¹ï¼Œéœ€è¦åœ¨å®ä½“ä¸Šå¢åŠ æ³¨è§£ã€‚</p>
<pre><code>@Alias(&quot;hello&quot;)
public class User &#123;&#125;
</code></pre>
<h4 id="5-è®¾ç½®"><a href="#5-è®¾ç½®" class="headerlink" title="5.è®¾ç½®"></a>5.è®¾ç½®</h4><p>Mybatisä¸­æä¸ºé‡è¦çš„è°ƒæ•´è®¾ç½®ï¼Œä¼šæ”¹å˜ MyBatis çš„è¿è¡Œæ—¶è¡Œä¸º</p>
<p><img src="/" alt="image-20210117184815972"></p>
<p><img src="/" alt="image-20210117184943681"></p>
<p>6.å…¶ä»– ç±»å‹å¤„ç†å™¨ã€å¯¹è±¡å·¥å‚ã€ç­‰æ— éœ€äº†è§£</p>
<p>pluginsæ’ä»¶:mybatis-plus</p>
<p>mybatis-generator</p>
<p>é€šç”¨mapper</p>
<h4 id="7-æ˜ å°„å™¨ï¼ˆmappers"><a href="#7-æ˜ å°„å™¨ï¼ˆmappers" class="headerlink" title="7.æ˜ å°„å™¨ï¼ˆmappers)"></a>7.æ˜ å°„å™¨ï¼ˆmappers)</h4><p>MapperRegistry:æ³¨å†Œç»‘å®šæˆ‘ä»¬çš„Mapperæ–‡ä»¶</p>
<p>æ–¹å¼ä¸€</p>
<pre><code>&lt;!--    æ¯ä¸€ä¸ªMapper.xmléƒ½éœ€è¦åœ¨Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ--&gt;
    &lt;mappers&gt;
        &lt;mapper resource=&quot;com/fan/dao/UserMapper.xml&quot;/&gt;
     &lt;/mappers&gt;
</code></pre>
<p>æ–¹å¼äºŒ é€šè¿‡classæ–¹å¼ç»‘ å®š</p>
<pre><code>    &lt;mappers&gt;
        &lt;mapper class=&quot;com.fan.dao.UserMapper&quot;/&gt;
    &lt;/mappers&gt;
</code></pre>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>æ¥å£ä¸å…¶Mapperé…ç½®æ–‡ä»¶å¿…é¡»<strong>åŒå</strong></li>
<li>æ¥å£ä¸å…¶Mapperé…ç½®æ–‡ä»¶å¿…é¡»åœ¨åŒä¸€ä¸ªåŒ…ä¸‹</li>
</ul>
<p>æ–¹å¼ä¸‰ é€šè¿‡æ‰«æåŒ…è¿›è¡Œæ³¨å…¥ç»‘å®š</p>
<pre><code>    &lt;mappers&gt;
        &lt;package name=&quot;com.fan.dao&quot;/&gt;
    &lt;/mappers&gt;
</code></pre>
<p>æ³¨æ„ç‚¹åŒä¸Š</p>
<p>å®é™…ä¸ŠæŒ‰ç…§è§„èŒƒæ“ä½œï¼Œä¸€èˆ¬éƒ½æ˜¯å†™ä¸€ä¸ªç»‘å®šä¸€ä¸ª</p>
<h4 id="8-ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"><a href="#8-ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ" class="headerlink" title="8.ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"></a>8.ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ</h4><p><img src="/" alt="image-20210117192815189"></p>
<p>ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸæ˜¯è‡³å…³é‡è¦çš„ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„å¹¶å‘é—®é¢˜ã€‚</p>
<h5 id="SqlSessionFactoryBuilderï¼š"><a href="#SqlSessionFactoryBuilderï¼š" class="headerlink" title="SqlSessionFactoryBuilderï¼š"></a>SqlSessionFactoryBuilderï¼š</h5><ul>
<li>åˆ›å»ºSQL Session Factoryåå³ä¸å†éœ€è¦</li>
<li>å±€éƒ¨å˜é‡</li>
</ul>
<h5 id="SqlSessionFactory"><a href="#SqlSessionFactory" class="headerlink" title="SqlSessionFactory:"></a>SqlSessionFactory:</h5><ul>
<li>å¯è§†ä¸ºæ•°æ®åº“è¿æ¥æ± </li>
<li>SQL Session Factoryä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹ã€</li>
<li>å› æ­¤SqlSessionFactoryçš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸ</li>
<li>æœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨ <strong>å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼</strong>ï¼Ÿï¼Ÿï¼Ÿ</li>
</ul>
<h5 id="SqlSession"><a href="#SqlSession" class="headerlink" title="SqlSession:"></a>SqlSession:</h5><ul>
<li>è¿æ¥åˆ°è¿æ¥æ± çš„ä¸€ä¸ªè¯·æ±‚</li>
<li>å› æ­¤éœ€è¦ç”¨åå…³é—­ï¼Œå¦åˆ™èµ„æºè¢«å ç”¨</li>
<li>ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸èƒ½è¢«å…±äº«ï¼Œå› æ­¤æœ€å¥½ä½œç”¨äºè¯·æ±‚æˆ–æ–¹æ³•ä¸Š</li>
<li></li>
</ul>
<h3 id="5-resultMap"><a href="#5-resultMap" class="headerlink" title="5. resultMap"></a>5. resultMap</h3><p>è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜</p>
<h4 id="1-å¼•å…¥"><a href="#1-å¼•å…¥" class="headerlink" title="1.å¼•å…¥"></a>1.å¼•å…¥</h4><pre><code> Userç±»çš„å±æ€§
    private int id;
    private String last_name;
    private String password;//æ•°æ®åº“ä¸­å¯†ç å¤„ä¸ºpwd
</code></pre>
<p>æµ‹è¯•å‡ºç°é—®é¢˜</p>
<p><img src="/" alt="image-20210118163016411"></p>
<pre><code>select * from mybatis.user where id = #&#123;id&#125;;
  æ­¤å³select id,name,pwd from ....
å¯åœ¨å¯¹åº”mapperä¸­æ”¹ä¸ºä¸Šè¿°å½¢å¼
    
</code></pre>
<p>æ­¤æ—¶Userå¤„çš„passwordä¸æ•°æ®åº“çš„pwdå†²çª</p>
<h4 id="2-resultMap-å¾ˆé‡è¦"><a href="#2-resultMap-å¾ˆé‡è¦" class="headerlink" title="2.resultMap !!!å¾ˆé‡è¦"></a>2.resultMap !!!å¾ˆé‡è¦</h4><p>ç»“æœé›†æ˜ å°„</p>
<pre><code>&lt;!--ç»“æœé›†æ˜ å°„--&gt;
&lt;!--é¦–å…ˆä¸ºè¦ä½¿ç”¨çš„resultMapæŒ‡æ˜id, ä»€ä¹ˆç±»å‹ï¼Œæ–¹ä¾¿åç»­ç»‘å®šä½¿ç”¨--&gt;
    &lt;resultMap id=&quot;UserMap&quot; type=&quot;User&quot;&gt;(ï¼ï¼ï¼æ­¤å¤„åº”å†™å®Œæ•´åœ°å€ å¦‚æ— å‘½ååˆ«å)
&lt;!--columnæ•°æ®åº“ä¸­çš„å­—æ®µï¼Œ propertå®ä½“ç±»ä¸­çš„å±æ€§--&gt;
        &lt;result column=&quot;id&quot; property=&quot;id&quot;/&gt;
        &lt;result column=&quot;last_name&quot; property=&quot;last_name&quot;/&gt;
      ä¸Šé¢ä¸¤è¡Œå¯ä»¥çœå»
        &lt;result column=&quot;pwd&quot; property=&quot;password&quot;/&gt;
    &lt;/resultMap&gt;

    &lt;select id=&quot;getUserById&quot; resultMap=&quot;UserMap&quot;&gt;
        select * from mybatis.user where id = #&#123;id&#125;;
    &lt;/select&gt;
</code></pre>
<p><code>resultMap</code> å…ƒç´ æ˜¯ MyBatis ä¸­æœ€é‡è¦æœ€å¼ºå¤§çš„å…ƒç´ ã€‚</p>
<p>ä¸€ç§æ˜ å°„</p>
<p>ResultMap çš„è®¾è®¡æ€æƒ³æ˜¯ï¼Œå¯¹ç®€å•çš„è¯­å¥åšåˆ°é›¶é…ç½®ï¼Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥ï¼Œåªéœ€è¦æè¿°è¯­å¥ä¹‹é—´çš„å…³ç³»å°±è¡Œäº†ã€‚</p>
<pre><code>ResultMap` çš„ä¼˜ç§€ä¹‹å¤„â€”â€”ä½ å®Œå…¨å¯ä»¥ä¸ç”¨æ˜¾å¼åœ°é…ç½®å®ƒä»¬ã€‚ è™½ç„¶ä¸Šé¢çš„ä¾‹å­ä¸ç”¨æ˜¾å¼é…ç½® `ResultMap
</code></pre>
<h3 id="6-æ—¥å¿—"><a href="#6-æ—¥å¿—" class="headerlink" title="6.æ—¥å¿—"></a>6.æ—¥å¿—</h3><h4 id="6-1æ—¥å¿—å·¥å‚"><a href="#6-1æ—¥å¿—å·¥å‚" class="headerlink" title="6.1æ—¥å¿—å·¥å‚"></a>6.1æ—¥å¿—å·¥å‚</h4><p>å¦‚æœä¸€ä¸ªæ•°æ®åº“æ“ä½œï¼Œå‡ºç°äº†å¼‚å¸¸æˆ‘ä»¬éœ€è¦æ’é”™ã€‚</p>
<p>æ—¥å¿—å¯ä»¥å¸®åŠ©åšè¿™ä»¶äº‹ã€‚</p>
<p>æ›¾ç»ï¼šdebug</p>
<p>ç°åœ¨ï¼šæ—¥å¿—å·¥å‚</p>
<p><img src="/" alt="image-20210118174040362"></p>
<p>SLF4J</p>
<p><strong>LOG4J</strong></p>
<p>LOG4J2</p>
<p>JDK_LOGGING</p>
<p>COMMONS_LOGGING</p>
<p><strong>STDOUT_LOGGING</strong> ï¼ˆæ ‡å‡†æ—¥å¿—è¾“å‡ºï¼Œå¯ä»¥ç›´æ¥ç”¨ï¼‰</p>
<p>NO_LOGGING</p>
<p>å…·ä½“ä½¿ç”¨å“ªä¸€æ—¥å¿—å®ç°ï¼Œåœ¨è®¾ç½®å®ç°</p>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­ä¸€å®šä¸èƒ½æœ‰ä»»ä½•é”™è¯¯ï¼Œç©ºæ ¼ã€å¤§å°å†™éƒ½ä¸å¯ã€‚</p>
<p>ï¼ˆå³æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­é…ç½®æˆ‘ä»¬çš„æ—¥å¿—ï¼‰</p>
<pre><code>    &lt;settings&gt;
      &lt;!--        æ ‡å‡†çš„æ—¥å¿—å·¥å‚å®ç°--&gt;
        &lt;setting name=&quot;logImpl&quot; value=&quot;STDOUT_LOGGING&quot;/&gt;
    &lt;/settings&gt;
</code></pre>
<p><img src="/" alt="image-20210118174849288"></p>
<h4 id="6-2-LOG4J-ï¼ˆå¤§å°å†™-ç©ºæ ¼ï¼‰"><a href="#6-2-LOG4J-ï¼ˆå¤§å°å†™-ç©ºæ ¼ï¼‰" class="headerlink" title="6.2 LOG4J ï¼ˆå¤§å°å†™ ç©ºæ ¼ï¼‰"></a>6.2 <strong>LOG4J</strong> ï¼ˆå¤§å°å†™ ç©ºæ ¼ï¼‰</h4><p>what?</p>
<ul>
<li>å¯ä»¥åˆ©ç”¨å…¶æ§åˆ¶æ—¥å¿—ä¿¡æ¯è¾“é€çš„ç›®çš„åœ°æ˜¯æ§åˆ¶å°ã€æ–‡ä»¶ã€GUIç»„ä»¶</li>
<li>ä¹Ÿå¯æ§åˆ¶æ¯æ¡æ—¥å¿—è¾“å‡ºæ ¼å¼</li>
<li>é€šè¿‡å®šä¹‰æ¯ä¸€æ¡æ—¥å¿—çš„çº§åˆ«ï¼ˆæ ¹æ®ä¸¥é‡ç¨‹åº¦ï¼‰æ›´ç»†è‡´æ§åˆ¶æ—¥å¿—ç”Ÿæˆè¿‡ç¨‹ã€‚</li>
<li>é€šè¿‡é…ç½®æ–‡ä»¶çµæ´»æ§åˆ¶ï¼Œä¸éœ€ä¿®æ”¹åº”ç”¨çš„ä»£ç </li>
</ul>
<p>1.å…ˆå¯¼å…¥log4jçš„åŒ… (åœ¨pom.xmlä¸­)</p>
<pre><code>       &lt;dependency&gt;
            &lt;groupId&gt;log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j&lt;/artifactId&gt;
            &lt;version&gt;1.2.17&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre>
<p>2log4j.properties</p>
<pre><code>#å°†ç­‰çº§ä¸ºDEBUGçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºè‡³consoleå’Œfileè¿™ä¸¤ä¸ªç›®çš„åœ°ï¼Œ
log4j.rootLogger=DEBUG,console,file
#æ§åˆ¶å°è¾“å‡ºçš„ç›¸å…³è®¾ç½®
log4j.appender.console=org.apache.log4j.ConsoleAppender
log4j.appender.console.Target=System.out
log4j.appender.console.Threshold=DEBUG
log4j.appender.console.layout=org.apache.log4j.PatternLayout
log4j.appender.console.layout.ConversionPattern=[%c]-%m%n

#æ–‡ä»¶è¾“å‡ºçš„ç›¸å…³è®¾ç½®
log4j.appender.file=org.apache.log4j.RollingFileAppender
log4j.appender.file.File=./log/fan.log
log4j.appender.file.MaxFileSize=10mb
log4j.appender.file.Threshold=DEBUG
log4j.appender.file.layout=org.apache.log4j.PatternLayout
log4j.appender.file.layout.ConversionPattern=[%p][%d&#123;yy-MM-dd&#125;][%c]%m%n

#æ—¥å¿—è¾“å‡ºçº§åˆ«
log4j.logger.org.mybatis=DEBUG
log4j.logger.java.sql=DEBUG
log4j.logger.java.sql.Statement=DEBUG
log4j.logger.java.sql.ResultSet=DEBUG
log4j.logger.java.sql.PreparedStatement=DEBUG
</code></pre>
<p>3.é…ç½®log4jä¸ºæ—¥å¿—çš„å®ç°</p>
<pre><code>    &lt;settings&gt;
        &lt;setting name=&quot;logImpl&quot; value=&quot;LOG4J&quot;/&gt;
    &lt;/settings&gt;
</code></pre>
<p>4.Log4jçš„ä½¿ç”¨ ç›´æ¥æµ‹è¯•è¿è¡Œç›¸åŒçš„æŸ¥è¯¢</p>
<p><img src="/" alt="image-20210118185913874"></p>
<h5 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h5><p>1.åœ¨è¦ä½¿ç”¨çš„ç±»ä¸­å¯¼å…¥åŒ…ï¼Œimport org.apache.log4j.Logger;</p>
<p>2.æ—¥å¿—å¯¹è±¡ï¼Œå‚æ•°ä¸ºå½“å‰ç±»çš„class</p>
<pre><code>    static Logger logger = Logger.getLogger(UserDaoTest.class);
</code></pre>
<p>3.æ—¥å¿—çº§åˆ«</p>
<pre><code>        logger.info(&quot;info:è¿›å…¥äº†testLog4j&quot;);
        logger.debug(&quot;debug:è¿›å…¥äº†testLog4j&quot;);
        logger.error(&quot;error:è¿›å…¥äº†testLog4j&quot;);
</code></pre>
<h3 id="7-åˆ†é¡µ"><a href="#7-åˆ†é¡µ" class="headerlink" title="7.åˆ†é¡µ"></a>7.åˆ†é¡µ</h3><p><strong>why?</strong></p>
<ul>
<li>å‡å°‘æ•°æ®çš„å¤„ç†äº†â€“æé«˜æ•ˆç‡</li>
</ul>
<h4 id="7-1-ä½¿ç”¨limitåˆ†é¡µï¼ˆSQLï¼‰"><a href="#7-1-ä½¿ç”¨limitåˆ†é¡µï¼ˆSQLï¼‰" class="headerlink" title="7.1 ä½¿ç”¨limitåˆ†é¡µï¼ˆSQLï¼‰"></a>7.1 ä½¿ç”¨limitåˆ†é¡µï¼ˆSQLï¼‰</h4><pre><code>SELECT * from user limit  startIndex,pageSize;
SELECT * from user limit 3;#[0,n]
</code></pre>
<p>ä½¿ç”¨mybatiså®ç°åˆ†é¡µï¼Œæ ¸å¿ƒSQL</p>
<p>1.æ¥å£</p>
<pre><code>List&lt;User&gt; getUserByLimit(Map&lt;String,Integer&gt; map);
</code></pre>
<p>2.mapper.xml</p>
<pre><code>&lt;select id=&quot;getUserByLimit&quot; parameterType=&quot;map&quot; resultType=&quot;User&quot;&gt;
    select * from mybatis.user limit #&#123;startIndex&#125;, #&#123;pageSize&#125;;
&lt;/select&gt;
</code></pre>
<p>3.æµ‹è¯•</p>
<pre><code>public void getUserByLimit() &#123;
    SqlSession sqlSession = MybatisUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    HashMap&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;();
    map.put(&quot;startIndex&quot;, 1);
    map.put(&quot;pageSize&quot;, 2);
    mapper.getUserByLimit(map);

    List&lt;User&gt; userList = mapper.getUserByLimit(map);
    for (User user:userList) &#123;
        System.out.println(user);
    &#125;
    sqlSession.close();
&#125;
</code></pre>
<h4 id="7-2RowBoundsåˆ†é¡µï¼ˆç±»ï¼‰"><a href="#7-2RowBoundsåˆ†é¡µï¼ˆç±»ï¼‰" class="headerlink" title="7.2RowBoundsåˆ†é¡µï¼ˆç±»ï¼‰"></a>7.2RowBoundsåˆ†é¡µï¼ˆç±»ï¼‰</h4><p>äº†è§£å³å¯</p>
<h4 id="7-3-åˆ†é¡µæ’ä»¶-PageHelper"><a href="#7-3-åˆ†é¡µæ’ä»¶-PageHelper" class="headerlink" title="7.3 åˆ†é¡µæ’ä»¶ PageHelper"></a>7.3 åˆ†é¡µæ’ä»¶ PageHelper</h4><p>äº†è§£å³å¯</p>
<h3 id="8-æ³¨è§£å¼€å‘"><a href="#8-æ³¨è§£å¼€å‘" class="headerlink" title="8.æ³¨è§£å¼€å‘"></a>8.æ³¨è§£å¼€å‘</h3><h4 id="8-1é¢å‘æ¥å£ç¼–ç¨‹"><a href="#8-1é¢å‘æ¥å£ç¼–ç¨‹" class="headerlink" title="8.1é¢å‘æ¥å£ç¼–ç¨‹"></a>8.1é¢å‘æ¥å£ç¼–ç¨‹</h4><p>è§£è€¦</p>
<p>æ·±å±‚ç†è§£ï¼šå®šä¹‰ä¸å®ç°çš„åˆ†ç¦»</p>
<h4 id="8-2ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8-2ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8.2ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8.2ä½¿ç”¨æ³¨è§£å¼€å‘</h4><p>çœå»äº†mapper.xmlçš„é…ç½®</p>
<p>1.æ³¨è§£åœ¨æ¥å£ä¸Šå®ç°</p>
<pre><code>@Select(&quot;select * from user&quot;)
    List&lt;User&gt; getUsers();
</code></pre>
<p>2.éœ€è¦åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ç»‘å®šæ¥å£</p>
<pre><code>&lt;!--ç»‘å®šæ¥å£--&gt;    
    &lt;mappers&gt;
        &lt;mapper class=&quot;com.fan.dao.UserMapper&quot;/&gt;
    &lt;/mappers&gt;
</code></pre>
<p>3.æµ‹è¯•</p>
<p>æœ¬è´¨ï¼šåå°„æœºåˆ¶å®ç°</p>
<p>åº•å±‚ï¼šåŠ¨æ€ä»£ç†</p>
<h4 id="Mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹"><a href="#Mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹" class="headerlink" title="Mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹"></a>Mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹</h4><p>&#x2F;&#x2F; TODO lyf éšç€ä¸ªäººèƒ½åŠ›çš„æå‡åº”è¯¥å»æ·±ç©¶ä¸€ä¸‹è¿‡å»çœ‹ä¸æ‡‚çš„ä¸œè¥¿äº†</p>
<p>ä¸€ä¸ªå›¾</p>
<h4 id="8-3CRUD"><a href="#8-3CRUD" class="headerlink" title="8.3CRUD"></a>8.3CRUD</h4><p>åœ¨å·¥å…·ç±»åˆ›å»ºæ—¶è‡ªåŠ¨æäº¤äº‹åŠ¡ <strong>è®¾ç½®ä¸ºtrueå³å¯</strong></p>
<pre><code>public static SqlSession getSqlSession() &#123;
    return sqlSessionFactory.openSession(true);
&#125;
</code></pre>
<p>ï¼ï¼ï¼ä¼¼ä¹ç»“æœé›†æ˜ å°„resultMapå¯¹æ³¨è§£å¼€å‘æ˜¯æ— æ•ˆçš„ï¼Œè€è€å®å®å†™</p>
<p>ç¼–å†™æ¥å£ï¼Œå¢åŠ æ³¨è§£</p>
<pre><code>public interface UserMapper &#123;
    //æ³¨è§£å¼€å‘
    @Select(&quot;select * from user&quot;)
    List&lt;User&gt; getUsers();

    //æ–¹æ³•å­˜åœ¨å¤šä¸ªå‚æ•°ï¼Œæ‰€æœ‰çš„å‚æ•°æ˜¯å‰å¿…é¡»åŠ ä¸Š@param
    @Select(&quot;select * from user where id = #&#123;id&#125;&quot;)
    User getUserById(@Param(&quot;id&quot;) int id2);

    @Insert(&quot;insert into user(id, last_name, pwd) values (#&#123;id&#125;, #&#123;last_name&#125;, #&#123;password&#125;)&quot;)
    int addUser(User user);

    @Update(&quot;update user set last_name=#&#123;last_name&#125;, pwd=#&#123;password&#125; where id=#&#123;id&#125;&quot;)
    int updateUser(User user);

    //æ³¨è§£å¤§å°å†™
    @Delete(&quot;delete from user where id = #&#123;uid&#125;&quot;)
    int deleteUser(@Param(&quot;uid&quot;) int id);

&#125;
</code></pre>
<p>æµ‹è¯•ç±»åŒä¹‹å‰</p>
<p>ã€æ³¨æ„ï¼šå¿…é¡»å°†æ¥å£æ³¨å†Œåˆ°æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ã€‘ï¼ˆä¹‹å‰æ˜¯æ³¨å†Œçš„mapper.xmlï¼‰</p>
<p><strong>@Paramï¼ˆï¼‰æ³¨è§£</strong></p>
<ul>
<li>åŸºæœ¬ç±»å‹çš„å‚æ•°æˆ–è€…Stringç±»å‹ï¼Œéœ€è¦åŠ ä¸Š</li>
<li>å¼•ç”¨ç±»å‹ä¸éœ€è¦åŠ </li>
<li>å¦‚æœåªæœ‰ä¸€ä¸ªåŸºæœ¬ç±»å‹çš„è¯ï¼Œå¯ä»¥å¿½ç•¥ï¼Œä½†å»ºä»¥å¤§å®¶åŠ ä¸Š</li>
<li>åœ¨SQLä¸­å¼•ç”¨çš„(å¦‚@Delete xxxxx where id &#x3D; #{uid})å°±æ˜¯æˆ‘ä»¬æ­¤å¤„çš„@Param(â€œâ€) â€œâ€ ä¸­è®¾å®šçš„å±æ€§å</li>
</ul>
<p>${} #{}çš„åŒºåˆ«</p>
<h3 id="lombok"><a href="#lombok" class="headerlink" title="lombok"></a>lombok</h3><p>ä¸ç”¨å†™ getter setter constructorï¼ˆæœ‰æ— å‚ï¼‰ ç›´æ¥æ³¨è§£å³å¯</p>
<p>@Data:æ— å‚æ„é€ ï¼Œget,set,to String,hashcode,equals</p>
<p>1.å®‰è£…æ’ä»¶(ä»pluginså¤„)</p>
<p>2.å¯¼å…¥ä¾èµ–</p>
<pre><code>&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;version&gt;1.18.10&lt;/version&gt;
        &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
<p>3.ç›´æ¥åœ¨å®ä½“ç±»ä¸Š@Data xxxxxx</p>
<h3 id="10-å¤šå¯¹ä¸€å¤„ç†"><a href="#10-å¤šå¯¹ä¸€å¤„ç†" class="headerlink" title="10.å¤šå¯¹ä¸€å¤„ç†"></a>10.å¤šå¯¹ä¸€å¤„ç†</h3><p>æœç´¢å¤šä¸ªè¡Œ å…¶ä¸­æ˜ å°„åˆ°ä¸€ä¸ªå¯¹è±¡</p>
<p>åˆ›å»ºè¡¨</p>
<pre><code>CREATE TABLE teacher(
id INT(10) NOT NULL,
name VARCHAR(30) DEFAULT NULL,
PRIMARY KEY(id)
) ENGINE=INNODB DEFAULT CHARSET=utf8

INSERT INTO teacher(id, name) VALUES (&#39;1&#39;, &#39;å¢è€å¸ˆ&#39;);

CREATE TABLE student(
id INT(10) NOT NULL,
name VARCHAR(30) DEFAULT NULL,
tid INT(10) DEFAULT NULL,
PRIMARY KEY(id),
KEY fktid(tid),
CONSTRAINT ftkid FOREIGN KEY(tid) REFERENCES teacher(id)
) ENGINE=INNODB DEFAULT CHARSET=utf8

INSERT INTO student (id, name, tid) VALUES(&#39;1&#39;, &#39;å®‹äº‘é¾™&#39;, &#39;1&#39;);
INSERT INTO student (id, name, tid) VALUES(&#39;2&#39;, &#39;ç‹æ€è¾¾&#39;, &#39;1&#39;);
INSERT INTO student (id, name, tid) VALUES(&#39;3&#39;, &#39;æ±¤æ™®æ£®&#39;, &#39;1&#39;);
INSERT INTO student (id, name, tid) VALUES(&#39;4&#39;, &#39;æç‹—æœ•&#39;, &#39;1&#39;);
INSERT INTO student (id, name, tid) VALUES(&#39;5&#39;, &#39;éƒ‘å¸…&#39;, &#39;1&#39;);
</code></pre>
<h4 id="æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="æµ‹è¯•ç¯å¢ƒæ­å»º"></a>æµ‹è¯•ç¯å¢ƒæ­å»º</h4><p>1.å¯¼å…¥lombok</p>
<p>2.æ–°å»ºå®ä½“ç±» Studentä¸Teacher</p>
<p>3.å»ºç«‹ä¸¤ä¸ªå¯¹åº”Mapperæ¥å£</p>
<p>4.å»ºç«‹Mapper.xmlæ–‡ä»¶</p>
<p>5.åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ç»‘å®šæ³¨å†ŒMapperæ¥å£æˆ–è€…æ–‡ä»¶ï¼ˆæ³¨æ„ç»‘å®šæ–¹å¼ï¼Œç±»æˆ–resourceï¼‰</p>
<p>6.æµ‹è¯•æŸ¥è¯¢æ˜¯å¦èƒ½å¤ŸæˆåŠŸ</p>
<h4 id="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h4><pre><code>&lt;select id=&quot;getStudent&quot; resultMap=&quot;StudentTeacher&quot;&gt;
        SELECT * from student;
    &lt;/select&gt;
    &lt;resultMap id=&quot;StudentTeacher&quot; type=&quot;Student&quot;&gt;
        &lt;result property=&quot;id&quot; column=&quot;id&quot;/&gt;
        &lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;
&lt;!--        å¤æ‚çš„å±æ€§å•ç‹¬å¤„ç† ï¼ˆteacher)
       å¯¹è±¡ï¼šassociation   é›†åˆ: collection
       æœ‰ç‚¹ç±»ä¼¼åµŒå¥—æŸ¥è¯¢
       --&gt;
        &lt;association property=&quot;teacher&quot; column=&quot;tid&quot; javaType=&quot;Teacher&quot; select=&quot;getTeacher&quot;/&gt;
    &lt;/resultMap&gt;
    &lt;select id=&quot;getTeacher&quot; resultType=&quot;Teacher&quot;&gt;
        select * from teacher where id = #&#123;id&#125;;
    &lt;/select&gt;
</code></pre>
<h4 id="æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"><a href="#æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"></a>æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†</h4><pre><code>&lt;!--        æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†--&gt;
    &lt;select id=&quot;getStudent2&quot; resultMap=&quot;StudentTeacher2&quot;&gt;
        select s.id sid, s.name sname, t.name tname
        from student s, teacher t
        where s.tid = t.id;
    &lt;/select&gt;
    
    &lt;resultMap id=&quot;StudentTeacher2&quot; type=&quot;Student&quot;&gt;
        &lt;result property=&quot;id&quot; column=&quot;sid&quot;/&gt;
        &lt;result property=&quot;name&quot; column=&quot;sname&quot;/&gt;
&lt;!--        æŸ¥å‡ºè€å¸ˆ åœ¨associationä¸­--&gt;
        &lt;association property=&quot;teacher&quot; javaType=&quot;Teacher&quot;&gt;
            &lt;result property=&quot;name&quot; column=&quot;tname&quot;/&gt;
        &lt;/association&gt;

    &lt;/resultMap&gt;
</code></pre>
<p>æ€»ç»“ï¼Œå³ä¸¤ç§æ–¹å¼ï¼š â‘ <strong>å­æŸ¥è¯¢ â‘¡è”è¡¨æŸ¥è¯¢</strong></p>
<p>ä»å½¢å¼ä¸Šçœ‹ï¼Œè”è¡¨æŸ¥è¯¢æ›´ä¸ºç®€ç•¥ã€‚é¦–å…ˆå†™å‡ºå®Œæ•´çš„SQLè¯­å¥ï¼Œé…ç½®resultMapï¼Œåœ¨å…¶ä¸­é…ç½®å¯¹è±¡association</p>
<h3 id="11-ä¸€å¯¹å¤š"><a href="#11-ä¸€å¯¹å¤š" class="headerlink" title="11.ä¸€å¯¹å¤š"></a>11.ä¸€å¯¹å¤š</h3><h4 id="1-ç¯å¢ƒæ­å»º"><a href="#1-ç¯å¢ƒæ­å»º" class="headerlink" title="1.ç¯å¢ƒæ­å»º"></a>1.ç¯å¢ƒæ­å»º</h4><p>å®ä½“ç±»</p>
<p>Student</p>
<pre><code>@Data
public class Student &#123;
    private int id;
    private String name;
    //å­¦ç”Ÿéœ€è¦å…³è”ä¸€ä¸ªè€å¸ˆ
    private int tid;
&#125;
</code></pre>
<p>Teacher</p>
<pre><code>@Data
public class Teacher &#123;
    private int id;
    private String name;
    //ä¸€ä¸ªè€å¸ˆæœ‰å¤šä¸ªå­¦ç”Ÿ
    private List&lt;Student&gt; students;
&#125;
</code></pre>
<h4 id="ä¸€ã€æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"><a href="#ä¸€ã€æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†" class="headerlink" title="ä¸€ã€æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"></a>ä¸€ã€æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†</h4><pre><code>&lt;select id=&quot;getTeacher&quot; resultMap=&quot;TeacherStudent&quot;&gt;
        select s.id sid, s.name sname, t.name tname, t.id tid
        from student s, teacher t
        where s.tid = t.id and t.id=#&#123;tid&#125;
    &lt;/select&gt;
    &lt;resultMap id=&quot;TeacherStudent&quot; type=&quot;Teacher&quot;&gt;
        &lt;result property=&quot;id&quot; column=&quot;tid&quot;/&gt;
        &lt;result property=&quot;name&quot; column=&quot;tname&quot;/&gt;
&lt;!--        æ­¤å¤„å¤„ç†çš„å¤æ‚å¯¹è±¡æ˜¯é›†åˆ åº”ç”¨collection   javaType=&quot;&quot;æŒ‡å®šå±æ€§çš„ç±»å‹
          propertyæŒ‡ä»£é›†åˆ é›†åˆä¸­çš„æ³›å‹ä¿¡æ¯ï¼Œä½¿ç”¨ofTypeè·å– --&gt;
        &lt;collection property=&quot;students&quot; ofType=&quot;Student&quot;&gt;
            &lt;result property=&quot;id&quot; column=&quot;sid&quot;/&gt;
            &lt;result property=&quot;name&quot; column=&quot;sname&quot;/&gt;
            &lt;result property=&quot;tid&quot; column=&quot;tid&quot;/&gt;
        &lt;/collection&gt;
    &lt;/resultMap&gt;
</code></pre>
<h4 id="äºŒã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#äºŒã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="äºŒã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>äºŒã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h4><pre><code>    &lt;select id=&quot;getTeacher2&quot; resultMap=&quot;TeacherStudent2&quot;&gt;
        select * from mybatis.teacher where id = #&#123;tid&#125;
    &lt;/select&gt;
&lt;!--     å…³è”ä¸Šä¸‹ä¸¤ä¸ªæŸ¥è¯¢--&gt;
    &lt;resultMap id=&quot;TeacherStudent2&quot; type=&quot;Teacher&quot;&gt;
&lt;!--        ç›¸åŒçš„propertiesçœç•¥--&gt;
        &lt;collection property=&quot;students&quot; javaType=&quot;ArrayList&quot; ofType=&quot;Student&quot; select=&quot;getStudentByTid&quot; column=&quot;id&quot;/&gt;
    &lt;/resultMap&gt;

    &lt;select id=&quot;getStudentByTid&quot; resultType=&quot;Student&quot;&gt;
        select * from mybatis.student where tid = #&#123;tid&#125;
    &lt;/select&gt;
</code></pre>
<p>å°ç»“</p>
<p>1.å…³è” -association</p>
<p>2.é›†åˆ-collection</p>
<p>3.javaType &amp; ofType</p>
<p>â‘ javaTypeæŒ‡å®šå®ä½“ç±»ä¸­å±æ€§çš„ç±»å‹</p>
<p>â‘¡ofTypeç”¨æ¥æŒ‡å®šæ˜ å°„åˆ°Listæˆ–è€…é›†åˆä¸­çš„pojoç±»å‹ï¼ˆå†™åœ¨pojoä¸­çš„)ï¼Œæ³›å‹ä¸­çš„çº¦æŸç±»å‹ã€‚</p>
<pre><code>å¦‚ï¼š   private List&lt;Student&gt; students;
    æˆ‘ä»¬é¦–å…ˆè¦å¾—åˆ°javaType=&quot;ArrayList&quot;  ç„¶åå–å¾—åˆ°æ³›å‹ä¸­çš„ofType=&quot;Student&quot;
</code></pre>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>ä¿è¯SQLçš„å¯è¯»æ€§ï¼Œå°½é‡ä¿è¯é€šä¿—æ˜“æ‡‚</li>
<li>æ³¨æ„ä¸€å¯¹å¤šå’Œå¤šå¯¹ä¸€ä¸­ï¼Œå±æ€§åå’Œå­—æ®µçš„ é—®é¢˜</li>
<li>å¦‚æœé—®é¢˜ä¸å¥½æ’æŸ¥é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨æ—¥å¿—ï¼ˆå»ºè®®ä½¿ç”¨Log4j)</li>
<li>æ³¨æ„æ ‡ç­¾ ä»¥åŠresultType resultMapç­‰ ä¸è¦å‡ºé”™</li>
</ul>
<h4 id="æ…¢SQL-1s-1000s"><a href="#æ…¢SQL-1s-1000s" class="headerlink" title="æ…¢SQL 1s 1000s"></a>æ…¢SQL 1s 1000s</h4><p>é¢è¯•é«˜é¢‘</p>
<ul>
<li>MySqlå¼•æ“</li>
<li>InnoDB åº•å±‚åŸç†</li>
<li>ç´¢å¼•</li>
<li>ç´¢å¼•ä¼˜åŒ–</li>
</ul>
<h3 id="12-åŠ¨æ€SQL"><a href="#12-åŠ¨æ€SQL" class="headerlink" title="12.åŠ¨æ€SQL"></a>12.åŠ¨æ€SQL</h3><p>whatï¼Ÿ</p>
<p><strong>æ ¹æ®ä¸åŒæ¡ä»¶ç”Ÿæˆä¸åŒçš„SQLè¯­å¥</strong></p>
<p>Mybatisé‡‡ç”¨åŠŸèƒ½å¼ºå¤§çš„åŸºäºOGNLçš„è¡¨è¾¾å¼æ¥æ·˜æ±°å…¶å®ƒå¤§éƒ¨åˆ†å…ƒç´ ã€‚</p>
<ul>
<li>if</li>
<li>choose(when, otherwise)</li>
<li>trim(where, set)</li>
<li>foreach</li>
</ul>
<h4 id="æ­å»ºç¯å¢ƒ"><a href="#æ­å»ºç¯å¢ƒ" class="headerlink" title="æ­å»ºç¯å¢ƒ"></a><strong>æ­å»ºç¯å¢ƒ</strong></h4><pre><code>CREATE TABLE blog (
id VARCHAR(50) NOT NULL COMMENT &#39;åšå®¢id&#39;,
title VARCHAR(100) NOT NULL COMMENT &#39;åšå®¢æ ‡é¢˜&#39;,
author VARCHAR(30) NOT NULL COMMENT &#39;åšå®¢ä½œè€…&#39;,
create_time DATETIME NOT NULL COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;,
views INT(30) NOT NULL COMMENT &#39;æµè§ˆé‡&#39;
) ENGINE=INNODB DEFAULT CHARSET=utf8
</code></pre>
<p>1.å¯¼åŒ…</p>
<p>2.é…ç½®æ–‡ä»¶</p>
<p>3.å®ä½“ç±»</p>
<pre><code>@Data
public class Blog &#123;
    private String id;
    private String title;
    private String author;
    //æ³¨æ„å¤„ç†ä¸ä¸€è‡´é—®é¢˜ å’Œæ•°æ®åº“ä¸­çš„å­—æ®µ
    private Date createTime;
    private int views;

&#125;
</code></pre>
<h4 id="IF"><a href="#IF" class="headerlink" title="IF"></a>IF</h4><p>æ¥å£ä¸­å†™å¥½å¯¹åº”æ¥å£å†é…ç½® ç„¶åæµ‹è¯•</p>
<pre><code>     &lt;select id=&quot;queryBlogIF&quot; parameterType=&quot;map&quot; resultType=&quot;blog&quot;&gt;
        select * from mybatis.blog where 1=1
        &lt;if test=&quot;title != null&quot;&gt;
            and title=#&#123;title&#125;
        &lt;/if&gt;
        &lt;if test=&quot;author != null&quot;&gt;
            and author =#&#123;author&#125;
        &lt;/if&gt;
    &lt;/select&gt;
</code></pre>
<h4 id="CHOOSE-WHEN-OTHERWISE"><a href="#CHOOSE-WHEN-OTHERWISE" class="headerlink" title="CHOOSE(WHEN,OTHERWISE)"></a>CHOOSE(WHEN,OTHERWISE)</h4><p>ç±»ä¼¼ switchâ€“case</p>
<pre><code>&lt;select id=&quot;queryBlogChoose&quot; parameterType=&quot;map&quot; resultType=&quot;blog&quot;&gt;
        select * from mybatis.blog
        &lt;where&gt;
            &lt;choose&gt;
                &lt;when test=&quot;title != null&quot;&gt;
                    title = #&#123;title&#125;
                &lt;/when&gt;
                &lt;when test = &quot;author != null&quot;&gt;
                    and author = #&#123;author&#125;
                &lt;/when&gt;
                &lt;otherwise&gt;
                    and views = #&#123;views&#125;
                &lt;/otherwise&gt;
            &lt;/choose&gt;
        &lt;/where&gt;
 &lt;/select&gt;
</code></pre>
<h4 id="TRIMï¼ˆWHERE-SET"><a href="#TRIMï¼ˆWHERE-SET" class="headerlink" title="TRIMï¼ˆWHERE, SET)"></a>TRIMï¼ˆWHERE, SET)</h4><pre><code>       select * from mybatis.blog
    &lt;where&gt;
        &lt;if test=&quot;title != null&quot;&gt;
            and title = #&#123;title&#125;
        &lt;/if&gt;
        &lt;if test=&quot;author != null&quot;&gt;
            and author =#&#123;author&#125;
        &lt;/if&gt;
    &lt;/where&gt;
&lt;update id=&quot;updateBlog&quot; parameterType=&quot;map&quot;&gt;
    update mybatis.blog
    &lt;set&gt;
        &lt;if test=&quot;title != null&quot;&gt;
            title = #&#123;title&#125;,
        &lt;/if&gt;
        &lt;if test=&quot;author != null&quot;&gt;
            author = #&#123;author&#125;
        &lt;/if&gt;
    &lt;/set&gt;
    where id = #&#123;id&#125;
&lt;/update&gt;
</code></pre>
<p><strong>æ‰€è°“åŠ¨æ€SQLï¼Œæœ¬è´¨ä¸Šä¾ç„¶æ˜¯Sqlè¯­å¥ï¼Œä¸è¿‡å¯ä»¥åœ¨SQLå±‚é¢ä¸Šå¢åŠ æ‰§è¡Œé€»è¾‘ä»£ç </strong></p>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><h4 id="SQLç‰‡æ®µ"><a href="#SQLç‰‡æ®µ" class="headerlink" title="SQLç‰‡æ®µ"></a>SQLç‰‡æ®µ</h4><p>æœ‰æ—¶ä¸ºäº†å¤ç”¨ï¼Œä¼šå°†å…¬å…±éƒ¨ä»½æŠ½å–å‡ºã€‚</p>
<p>1.ä½¿ç”¨æ ‡ç­¾æŠ½å–å…¬å…±éƒ¨ä»½</p>
<p>2.åœ¨éœ€è¦çš„åœ°æ–¹ä½¿ç”¨includeæ ‡ç­¾å¼•ç”¨</p>
<pre><code>&lt;sql id=&quot;if-title-author&quot;&gt;
    &lt;if test=&quot;title != null&quot;&gt;
        and title = #&#123;title&#125;
    &lt;/if&gt;
    &lt;if test=&quot;author != null&quot;&gt;
        and author =#&#123;author&#125;
    &lt;/if&gt;
&lt;/sql&gt;

&lt;select id=&quot;queryBlogIF&quot; parameterType=&quot;map&quot; resultType=&quot;blog&quot;&gt;
    select * from mybatis.blog
&lt;where&gt;
    &lt;include refid=&quot;if-title-author&quot;&gt;
    &lt;/include&gt;
&lt;/where&gt;
&lt;/select&gt;
</code></pre>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>åŸºäºå•è¡¨å®šä¹‰SQLç‰‡æ®µ</li>
<li>ä¸è¦å­˜åœ¨whereæ ‡ç­¾</li>
</ul>
<h4 id="FOREACH"><a href="#FOREACH" class="headerlink" title="FOREACH"></a>FOREACH</h4><p><img src="/" alt="image-20210121163900051"></p>
<pre><code>  &lt;foreach item=&quot;item&quot; index=&quot;index&quot; collection=&quot;list&quot;
      open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;
        #&#123;item&#125;
  &lt;/foreach&gt;
è‹¥select * from user where 1=1 and (id=1 or id=2 or id=3) åˆ™separator=â€œï¼Œâ€å¤„å¯ä½œor collectionä½œä¸ºids ç›¸åº”çš„item=&quot;id&quot;
</code></pre>
<p><strong>å®ä¾‹</strong></p>
<pre><code>&lt;select id=&quot;queryBlogForeach&quot; parameterType=&quot;map&quot; resultType=&quot;blog&quot;&gt;
    select * from mybatis.blog
    &lt;where&gt;
        &lt;foreach collection=&quot;ids&quot; item=&quot;id&quot; open=&quot;and (&quot; separator=&quot;or&quot; close=&quot;)&quot;&gt;
            id=#&#123;id&#125;
        &lt;/foreach&gt;
    &lt;/where&gt;
&lt;/select&gt;
</code></pre>
<p><em><strong>åŠ¨æ€SQLå°±æ˜¯åœ¨æ‹¼æ¥SQLè¯­å¥ï¼Œæˆ‘ä»¬åªè¦ä¿è¯SQLçš„æ­£ç¡®æ€§ï¼ŒæŒ‰ç…§SQLçš„æ ¼å¼å»æ’åˆ—ç»„åˆå³å¯</strong></em></p>
<p>å»ºä»¥ï¼š</p>
<ul>
<li>å…ˆåœ¨MySQLä¸­å†™å‡ºå®Œæ•´çš„SQLè¯­å¥ï¼Œå†åœ¨å¯¹åº”xmlæ–‡ä»¶ä¸­å»ä¿®æ”¹æˆä¸ºåŠ¨æ€SQLå®ç°é€šç”¨å³å¯</li>
</ul>
<h3 id="13-ç¼“å­˜ï¼ˆäº†è§£å³å¯ï¼‰"><a href="#13-ç¼“å­˜ï¼ˆäº†è§£å³å¯ï¼‰" class="headerlink" title="13.ç¼“å­˜ï¼ˆäº†è§£å³å¯ï¼‰"></a>13.ç¼“å­˜ï¼ˆäº†è§£å³å¯ï¼‰</h3><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>æŸ¥è¯¢ï¼šè¿æ¥æ•°æ®åº“ è€—èµ„æº</p>
<p>ä¸€æ¬¡æŸ¥è¯¢çš„ç»“æœï¼Œæš‚å­˜åœ¨ä¸€ä¸ªå¯ä»¥ç›´æ¥å–åˆ°çš„åœ°æ–¹ ã€‹ã€‹ã€‹ç¼“å­˜</p>
<p>å†æ¬¡æŸ¥è¯¢ç›¸åŒæ•°æ®æ—¶ï¼Œå¯ç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œä¸ç”¨åˆ©ç”¨æ•°æ®åº“</p>
<p>ç›®çš„ï¼šå‡å°‘å’Œæ•°æ®åº“çš„äº¤äº’æ¬¡æ•°ï¼Œå‡å°‘ç³»ç»Ÿå¼€é”€æé«˜ç³»ç»Ÿæ•ˆç‡</p>
<p>ä½¿ç”¨æ¡ä»¶ï¼šç»å¸¸æŸ¥è¯¢å¹¶ä¸”ä¸ç»å¸¸æ”¹å˜çš„æ•°æ®</p>
<h4 id="13-2-Mybatisç¼“å­˜"><a href="#13-2-Mybatisç¼“å­˜" class="headerlink" title="13.2 Mybatisç¼“å­˜"></a>13.2 Mybatisç¼“å­˜</h4><p>å®šåˆ¶å’Œé…ç½®ç¼“å­˜</p>
<p>é»˜è®¤å®šä¹‰äº†ä¸¤çº§ç¼“å­˜ï¼šä¸€çº§ å’Œ äºŒçº§</p>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€çº§ç¼“å­˜å¼€å¯ï¼ˆSqlSessionçº§ç¼“å­˜ï¼Œå³æœ¬åœ°ç¼“å­˜ï¼‰</li>
<li>äºŒçº§ç¼“å­˜éœ€è¦æ‰‹åŠ¨å¼€å¯ä¸é…ç½®ï¼Œæ˜¯åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜</li>
<li>ä¸ºæé«˜æ‰©å±•æ€§ï¼ŒMybatiså®šä¹‰äº†ç¼“å­˜æ¥å£Cacheï¼Œå¯é€šè¿‡Cacheæ¥å£æ¥è‡ªå®šä¹‰äºŒçº§ç¼“å­˜</li>
</ul>
<h4 id="13-3-ä¸€çº§ç¼“å­˜"><a href="#13-3-ä¸€çº§ç¼“å­˜" class="headerlink" title="13.3 ä¸€çº§ç¼“å­˜"></a>13.3 ä¸€çº§ç¼“å­˜</h4><p>æœ¬åœ°ç¼“å­˜ sqlSession</p>
<ul>
<li>ä¸æ•°æ®åº“åŒä¸€æ¬¡ä¼šè¯æœŸé—´æŸ¥è¯¢åˆ°çš„æ•°æ®ä¼šæ”¾åœ¨æœ¬åœ°ç¼“å­˜ä¸Š</li>
<li>ä»¥åéœ€è¦è·å–ç›¸åŒæ•°æ®æ—¶ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­å–ã€‚</li>
</ul>
<p>æµ‹è¯•æ­¥éª¤ï¼š</p>
<p>1.å¼€å¯æ—¥å¿—</p>
<p>2.æµ‹è¯•åœ¨ä¸€ä¸ªSessionä¸­æŸ¥è¯¢ä¸¤æ¬¡ç›¸åŒè®°å½•</p>
<p>3.æŸ¥çœ‹æ—¥å¿—è¾“å‡º<img src="/" alt="image-20210121195841932"></p>
<p>ç¼“å­˜å¤±æ•ˆï¼š</p>
<p>1.æŸ¥è¯¢ä¸åŒçš„ä¸œè¥¿</p>
<p>2.å¢åˆ æ”¹å¯èƒ½ä¼šæ”¹å˜åŸæ¥çš„æ•°æ®ï¼Œæ‰€ä»¥å¿…å®šä¼šåˆ·æ–°ç¼“å­˜</p>
<p>3.æŸ¥è¯¢ä¸åŒçš„Mapper.xml</p>
<p>4.æ‰‹åŠ¨æ¸…ç†ç¼“å­˜ã€‚</p>
<p>1. </p>
<p><img src="/" alt="image-20210121200657684"></p>
<p>å°ç»“ï¼šä¸€çº§ç¼“å­˜é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œåªåœ¨ä¸€æ¬¡SqlSessionä¸­æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯æ‹¿åˆ°è¿æ¥åˆ°å…³é—­è¿æ¥è¿™ä¸ªåŒºé—´æ®µ</p>
<p>ä¸€çº§ç¼“å­˜ç›¸å½“äºä¸€ä¸ªMap</p>
<h4 id="13-4-äºŒçº§ç¼“å­˜"><a href="#13-4-äºŒçº§ç¼“å­˜" class="headerlink" title="13.4 äºŒçº§ç¼“å­˜"></a>13.4 äºŒçº§ç¼“å­˜</h4><p>åˆå«å…¨å±€ç¼“å­˜ï¼Œ ç”±äºä¸€çº§ç¼“å­˜çš„ä½œç”¨åŸŸè¾ƒä½</p>
<p>åŸºäº<strong>namespaceçº§åˆ«</strong>çš„ç¼“å­˜ï¼Œä¸€ä¸ªåç§°ç©ºé—´ï¼Œå¯¹åº”ä¸€ä¸ªäºŒçº§ç¼“å­˜</p>
<p><img src="/" alt="image-20210121201640367"></p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<p>1.å¼€å¯å…¨å±€ç¼“å­˜(åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­)</p>
<pre><code>&lt;!--        æ˜¾å¼çš„å¼€å¯å…¨å±€ç¼“å­˜--&gt;
        &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;
</code></pre>
<p>2.åœ¨è¦ä½¿ç”¨äºŒçº§ç¼“å­˜çš„mapperä¸­æ³¨å†Œ</p>
<pre><code>&lt;cache/&gt;
&lt;!--    åœ¨å½“å‰Mapper.xmlä¸­ä½¿ç”¨äºŒçº§ç¼“å­˜--&gt;
    &lt;cache eviction=&quot;FIFO&quot;
            flushInterval=&quot;60000&quot;
            size=&quot;512&quot;
            readOnly=&quot;true&quot;/&gt;

&lt;!--    æ­¤å¤„é…ç½®ç¼“å­˜--&gt;
    &lt;select id=&quot;queryUserById&quot; resultType=&quot;user&quot; useCache=&quot;true&quot;&gt;
        select * from user where id=#&#123;id&#125;
    &lt;/select&gt;
</code></pre>
<p>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å‚æ•°ï¼Œä¸Šè¿°æ˜¯å®˜æ–¹æ–‡æ¡£ç»™å‡º</p>
<p>3.æµ‹è¯•</p>
<p> é—®é¢˜ï¼šéœ€è¦å°†å®ä½“ç±»åºåˆ—åŒ–ã€‚å¦åˆ™å°±ä¼šæŠ¥é”™ã€‚ï¼ˆå¦‚æœåªæ˜¯ç®€å•çš„é…ç½®</p>
<p><img src="/" alt="image-20210122145945436"></p>
<pre><code>public class User implements Serializable
</code></pre>
<p>å°ç»“ï¼š</p>
<ul>
<li>åªè¦å¼€å¯äº†äºŒçº§ç¼“å­˜ï¼Œåœ¨åŒä¸€ä¸ªMapperä¸‹å°±æœ‰æ•ˆ</li>
<li>æ‰€æœ‰çš„æ•°æ®éƒ½ä¼šå…ˆæ”¾åœ¨ä¸€çº§ç¼“å­˜ä¸­</li>
<li>åªæœ‰å½“ä¼šè¯æäº¤æˆ–å…³é—­æ‰ä¼šæäº¤åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼ˆè½¬å­˜ï¼Œåˆè¯´æ˜ä¸€çº§ç¼“å­˜æ˜¯Sessionçº§åˆ«çš„ç¼“å­˜ï¼‰</li>
</ul>
<h4 id="13-5ç¼“å­˜åŸç†"><a href="#13-5ç¼“å­˜åŸç†" class="headerlink" title="13.5ç¼“å­˜åŸç†"></a>13.5ç¼“å­˜åŸç†</h4><h1 id="ç”¨-æˆ·"><a href="#ç”¨-æˆ·" class="headerlink" title="ç”¨ æˆ·"></a>ç”¨ æˆ·</h1><hr>
<p><img src="/" alt="image-20210122151127647"></p>
<h1 id="æ•°-æ®-åº“"><a href="#æ•°-æ®-åº“" class="headerlink" title="æ•° æ® åº“"></a>æ•° æ® åº“</h1><hr>
<pre><code>SqlSession sqlSession = MybatisUtils.getSqlSession();
SqlSession sqlSession2 = MybatisUtils.getSqlSession();
UserMapper mapper = sqlSession.getMapper(UserMapper.class);

User user = mapper.queryUserById(1);
System.out.println(user);
sqlSession.close();

UserMapper mapper2 = sqlSession2.getMapper(UserMapper.class);
User user2 = mapper2.queryUserById(1);
System.out.println(user2);

User user3 = mapper2.queryUserById(2);
System.out.println(user3);
sqlSession2.close();
</code></pre>
<p><img src="/" alt="image-20210122151501004"></p>
<p>æŸ¥è¯¢id&#x3D;2æ—¶çš„è®°å½•æ—¶æ˜¾ç„¶éœ€è¦å†æ¬¡è®¿é—®æ•°æ®åº“ï¼Œè€Œç¬¬äºŒæ¬¡è®¿é—®id&#x3D;1æ—¶èµ°ç¼“å­˜å³å¯ã€‚</p>
<p>æé«˜äº† <strong>è¯»</strong> çš„æ•ˆç‡</p>
<h4 id="13-6-è‡ªå®šä¹‰ç¼“å­˜-encache"><a href="#13-6-è‡ªå®šä¹‰ç¼“å­˜-encache" class="headerlink" title="13.6 è‡ªå®šä¹‰ç¼“å­˜-encache"></a>13.6 è‡ªå®šä¹‰ç¼“å­˜-encache</h4><p>EnCacheæ˜¯ å¼€æºJavaåˆ†å¸ƒå¼ç¼“å­˜ï¼Œä¸»è¦é¢å‘é€šç”¨ç¼“å­˜</p>
<p>å¯¼åŒ…</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis.caches&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-ehcache&lt;/artifactId&gt;
    &lt;version&gt;1.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>åœ¨Mapperä¸­æŒ‡å®šä½¿ç”¨Ehcacheå®ç°</p>
<pre><code>&lt;!--    åœ¨å½“å‰Mapper.xmlä¸­ä½¿ç”¨äºŒçº§ç¼“å­˜--&gt;
    &lt;cache type=&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;/&gt;
</code></pre>
<p>ehcache.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;GBK&quot;?&gt;
&lt;ehcache xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:noNamespaceSchemaLocation=&quot;http://ehcache.org/ehcache.xsd&quot;
         updateCheck=&quot;false&quot;&gt;
&lt;!--
   diskStoreï¼šä¸ºç¼“å­˜è·¯å¾„ï¼Œehcacheåˆ†ä¸ºå†…å­˜å’Œç£ç›˜ä¸¤çº§ï¼Œæ­¤å±æ€§å®šä¹‰ç£ç›˜çš„ç¼“å­˜ä½ç½®ã€‚å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š
   user.home â€“ ç”¨æˆ·ä¸»ç›®å½•
   user.dir â€“ ç”¨æˆ·å½“å‰å·¥ä½œç›®å½•
   java.io.tmpdir â€“ é»˜è®¤ä¸´æ—¶æ–‡ä»¶è·¯å¾„
 --&gt;
&lt;diskStore path=&quot;./tmpdir/Tmp_EhCache&quot;/&gt;

&lt;defaultCache
        eternal=&quot;false&quot;
        maxElementsInMemory=&quot;10000&quot;
        overflowToDisk=&quot;false&quot;
        diskPersistent=&quot;false&quot;
        timeToIdleSeconds=&quot;1800&quot;
        timeToLiveSeconds=&quot;259200&quot;
        memoryStoreEvictionPolicy=&quot;LRU&quot;/&gt;

&lt;cache
        name=&quot;cloud_user&quot;
        eternal=&quot;false&quot;
        maxElementsInMemory=&quot;5000&quot;
        overflowToDisk=&quot;false&quot;
        diskPersistent=&quot;false&quot;
        timeToIdleSeconds=&quot;1800&quot;
        timeToLiveSeconds=&quot;1800&quot;
        memoryStoreEvictionPolicy=&quot;LRU&quot;/&gt;
&lt;!--
   defaultCacheï¼šé»˜è®¤ç¼“å­˜ç­–ç•¥ï¼Œå½“ehcacheæ‰¾ä¸åˆ°å®šä¹‰çš„ç¼“å­˜æ—¶ï¼Œåˆ™ä½¿ç”¨è¿™ä¸ªç¼“å­˜ç­–ç•¥ã€‚åªèƒ½å®šä¹‰ä¸€ä¸ªã€‚
 --&gt;
&lt;!--
  name:ç¼“å­˜åç§°ã€‚
  maxElementsInMemory:ç¼“å­˜æœ€å¤§æ•°ç›®
  maxElementsOnDiskï¼šç¡¬ç›˜æœ€å¤§ç¼“å­˜ä¸ªæ•°ã€‚
  eternal:å¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆï¼Œä¸€ä½†è®¾ç½®äº†ï¼Œtimeoutå°†ä¸èµ·ä½œç”¨ã€‚
  overflowToDisk:æ˜¯å¦ä¿å­˜åˆ°ç£ç›˜ï¼Œå½“ç³»ç»Ÿå®•æœºæ—¶
  timeToIdleSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ã€‚
  timeToLiveSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰å…è®¸å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚æœ€å¤§æ—¶é—´ä»‹äºåˆ›å»ºæ—¶é—´å’Œå¤±æ•ˆæ—¶é—´ä¹‹é—´ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯0.ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡å­˜æ´»æ—¶é—´æ— ç©·å¤§ã€‚
  diskPersistentï¼šæ˜¯å¦ç¼“å­˜è™šæ‹Ÿæœºé‡å¯æœŸæ•°æ® Whether the disk store persists between restarts of the Virtual Machine. The default value is false.
  diskSpoolBufferSizeMBï¼šè¿™ä¸ªå‚æ•°è®¾ç½®DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯30MBã€‚æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒºã€‚
  diskExpiryThreadIntervalSecondsï¼šç£ç›˜å¤±æ•ˆçº¿ç¨‹è¿è¡Œæ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚
  memoryStoreEvictionPolicyï¼šå½“è¾¾åˆ°maxElementsInMemoryé™åˆ¶æ—¶ï¼ŒEhcacheå°†ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥å»æ¸…ç†å†…å­˜ã€‚é»˜è®¤ç­–ç•¥æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚ä½ å¯ä»¥è®¾ç½®ä¸ºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æˆ–æ˜¯LFUï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ã€‚
  clearOnFlushï¼šå†…å­˜æ•°é‡æœ€å¤§æ—¶æ˜¯å¦æ¸…é™¤ã€‚
  memoryStoreEvictionPolicy:å¯é€‰ç­–ç•¥æœ‰ï¼šLRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼Œé»˜è®¤ç­–ç•¥ï¼‰ã€FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ã€LFUï¼ˆæœ€å°‘è®¿é—®æ¬¡æ•°ï¼‰ã€‚
  FIFOï¼Œfirst in first outï¼Œè¿™ä¸ªæ˜¯å¤§å®¶æœ€ç†Ÿçš„ï¼Œå…ˆè¿›å…ˆå‡ºã€‚
  LFUï¼Œ Less Frequently Usedï¼Œå°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­ä½¿ç”¨çš„ç­–ç•¥ï¼Œç›´ç™½ä¸€ç‚¹å°±æ˜¯è®²ä¸€ç›´ä»¥æ¥æœ€å°‘è¢«ä½¿ç”¨çš„ã€‚å¦‚ä¸Šé¢æ‰€è®²ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªhitå±æ€§ï¼Œhitå€¼æœ€å°çš„å°†ä¼šè¢«æ¸…å‡ºç¼“å­˜ã€‚
  LRUï¼ŒLeast Recently Usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå½“ç¼“å­˜å®¹é‡æ»¡äº†ï¼Œè€Œåˆéœ€è¦è…¾å‡ºåœ°æ–¹æ¥ç¼“å­˜æ–°çš„å…ƒç´ çš„æ—¶å€™ï¼Œé‚£ä¹ˆç°æœ‰ç¼“å­˜å…ƒç´ ä¸­æ—¶é—´æˆ³ç¦»å½“å‰æ—¶é—´æœ€è¿œçš„å…ƒç´ å°†è¢«æ¸…å‡ºç¼“å­˜ã€‚
--&gt;

&lt;/ehcache&gt;
</code></pre>
<h3 id="29é“ç»ƒä¹ é¢˜å®æˆ˜"><a href="#29é“ç»ƒä¹ é¢˜å®æˆ˜" class="headerlink" title="29é“ç»ƒä¹ é¢˜å®æˆ˜"></a>29é“ç»ƒä¹ é¢˜å®æˆ˜</h3><p>é—æ¼çš„ç‚¹ï¼š</p>
<p>ä¸»è¦æ˜¯ç¯å¢ƒçš„é…ç½®</p>

  </div>
  <div id=""></div>
</div>

<script>
  
Fancybox.bind('[data-fancybox="fancybox-gallery-img"]', {
  dragToClose: true,
  Toolbar: true,
  closeButton: "top",
  Image: {
    zoom: true,
  },
  on: {
    initCarousel: (fancybox) => {
      const slide = fancybox.Carousel.slides[fancybox.Carousel.page];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
    "Carousel.change": (fancybox, carousel, to, from) => {
      const slide = carousel.slides[to];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
  },
});
</script>

<style>
    #noneimg img {
        display: none;
        z-index: 9999;
        /* width: 600px !important; */
        min-width: 0%;
        max-width: 90%;
        max-height: 80%;
        border-radius: 0px;
        position: fixed;
        box-shadow: 0 0 0px #c3c3c300 !important;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto !important;
    }

    @media screen and (max-width:600px) {
        #noneimg img {
            max-width: 88%
        }
    }
</style>

    <div class="post-paging">
    
    <a href="/2024/01/08/hello-world/">
        <div class="post-paging-last">
            <span>ä¸Šä¸€ç¯‡</span>
            <p>Hello World</p>
        </div>
    </a>
    

    
    <a href="/2024/01/08/LSS/Servlet/">
        <div class="post-paging-next">
            <span>ä¸‹ä¸€ç¯‡</span>
            <p>Servletå­¦ä¹ </p>
        </div>
    </a>
    
</div>
</div>
		
<div class="footer">
	<div class="Copyright">
		Â©2024 By SoftLipa. ä¸»é¢˜ï¼š<a
			style="text-decoration: none;display: contents; color: #898F9F;"
			target="_blank" rel="noopener" href="https://github.com/79e/hexo-theme-quiet">Quiet</a>
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
		</a>
		
	</div>
</div>

<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            transition: border .5s;
            border: 1px solid rgba(18, 24, 58, 0.06);

            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari å’Œ Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $( '#js-go_top' )
	.gotoTop( {
		offset: 500,
		speed: 300,
		animationShow: {
			'transform': 'translate(0,0)',
			'transition': 'transform .5s ease-in-out'
		},
		animationHide: {
			'transform': 'translate(100px,0)',
			'transition': 'transform .5s ease-in-out'
		}
	} );
</script>


    <!-- Gitalk -->
    <script>
        const data = '{"clientID":"02b3c","clientSecret":"adfc7b4","repo":"gimment","owner":"duneng","admin":"duneng"}'
        const gitalk = new Gitalk({
            ...JSON.parse( data),
            id:location.pathname,
            distractionFreeMode:false
        })
        
        if(Boolean('false')){
            gitalk.render('gitalk-container')
        }
    </script>

<script>
	console.log('\n %c Hexo-Quiet ä¸»é¢˜ %c https://github.com/79e/hexo-theme-quiet \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
</script>
	</body>
</html>

